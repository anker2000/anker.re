var collection=function(){function e(o){clearTimeout(v),v=setTimeout(t,1700),w.bottom-T.height<0?$(p).addClass("above"):$(p).removeClass("above"),w.top>0?$(p).addClass("below"):$(p).removeClass("below"),w.top<=0&&w.bottom>=T.height?y&&Math.abs(m)>C&&r(o):w.top<T.height/2&&w.top>5?m>0?(a(0),s($(".productshots .product:first-child",$(p)).offset().top,1500,o)):0>m&&a(-1):w.bottom<T.height/2&&w.bottom>5&&(0>m?(a(x-1),s($(".productshots .product:last-child",$(p)).offset().top,1500,o)):m>0&&a(-1)),"undefined"!=typeof o&&"undefined"==typeof o.target&&setTimeout(function(){window.requestAnimationFrame(e)},16)}function t(){y=!0}function o(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}function n(){window.addEventListener&&window.addEventListener("DOMMouseScroll",o,!1),window.onwheel=o,window.onmousewheel=document.onmousewheel=o,window.ontouchmove=o}function i(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",o,!1),window.onmousewheel=document.onmousewheel=null,window.onwheel=null,window.ontouchmove=null}function c(){var e=d(document.elementFromPoint(0,T.height/2));if(e){var t=$(e).index();a(t)}}function r(e){var t=d(document.elementFromPoint(0,T.height/2)),o=$(t).index();m>0?(objectTarget=o+1,objectTarget<x?s($(t).next().offset().top,1500,e):(s(b+3*T.height/4,1500,e),a(-1))):(objectTarget=o-1,objectTarget>=0?s($(t).prev().offset().top,1500,e):(s(b-3*T.height/4,1500,e),a(-1))),a(objectTarget)}function a(e){$(".cta .product",$(p)).removeClass("active"),$(".cta .product:nth-child("+(e+1)+")",$(p)).addClass("active"),$("header nav a",$(p)).removeClass("active"),$("header nav a:nth-child("+(e+1)+")",$(p)).addClass("active"),$(".overlay .product",$(p)).removeClass("active"),$(".overlay .product:nth-child("+(e+1)+")",$(p)).addClass("active")}function s(e,o,c){n(),y=!1,$("html, body").stop().scrollTo(e,{duration:o,easing:"easeOutExpo"},function(){t(),i()})}function d(e){return $(e).hasClass("product")?e:e==document.body?!1:d(e.parentNode)}function l(e){w=p.getBoundingClientRect(),T.height=$(window).height(),T.width=$(window).width()}function u(e){w=p.getBoundingClientRect(),g=$(p).offset().top,b=$(window).scrollTop(),m=b-E,E=b}function h(e){p=e,x=$(".productshots",$(e)).children().length,$(".collection").css("height",100*x+"vh")}function f(){$(".collection header a").bind("click",function(e){var t=$(this).index();s($(".productshots .product:nth-child("+(t+1)+")",$(p)).offset().top,1e3,e),a(t),e.preventDefault()})}var w,p,v,m,g,T={},b=$(window).scrollTop(),C=8,y=!0,E=b,x=0;return{Init:function(t){h(t),f(),window.addEventListener("resize",l),window.addEventListener("wheel",e),window.addEventListener("scroll",u),l(),e(),setTimeout(c,1e3)}}}();$(function(){$(".collection").each(function(){collection.Init(this)})}),$.fn.scrollTo=function(e,t,o){"function"==typeof t&&2==arguments.length&&(o=t,t=e);var n=$.extend({scrollTarget:e,offsetTop:50,duration:500,easing:"easeOutQuad"},t);return this.each(function(){var e=$(this),t="number"==typeof n.scrollTarget?n.scrollTarget:$(n.scrollTarget),i="number"==typeof t?t:t.offset().top+e.scrollTop()-parseInt(n.offsetTop);e.animate({scrollTop:i},parseInt(n.duration),n.easing,function(){"function"==typeof o&&o.call(this)})})},jQuery.extend(jQuery.easing,{def:"easeOutQuad",easeOutExpo:function(e,t,o,n,i){return t==i?o+n:n*(-Math.pow(2,-10*t/i)+1)+o}});
function mapRange(e,t,n,i,c){return i+(c-i)*(e-t)/(n-t)}var scentWheel=function(){function e(){t();var e=document.querySelector(".progress").getAttribute("r"),n=Math.PI*(2*e);document.querySelector(".progress").style.strokeDasharray=n;var i=mapRange(a.pct,0,1,1,0);document.querySelector(".progress").style.strokeDashoffset=i*n}function t(e){var t=document.querySelector("svg.progress_container").getBoundingClientRect().width,n=1e3/t;$(".scent_wheel svg circle.progress")[0].style.strokeWidth=5*n,$(".scent_wheel svg circle.background")[0].style.strokeWidth=1*n,$(".scent_wheel svg circle.point").each(function(){$(this)[0].setAttribute("r",6*n)}),console.log(n,"from",t)}function n(){$currentText=$(".descriptions .section_container section:nth-child("+mapRange(s+1,0,4,4,0)+") .text");var e=0;return $currentText.children().each(function(){e+=$(this).html().length}),mapRange(Math.ceil(50*e),3e3,15e3,8e3,17e3)}function i(){$("g.section .point").bind("click",function(e){e.preventDefault(),scentWheel.noteSkipTo($(this).attr("data-section")),$("g.section circle.point").attr("class","point"),$(this).attr("class","point active")}),$(".scent_wheel a.discover").bind("click",function(e){e.preventDefault(),scentWheel.noteNavigate(1,o)}),$(".navigation a.forward").bind("click",function(e){scentWheel.nextNote(),e.preventDefault()}),$(".navigation a.back").bind("click",function(e){scentWheel.prevNote(),e.preventDefault()}),$(".navigation ul li").bind("click",function(e){var t=$(this).index()+1;0==t?scentWheel.noteNavigate(t,0):scentWheel.noteSkipTo(t)})}var c,a={pct:0},s=0,o=1e4;return{Init:function(){i(),window.addEventListener("resize",t),TweenLite.ticker.addEventListener("tick",e),$(".backgrounds .section_container section:first-child img").addClass("active")},nextNote:function(){targetStep=s+1,4==targetStep&&(targetStep=0),scentWheel.noteSkipTo(targetStep)},prevNote:function(){return targetStep=s-1,-1==targetStep?!1:void scentWheel.noteSkipTo(targetStep)},noteNavigate:function(e){duration=n(),(4==e||0==e)&&(e=0,i=1e3,$("circle.progress").css("opacity",0),setTimeout(function(){$("circle.progress").css("opacity",1)},i+20),duration=0),e>0?$(".scent_wheel").addClass("running"):$(".scent_wheel").removeClass("running");var t=e/3,i=0,o=-100*e,r=mapRange(e,0,3,3,0),l=-100*r;TweenLite.to(a,duration/1e3,{pct:t,delay:i,ease:Power0.easeOut});e>0?c=setTimeout(function(){scentWheel.noteNavigate(e+1)},duration):clearTimeout(c),$(".navigation ul li").removeClass("active"),$(".navigation ul li:nth-child("+e+")").addClass("active"),$(".backgrounds .section_container img").removeClass("active"),$(".backgrounds .section_container section:nth-child("+(e+1)+") img").addClass("active"),$(".descriptions .section_container .text").removeClass("active"),$(".descriptions .section_container section:nth-child("+(r+1)+") .text").addClass("active"),$("g.section circle.point").attr("class","point"),$("g.section circle.point:nth-child("+e+")").attr("class","point active"),$(".backgrounds .section_container").css("transform","translateY("+o+"%)"),$(".descriptions .section_container").css("transform","translateY("+l+"%)"),s=e},noteSkipTo:function(e){if(e=parseFloat(e),e==s)return!1;var t=mapRange(e,0,4,4,0);targetPct=(e-1)/3,targetPct<0&&(targetPct=0),targetBackground=-100*e,targetDescription=-100*(t-1),clearTimeout(c);TweenLite.to(a,.3,{pct:targetPct});e>0?$(".scent_wheel").addClass("running"):$(".scent_wheel").removeClass("running"),$(".navigation ul li").removeClass("active"),$(".navigation ul li:nth-child("+e+")").addClass("active"),$(".backgrounds .section_container img").removeClass("active"),$(".backgrounds .section_container section:nth-child("+(e+1)+") img").addClass("active"),$(".descriptions .section_container .text").removeClass("active"),$(".descriptions .section_container section:nth-child("+t+") .text").addClass("active"),$("g.section circle.point").attr("class","point"),$("g.section circle.point:nth-child("+e+")").attr("class","point active"),$(".backgrounds .section_container").css("transform","translateY("+targetBackground+"%)"),$(".descriptions .section_container").css("transform","translateY("+targetDescription+"%)"),o=n(),0==e?clearTimeout(c):c=setTimeout(function(){scentWheel.noteNavigate(e,o)},1e3),s=e}}}();$(function(){null!=document.querySelector(".scent_wheel")&&scentWheel.Init()});
//# sourceMappingURL=site.js.map

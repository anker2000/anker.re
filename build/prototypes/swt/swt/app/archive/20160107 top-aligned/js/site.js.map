{"version":3,"sources":["ScrollToPlugin.js","animations.js","bootstrap-datepicker.js","cards.js","clock_slider.js","controls.js","filter.js","forms.js","helper.js","jquery.noclickdelay.js","location.js","planning.js","schedule.js"],"names":["window","_gsQueue","push","_gsDefine","TweenPlugin","ScrollToPlugin","props","priority","call","this","_overwriteProps","pop","p","prototype","_getX","pageXOffset","document","documentElement","scrollLeft","body","_getY","pageYOffset","scrollTop","_setRatio","setRatio","constructor","API","_onInitTween","target","value","tween","_wdw","_target","y","Number","x","_addTween","skipX","skipY","_kill","lookup","scrollTo_x","v","scrollTo","activate","enterLocating","location","hash","$","addClass","css","stepAnimate","removeClass","bind","setTimeout","href","clearTimeout","footerTimeout","unbind","openDestinationScreen","hashChangeHandler","filter","html","locatingToScanner","closeDestinationScreen","closeHomeScreen","enterHomeScreen","delay","console","log","lastActiveScreen","each","i","e","first","clock_slider","Init","eq","enterJourneyScreen","obj","animate","opacity","scrollHeight","height","closeWhatEver","closeJourneyScreen","container","stepAnimateFast","enterPlanning","enterSchedule","schedule","sizeUp","closeSchedule","initiateScreen","rotateInfo","info","length","prependTo","toggleClass","hasClass","removeAttr","factory","define","amd","exports","require","jQuery","undefined","UTCDate","Date","UTC","apply","arguments","UTCToday","today","getFullYear","getMonth","getDate","isUTCEquals","date1","date2","getUTCFullYear","getUTCMonth","getUTCDate","alias","method","isValidDate","d","isNaN","getTime","opts_from_el","el","prefix","re_lower","_","a","toLowerCase","inkey","data","out","replace","RegExp","key","test","opts_from_locale","lang","dates","split","locale_opts","k","DateArray","extras","get","slice","contains","val","valueOf","l","remove","splice","new_array","isArray","clear","copy","extend","Datepicker","element","options","_process_options","viewDate","o","defaultViewDate","focusDate","isInline","isInput","is","component","find","hasInput","picker","DPGlobal","template","_buildEvents","_attachEvents","appendTo","rtl","viewMode","startView","calendarWeeks","attr","parseInt","_allow_update","setStartDate","_o","startDate","setEndDate","endDate","setDaysOfWeekDisabled","daysOfWeekDisabled","setDaysOfWeekHighlighted","daysOfWeekHighlighted","setDatesDisabled","datesDisabled","fillDow","fillMonths","update","showMode","show","opts","language","defaults","minViewMode","maxViewMode","Math","min","max","multidate","multidateSeparator","String","weekStart","weekEnd","format","parseFormat","Infinity","_local_to_utc","_zero_time","parseDate","map","plc","orientation","_plc","grep","word","year","month","day","showOnFocus","zIndexOffset","_events","_secondaryEvents","_applyEvents","evs","ch","ev","on","_unapplyEvents","off","events","keyup","proxy","inArray","keyCode","keydown","paste","focus","click","blur","_focused_from","immediateUpdates","changeYear changeMonth","date","resize","place","mousedown","hide","_detachEvents","_attachSecondaryEvents","_detachSecondaryEvents","_trigger","event","altdate","local_date","_utc_to_local","trigger","type","ix","formatDate","enableOnReadonly","navigator","msMaxTouchPoints","disableTouchKeyboard","detach","forceParse","setValue","datepicker","evt","dateString","originalEvent","clipboardData","types","getData","setDate","preventDefault","utc","getTimezoneOffset","local","_zero_utc_time","getDates","getUTCDates","selected_date","clearDates","autoclose","setDates","args","setUTCDates","setUTCDate","formatted","getFormattedDate","join","updateNavArrows","calendarWidth","outerWidth","calendarHeight","outerHeight","visualPadding","windowWidth","width","appendOffset","offset","parentsZindex","parents","itemZIndex","zIndex","parent","left","top","top_overflow","yorient","right","oldDates","fromArgs","fill","change","dowCnt","daysMin","append","monthsShort","setRange","range","getClassNames","cls","todayHighlight","getUTCDay","tooltip","startYear","startMonth","endYear","endMonth","todaytxt","cleartxt","titleFormat","text","toggle","todayBtn","clearBtn","title","prevMonth","getDaysInMonth","nextMonth","setUTCFullYear","clsName","ws","th","yth","calWeek","beforeShowDay","noop","before","enabled","classes","concat","unique","empty","months","end","beforeShowMonth","that","moDate","yearCont","years","beforeShowYear","yrBefore","visibility","stopPropagation","closest","nodeName","className","dir","modes","navStep","moveMonth","moveYear","which","_setDate","index","setUTCMonth","_toggle_multidate","toggleActive","new_month","new_date","mag","abs","dateWithinRange","newDate","newViewDate","dateChanged","keyboardNavigation","ctrlKey","shiftKey","cancelBubble","children","DateRangePicker","inputs","jquery","datepickerPlugin","dateUpdated","pickers","updateDates","updateRanges","updating","dp","j","old","fn","option","Array","shift","internal_return","$this","elopts","xopts","locopts","ropts","toArray","Error","Constructor","en","days","daysShort","navFnc","isLeapYear","validParts","nonpunctuation","toValue","toDisplay","separators","parts","match","match_part","m","part","part_re","exec","filtered","parsed","setters_order","setters_map","yyyy","yy","fparts","cnt","_date","s","D","DD","M","MM","toString","substring","dd","mm","seps","headTemplate","contTemplate","footTemplate","noConflict","version","touchstartHandler","touchendHandler","touchY","changedTouches","clientY","thisY","activateDelay","$card","fadeOut","fadeIn","activeBucket","time_str","time","h","delaydepart","delayarrive","pad","swapStations","startPoint","endPoint","parentHasClass","elm","indexOf","parentNode","n","z","currentTime","activateBucket","no","speed","init","$bucket","trim","now","setHours","getHours","targetTime","timeString","getMinutes","initBucket","targetX","scrollBucket","scrollMuch","pixelsMoved","entryTouchTime","touchmoveHandler","matrix","entryTouchPoint","touchOffsetX","touches","clientX","touchTimeout","exitTouchPoint","timeSinceTouchstart","destination","closestBucket","round","animationTime","findCurrentTime","m_rounded","ceil","activeChild","thisHour","thisMinute","scaleAccordingToCenterPos","getDistanceFromCenter","returnValue","getBoundingClientRect","querySelector","center","elementFromPoint","tagName","objects","previousSibling","firstChild","nextSibling","object","centerMeasure","spanTime","centerScale","centerOpacity","getAttribute","setAttribute","Object","in_min","in_max","out_min","out_max","draw","startBucket","fromTop","prop","headerMinHeight","historyCount","stepHandler","trainDirection","setSlideMinNow","updatePriceList","scrollHandler","scrollPoint","webkit","messageHandlers","callbackHandler","postMessage","er","history","go","currentHour","floor","slider","values","resetSlideHandler","slideHandler","ui","sliderValues","start_ms","end_ms","start_hour","start_minute","end_hour","end_minute","departure_ms","gte","lte","direction","dataHandler","departure_data","Update","calculatePrice","single","outbound","localStorage","getObject","returning","cheapest_single","adults","getItem","cheapestDoubleSingle","cheap_rtn_1","cheapestReturn","cheapReturn1","firstMessage","cheap_rtn_2","cheapReturn2","cheapestTicketPrice","currentCheapestPrice","childFactor","ticketOptions","outbound_name","outboundStandardMessage","outboundFirstMessage","returning_name","returningStandardMessage","returningFirstMessage","toFixed","ScheduleStep","calculatePriceDifference","journeyObj","offpeak","returnT","thisCheapestPrice","setItem","json","globalJSON","departures","TAFFY","prevPeak","departurePriceAverageTemp","tempArray","cheapestDepartureItem","order","globalAdultPrice","globalChildPrice","returnOptions","clone","setObject","tempCheapestTotal","innerHTML","sortField","journey","peak","thisAdultPrice","thisChildPrice","thisPrice","tempDepartureTime","departure","departureTime","arrivalTime","valid_info","setTime","duration","dLi","createElement","journeyData","thisPriceDifference","formatPrice","changes","platform","formatMinutes","offer_header","footerHTML","offer_icon","offer_message","cheapest_single_child","addEventListener","appendChild","number","tempSubArray","offerHandler","hours","minutes","hasOwnProperty","price","formattedPrice","departurePriceAverage","cheapestTotal","feedFile","Storage","JSON","stringify","parse","nullObject","slide","getJSON","myDataPoints","tempAverage","chart","CanvasJS","Chart","animationEnabled","axisY","tickLength","labelFontFamily","lineThickness","gridThickness","tickThickness","labelFontSize","labelFormatter","axisX","interval","minimum","margin","markerSize","color","dataPoints","render","done","fail","keyboardTimeout","searchTimeout","activeInput","stationSearch","removeKeyboardFocus","setFormattedDate","source","minDate","timezoneOffset","daySelected","compareDate","getElementById","next","setMinutes","getYear","padDigits","digits","innerHeight","priceAdults","priceChildren","priceTotal","parseFloat","id","page_title","page_title_display","locate","helperToggle","withinDistance","x1","y1","x2","y2","distance","userAgent","CONFIG","TOUCH_MOVE_THRESHHOLD","PRESSED_CLASS","GHOST_CLICK_TIMEOUT","GHOST_CLICK_THRESHOLD","clicks","elem","touch","__eventLocation","__onTouchMove","createEvent","initMouseEvent","dispatchEvent","clickLocation","locationHandler","getCurrentLocation","geolocation","getCurrentPosition","showPosition","position","userPosition","getLocation","travellers","control","adultLabel","category","totalAmount","adultCharacters","adultCounter","prepend","childCharacters","childCounter","childrenLabel","showRailcards","travellerToggle","detectFieldsCompleted","ticketHandler","tempTo","eccentricGuy","referrer","getDay","nth","resizeHandler","windowHeight","extraHeaderHeight","innerWidth","scrollAnimation","TweenMax","to","ease","Power2","easeInOut","headerHeight","scheduleStepHandler","activeClass","currentStep","nextStep","peakLabel","priceStep1","priceStep2","myPrice","priceStep3","tempPrice","beforePrice","last","ticket","peakHourHandler","carparkHandler","kill","back"],"mappings":"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","file":"site.js","sourcesContent":["/**\r\n * VERSION: beta 1.30\r\n * DATE: 2012-07-25\r\n * JavaScript\r\n * UPDATES AND DOCS AT: http://www.greensock.com\r\n *\r\n * Copyright (c) 2008-2012, GreenSock. All rights reserved. \r\n * This work is subject to the terms in http://www.greensock.com/terms_of_use.html or for \r\n * corporate Club GreenSock members, the software agreement that was issued with the corporate \r\n * membership.\r\n * \r\n * @author: Jack Doyle, jack@greensock.com\r\n **/\r\n(window._gsQueue || (window._gsQueue = [])).push( function() {\r\n\r\n\t_gsDefine(\"plugins.ScrollToPlugin\", [\"plugins.TweenPlugin\"], function(TweenPlugin) {\r\n\t\t\r\n\t\tvar ScrollToPlugin = function(props, priority) {\r\n\t\t\t\tTweenPlugin.call(this, \"scrollTo\");\r\n\t\t\t\tthis._overwriteProps.pop();\r\n\t\t\t},\r\n\t\t\tp = ScrollToPlugin.prototype = new TweenPlugin(\"scrollTo\"),\r\n\t\t\t_getX = function() {\r\n\t\t\t\treturn (window.pageXOffset != null) ? window.pageXOffset : (document.documentElement.scrollLeft != null) ? document.documentElement.scrollLeft : document.body.scrollLeft;\r\n\t\t\t}, \r\n\t\t\t_getY = function() {\r\n\t\t\t\treturn (window.pageYOffset != null) ? window.pageYOffset : (document.documentElement.scrollTop != null) ? document.documentElement.scrollTop : document.body.scrollTop;\r\n\t\t\t},\r\n\t\t\t_setRatio = TweenPlugin.prototype.setRatio; //speed optimization (quicker lookup)\r\n\t\t\r\n\t\tp.constructor = ScrollToPlugin;\r\n\t\tScrollToPlugin.API = 2;\r\n\t\t\r\n\t\tp._onInitTween = function(target, value, tween) {\r\n\t\t\tthis._wdw = (target == window);\r\n\t\t\tthis._target = target;\r\n\t\t\tif (typeof(value) !== \"object\") {\r\n\t\t\t\tvalue = {y:Number(value)}; //if we don't receive an object as the parameter, assume the user intends \"y\".\r\n\t\t\t}\r\n\t\t\tthis.x = this._wdw ? _getX() : target.scrollLeft;\r\n\t\t\tthis.y = this._wdw ? _getY() : target.scrollTop;\r\n\t\t\tif (value.x != null) {\r\n\t\t\t\tthis._addTween(this, \"x\", this.x, value.x, \"scrollTo_x\", true);\r\n\t\t\t} else {\r\n\t\t\t\tthis.skipX = true;\r\n\t\t\t}\r\n\t\t\tif (value.y != null) {\r\n\t\t\t\tthis._addTween(this, \"y\", this.y, value.y, \"scrollTo_y\", true);\r\n\t\t\t} else {\r\n\t\t\t\tthis.skipY = true;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t};\r\n\t\t\r\n\t\tp._kill = function(lookup) {\r\n\t\t\tif (lookup.scrollTo_x) {\r\n\t\t\t\tthis.skipX = true;\r\n\t\t\t}\r\n\t\t\tif (lookup.scrollTo_x) {\r\n\t\t\t\tthis.skipY = true;\r\n\t\t\t}\r\n\t\t\treturn TweenPlugin.prototype._kill.call(this, lookup);\r\n\t\t}\r\n\t\t\r\n\t\tp.setRatio = function(v) {\r\n\t\t\t_setRatio.call(this, v);\r\n\t\t\tif (this._wdw) {\r\n\t\t\t\twindow.scrollTo((!this.skipX) ? this.x : _getX(), (!this.skipY) ? this.y : _getY());\r\n\t\t\t} else {\r\n\t\t\t\tif (!this.skipY) {\r\n\t\t\t\t\tthis._target.scrollTop = this.y;\r\n\t\t\t\t}\r\n\t\t\t\tif (!this.skipX) {\r\n\t\t\t\t\tthis._target.scrollLeft = this.x;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tTweenPlugin.activate([ScrollToPlugin]);\r\n\t\t\r\n\t\treturn ScrollToPlugin;\r\n\t\t\r\n\t}, true);\r\n\r\n}); if (window._gsDefine) { _gsQueue.pop()(); }","var lastActiveScreen = \"home\";\n$(function() {\n\t\n\t$('.react').bind('touchstart touchend', function(e) {\n\t\t$(this).toggleClass('touch');\n\t});\n\tif ($(\"body\").hasClass(\"search_station\")) {\n\t\tif(document.location.hash==\"#locating\") {\n\t\t\t// $(\".mobile\").css(\"display\",\"none\");\n\t\t\t$(\"div.search_station\").css(\"display\",\"none\").addClass(\"inactive\");\n\t\t\t$(\"section.helper\").css(\"display\",\"none\");\n\t\t\tsetTimeout(function() {\n\t\t\t\t$(\"div.search_station\").removeAttr('style');\n\t\t\t\t$(\"section.helper\").removeAttr('style');\n\t\t\t},750);\n\t\t\t// $(\"div.search_station\").css(\"opacity\",0);\n\t\t\t// $(\"div.search_station\").css(\"display\",\"none\");\n\t\t\tenterLocating();\n\t\t}\n\t}\n\t$(\".controls\").css(\"opacity\",1);\n\tstepAnimate(\"body\");\n\tfunction enterSplash() {\n\t\tconsole.log(\"testing\");\n\t\t$(\".screen\").removeClass(\"active\");\n\t\t$(\".splash.screen\").css(\"display\",\"block\").css(\"opacity\",1).addClass(\"active\");\n\t\tstepAnimate(\".splash.screen\");\n\t\tsetTimeout(function() {\n\t\t\t$(\".splash\").css(\"opacity\",0);\n\t\t},4000);\n\t\tsetTimeout(function() {\n\t\t\tenterLocating();\n\t\t},4400);\n\t}\n\t\n\tfunction loadIntro() {\n\t\t$(\".screen\").removeClass(\"active\");\n\t\t$(\".station_info\").css(\"display\",\"block\").addClass(\"active\");\n\t\t$(\".locating\").css(\"display\",\"none\");\n\t\t\n\t\tsetTimeout(function() {\n\t\t\t$(\".intro .gfx\").css(\"transform\",\"translateY(0)\");\n\t\t},300);\n\t\tsetTimeout(function() {\n\t\t\t$(\".controls\").css(\"opacity\",1);\n\t\t},500);\n\t\t$(\".station_info .opacityZero\").each(function(i, e) {\n\t\t\tsetTimeout(function(obj) {\n\t\t\t\t$(obj).animate({ opacity: 1},300);\n\t\t\t},(i*270)+500,e);\n\t\t});\n\t\t$(\".intro .gfx\").css(\"display\",\"block\");\n\t\tsetTimeout(function() {\n\t\t\t$(\".intro .gfx\").css(\"opacity\",1);\n\t\t},100);\n\n\t\n\t\t$(\".choose_destination\").click(function() {\n\t\t\t$(\".screen.search_station input.station\").focus();\n\t\t\n\t\t\t$(\".choose_destination\").css(\"transition\",\"all 0.7s cubic-bezier(.85,.01,.99,.38)\");\n\t\t\t$(\".choose_destination\").addClass(\"disappear\");\n\t\t\t\n\t\t\thideMainBackground();\n\t\t\tsetTimeout(function() {\n\t\t\t\tenterDestinationScreen();\n\t\t\t},700);\n\t\t});\n\t}\n\tfunction hideMainBackground() {\n\t\t$(\".intro .people\").css(\"transition-duration\",\"0.6s\").css(\"transition-timing-function\",\"cubic-bezier(.73,0,1,.46)\").css(\"transform\",\"translateY(800px)\");\n\t\tsetTimeout(function() {\n\t\t\t$(\".intro .background\").css(\"transition-duration\",\"0.6s\").css(\"transition-timing-function\",\"cubic-bezier(.73,0,1,.46)\").css(\"transform\",\"translateY(800px)\");\n\t\t},100);\n\t\tsetTimeout(function() {\n\t\t\t$(\".screen.station_info\").animate({ opacity: 0},300).css(\"pointer-events\",\"none\");\n\t\t},600);\n\t\t$(\".station_info .date\").css(\"transition-duration\",\"0.6s\").css(\"transition-timing-function\",\"cubic-bezier(.73,0,1,.46)\").css(\"transform\",\"translateY(-300px)\");\n\t\tsetTimeout(function() {\n\t\t\t$(\".station_info .station\").css(\"transition-duration\",\"0.6s\").css(\"transition-timing-function\",\"cubic-bezier(.73,0,1,.46)\").css(\"transform\",\"translateY(-300px)\");\n\t\t},100);\n\t}\n\tfunction enterDestinationScreen() {\n\t\tstepAnimate(\".search_station\");\n\t\t$(\".search_1 .background\").css(\"transition-duration\",\"0s\").css(\"transition-timing-function\",\"ease\").css(\"transform\",\"translateY(-20px)\");\n\t\t$(\".search_1 .people\").css(\"transition-duration\",\"0s\").css(\"transition-timing-function\",\"ease\").css(\"transform\",\"translateY(5px)\");\n\t\tsetTimeout(function() {\n\t\t\t$(\".search_1 .background\").css(\"transition-duration\",\"2s\");\n\t\t\t$(\".search_1 .people\").css(\"transition-duration\",\"2s\");\n\t\t},100);\n\t\t$(\".station_info\").css(\"display\",\"none\");\n\t\t$(\".search_1, .search_1 .gfx\").css(\"display\",\"block\");\n\t\tsetTimeout(function() {\n\t\t\t$(\".search_1\").css(\"opacity\",1);\n\t\t},100);\n\t\tsetTimeout(function() {\n\t\t\t// $(\".screen.search_station\").css(\"opacity\",0).css(\"display\",\"block\").animate({ opacity: 1},300);\n\t\t\t$(\".search_1 .gfx\").css(\"opacity\",1);\n\t\t\t$(\".search_1\").css(\"transform\",\"translateY(0px)\");\n\t\t},200);\n\t\tsetTimeout(function() {\n\t\t\t$(\".search_station .results\").css(\"transform\",\"translateY(0px)\");\n\t\t},350);\n\t}\n\t$(\"body.home div.changes\").bind(\"click\",function() {\n\n\t\tcloseHomeScreen();\n\t\tenterJourneyScreen();\n\t\t$(\".burger\").addClass(\"close-button\");\n\t});\n\n\t$(\".home.screen .get_tickets button\").bind(\"click\",function() {\n\t\tcloseHomeScreen();\n\t\tsetTimeout(function() {\n\t\t\tenterPlanning()\n\t\t},1200);\n\t});\n\tfunction rotateInfo() {\n\t\t$(\".home .info\").each(function() {\n\t\t\tvar info = $(this);\n\t\t\tif ($(\"span\",info).length>1) {\n\t\t\t\t$(\"span:first-child\",info).css(\"transition-duration\",\"0.5s\").css(\"transform\",\"translateY(-42px)\");\n\t\t\t\t$(\"span:last-child\",info).css(\"transition-duration\",\"0.5s\").css(\"transform\",\"translateY(-42px)\");\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t$(\"span:last-child\",info).prependTo(info);\n\t\t\t\t\t$(\"span:first-child\",info).css(\"transition-duration\",\"0s\").css(\"transform\",\"translateY(0px)\");\n\t\t\t\t\t$(\"span:last-child\",info).css(\"transition-duration\",\"0s\").css(\"transform\",\"translateY(0px)\");\n\t\t\t\t},500);\n\t\t\t}\n\t\t});\n\t\t\t\n\t\tsetTimeout(rotateInfo,7000);\n\t}\n\tsetTimeout(rotateInfo,7000);\n});\nvar footerTimeout;\nfunction enterLocating() {\n\tdocument.location.hash=\"locating\";\n\t\n\t$(\"body\").addClass(\"locate\");\n\n\t$(\".route_vertical button\").css(\"opacity\",1);\n\t$(\".route_vertical\").addClass(\"active\");\n\n\tstepAnimate(\".locating\");\n\t$(\".back_nav\").removeClass(\"inactive\");\n\t\n\t\n\t$(\".route_vertical button.next\").bind(\"click\",function() {\n\t\t$(\".route_container\").removeClass(\"on\");\n\t\tsetTimeout(function() {\n\t\t\tdocument.location.href=\"scanner.php\";\n\t\t},300);\n\t});\n\t$(\".search_station .back_nav\").bind(\"click\",function() {\n\t\tclearTimeout(footerTimeout);\n\t\t$(\".route_vertical\").removeClass(\"active\");\n\t\t$(\"body\").removeClass(\"locate\");\n\t\t$(\"footer\").removeClass(\"active\");\n\t\t$(this).addClass(\"inactive\");\n\t\t$(\".route_vertical *\").removeClass(\"on blink\");\n\t\t$(window).unbind('hashchange');\n\t\topenDestinationScreen();\n\t\t$(window).bind('hashchange', hashChangeHandler);\n\t});\n\t\n\t\n\tsetTimeout(function() {\n\t\t$(\".route_container\").addClass(\"on\");\n\t},300);\n\tsetTimeout(function() {\n\t\t$(\".route_vertical .first-line\").addClass(\"on\");\n\t\t$(\".route_vertical .blue-circle\").filter(\":first\").addClass(\"on\");\n\n\t\t$(\".route_vertical .first_station\").addClass(\"on\");\n\t},700);\n\tsetTimeout(function() {\n\t\t$(\".route_vertical .second-line\").addClass(\"on\");\n\t\t$(\".route_vertical .change-stop\").addClass(\"on\");\n\t\t$(\".route_vertical .change_station\").addClass(\"on\");\n\t},1500);\n\tsetTimeout(function() {\n\t\t$(\".route_vertical .blue-circle\").filter(\":last\").addClass(\"on\");\n\t\t$(\".route_vertical .last_station\").addClass(\"on\");\n\t\t$(\".route_vertical .last_station small\").addClass(\"blink\");\n\t},2200);\n\tsetTimeout(function() {\n\t\t$(\".route_vertical .third-line\").addClass(\"on\");\n\t},2400);\n\tsetTimeout(function() {\n\t\t$(\".route_vertical .fourth-line\").addClass(\"on\");\n\t},3000);\n\tsetTimeout(function() {\n\t\t$(\"p strong\").html(\"2hr 02min\");\n\t},3500);\n\tfooterTimeout=setTimeout(function() {\n\t\t$(\"footer\").addClass(\"active\");\n\t},4500);\n}\nfunction locatingToScanner() {\n\t$(\".route_vertical\").removeClass(\"active\");\n\tsetTimeout(function() {\n\t\tdocument.location.href=\"scanner.php\";\n\t},300);\n}\nfunction openDestinationScreen() {\n\tdocument.location.hash=\"\";\n\tsetTimeout(function() {\n\t\t$(\"section.helper\").removeClass(\"inactive\");\n\t},300);\n\tsetTimeout(function() {\n\t\t// $(\"div.search_station\").css(\"display\",\"block\");\n\t},600);\n\t\n\t$(\"footer\").removeClass(\"active\");\n}\nfunction closeDestinationScreen() {\n\tsetTimeout(function() {\n\t\t$(\"section.helper\").addClass(\"inactive\");\n\t},300);\n\tsetTimeout(function() {\n\t\t// $(\"div.search_station\").css(\"opacity\",0);\n\t},600);\n\t\n}\nfunction closeHomeScreen() {\n\t\n\t$(\"body.home .top\").css(\"transition-duration\",\"0.4s\").css(\"transition-timing-function\",\"cubic-bezier(.73,0,1,.46)\").css(\"transform\",\"translateY(-500px)\").css(\"opacity\",0);\n\t$(\"body.home .bottom\").css(\"transition-duration\",\"0.4s\").css(\"transition-timing-function\",\"cubic-bezier(.73,0,1,.46)\").css(\"transform\",\"translateY(500px)\").css(\"opacity\",0);\n\t\n}\nfirst=true;\nfunction enterHomeScreen(delay) {\n\tconsole.log(\"enter home\");\n\tlastActiveScreen=\"home\";\n\t$(\"body.home .opacityZero\").each(function(i, e) {\n\t\t$(e).css(\"opacity\", 1);\n\t});\n\tif (typeof delay == \"undefined\") delay=1200;\n\tsetTimeout(function() {\n\t\t// setTimeout(function() {\n\t\t// \t$(\".home div.changes, .scroll-indicator\").css(\"opacity\",1);\n\t\t// },350);\n\t\tif (first) {\n\t\t\tclock_slider.Init($(\".clock_slider\").eq(0),0);\n\t\t\tfirst = false;\n\t\t}\n\t},(delay));\n}\n\nfunction enterJourneyScreen() {\n\t$(\"body\").addClass(\"journeyview\").removeClass(\"closejourney\");\n\t$(\".back_nav\").addClass(\"inactive\");\n\t$(\".journey .opacityZero:not(.changes)\").each(function(i, e) {\n\t\tsetTimeout(function(obj) {\n\t\t\t$(obj).animate({ opacity: 1},300);\n\n\t\t},(i*270)+500,e);\n\t});\n\t$(\".journey\").addClass(\"active\");\n\t$(\".journey\").scrollTop(($(\".journey\")[0].scrollHeight - $(window).height())/2);\n\t$(\".journey ul li:nth-child(4)\").addClass(\"travel\");\n\t$(\".journey ul .current_status\").addClass(\"travel\");\n}\nfunction closeWhatEver() {\n\n\tdocument.location.href='scanner.php';\n}\nfunction closeJourneyScreen() {\n\t$(\".travel\").removeClass(\"travel\");\n\t$(\".journey\").removeClass(\"active\");\n\t$(\"body\").addClass(\"journeyview closejourney\");\n}\nfunction stepAnimate(container) {\n\t$(\".opacityZero\",$(container)).each(function(i, e) {\n\t\tsetTimeout(function(obj) {\n\t\t\t$(obj).css(\"opacity\", 1);\n\t\t},(i*100),e);\n\t});\n}\nfunction stepAnimateFast(container) {\n\t$(\".opacityZero\",$(container)).each(function(i, e) {\n\t\tsetTimeout(function(obj) {\n\t\t\t$(obj).css(\"opacity\",1);\n\t\t},(i*170),e);\n\t});\n}\nfunction enterPlanning() {\n\tlastActiveScreen=\"planning\";\n\t$(\".planning.screen\").css(\"opacity\",0);\n\t$(\".planning.screen\").css(\"display\",\"block\");\n\t$(\".screen.planning\").animate({ opacity: 1},300);\n\tstepAnimate(\".planning.screen\");\n}\nfunction enterSchedule() {\n\tsetTimeout(schedule.sizeUp,1000);\n\t$(\".screen.planning\").animate({ opacity: 0},300)\n\tsetTimeout(function() {\n\t\t$(\".screen.schedule .faded\").removeClass(\"faded\");\n\t\t$(\".screen.planning\").css(\"display\",\"none\");\n\t\t$(\".screen.schedule\").css(\"display\",\"block\").animate({ opacity: 1},300).addClass(\"active\");\n\t\t$(\".screen.schedule .schedule_container\").removeClass(\"step1 step2 step3 step4 step5\");\n\t\t$(\".screen.schedule .schedule_container\").addClass(\"step1\");\n\t},300);\n}\nfunction closeSchedule() {\n\t$(\".screen.schedule\").animate({ opacity: 0},300);\n\tsetTimeout(function() {\n\n\t\t$(\".screen.schedule .schedule_container\").removeClass(\"step1 step2 step3 step4\");\n\t\t$(\".screen.schedule\").css(\"display\",\"none\");\n\t},300);\n}\n\nfunction initiateScreen() {\n\tif (first) {\n\t\tclock_slider.Init($(\".clock_slider\").eq(0),0);\n\t\tfirst = false;\n\t}\n}\n$(function() {\n\t$(\"body.home\").each(initiateScreen);\n})\n","/* =========================================================\n * bootstrap-datepicker.js\n * Repo: https://github.com/eternicode/bootstrap-datepicker/\n * Demo: http://eternicode.github.io/bootstrap-datepicker/\n * Docs: http://bootstrap-datepicker.readthedocs.org/\n * Forked from http://www.eyecon.ro/bootstrap-datepicker\n * =========================================================\n * Started by Stefan Petre; improvements by Andrew Rowls + contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * ========================================================= */\n\n(function(factory){\n    if (typeof define === \"function\" && define.amd) {\n        define([\"jquery\"], factory);\n    } else if (typeof exports === 'object') {\n        factory(require('jquery'));\n    } else {\n        factory(jQuery);\n    }\n}(function($, undefined){\n\n\tfunction UTCDate(){\n\t\treturn new Date(Date.UTC.apply(Date, arguments));\n\t}\n\tfunction UTCToday(){\n\t\tvar today = new Date();\n\t\treturn UTCDate(today.getFullYear(), today.getMonth(), today.getDate());\n\t}\n\tfunction isUTCEquals(date1, date2) {\n\t\treturn (\n\t\t\tdate1.getUTCFullYear() === date2.getUTCFullYear() &&\n\t\t\tdate1.getUTCMonth() === date2.getUTCMonth() &&\n\t\t\tdate1.getUTCDate() === date2.getUTCDate()\n\t\t);\n\t}\n\tfunction alias(method){\n\t\treturn function(){\n\t\t\treturn this[method].apply(this, arguments);\n\t\t};\n\t}\n\tfunction isValidDate(d) {\n\t\treturn d && !isNaN(d.getTime());\n\t}\n\n\tvar DateArray = (function(){\n\t\tvar extras = {\n\t\t\tget: function(i){\n\t\t\t\treturn this.slice(i)[0];\n\t\t\t},\n\t\t\tcontains: function(d){\n\t\t\t\t// Array.indexOf is not cross-browser;\n\t\t\t\t// $.inArray doesn't work with Dates\n\t\t\t\tvar val = d && d.valueOf();\n\t\t\t\tfor (var i=0, l=this.length; i < l; i++)\n\t\t\t\t\tif (this[i].valueOf() === val)\n\t\t\t\t\t\treturn i;\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\tremove: function(i){\n\t\t\t\tthis.splice(i,1);\n\t\t\t},\n\t\t\treplace: function(new_array){\n\t\t\t\tif (!new_array)\n\t\t\t\t\treturn;\n\t\t\t\tif (!$.isArray(new_array))\n\t\t\t\t\tnew_array = [new_array];\n\t\t\t\tthis.clear();\n\t\t\t\tthis.push.apply(this, new_array);\n\t\t\t},\n\t\t\tclear: function(){\n\t\t\t\tthis.length = 0;\n\t\t\t},\n\t\t\tcopy: function(){\n\t\t\t\tvar a = new DateArray();\n\t\t\t\ta.replace(this);\n\t\t\t\treturn a;\n\t\t\t}\n\t\t};\n\n\t\treturn function(){\n\t\t\tvar a = [];\n\t\t\ta.push.apply(a, arguments);\n\t\t\t$.extend(a, extras);\n\t\t\treturn a;\n\t\t};\n\t})();\n\n\n\t// Picker object\n\n\tvar Datepicker = function(element, options){\n\t\tthis._process_options(options);\n\n\t\tthis.dates = new DateArray();\n\t\tthis.viewDate = this.o.defaultViewDate;\n\t\tthis.focusDate = null;\n\n\t\tthis.element = $(element);\n\t\tthis.isInline = false;\n\t\tthis.isInput = this.element.is('input');\n\t\tthis.component = this.element.hasClass('date') ? this.element.find('.add-on, .input-group-addon, .btn') : false;\n\t\tthis.hasInput = this.component && this.element.find('input').length;\n\t\tif (this.component && this.component.length === 0)\n\t\t\tthis.component = false;\n\n\t\tthis.picker = $(DPGlobal.template);\n\t\tthis._buildEvents();\n\t\tthis._attachEvents();\n\n\t\tif (this.isInline){\n\t\t\tthis.picker.addClass('datepicker-inline').appendTo(this.element);\n\t\t}\n\t\telse {\n\t\t\tthis.picker.addClass('datepicker-dropdown dropdown-menu');\n\t\t}\n\n\t\tif (this.o.rtl){\n\t\t\tthis.picker.addClass('datepicker-rtl');\n\t\t}\n\n\t\tthis.viewMode = this.o.startView;\n\n\t\tif (this.o.calendarWeeks)\n\t\t\tthis.picker.find('tfoot .today, tfoot .clear')\n\t\t\t\t\t\t.attr('colspan', function(i, val){\n\t\t\t\t\t\t\treturn parseInt(val) + 1;\n\t\t\t\t\t\t});\n\n\t\tthis._allow_update = false;\n\n\t\tthis.setStartDate(this._o.startDate);\n\t\tthis.setEndDate(this._o.endDate);\n\t\tthis.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled);\n\t\tthis.setDaysOfWeekHighlighted(this.o.daysOfWeekHighlighted);\n\t\tthis.setDatesDisabled(this.o.datesDisabled);\n\n\t\tthis.fillDow();\n\t\tthis.fillMonths();\n\n\t\tthis._allow_update = true;\n\n\t\tthis.update();\n\t\tthis.showMode();\n\n\t\tif (this.isInline){\n\t\t\tthis.show();\n\t\t}\n\t};\n\n\tDatepicker.prototype = {\n\t\tconstructor: Datepicker,\n\n\t\t_process_options: function(opts){\n\t\t\t// Store raw options for reference\n\t\t\tthis._o = $.extend({}, this._o, opts);\n\t\t\t// Processed options\n\t\t\tvar o = this.o = $.extend({}, this._o);\n\n\t\t\t// Check if \"de-DE\" style date is available, if not language should\n\t\t\t// fallback to 2 letter code eg \"de\"\n\t\t\tvar lang = o.language;\n\t\t\tif (!dates[lang]){\n\t\t\t\tlang = lang.split('-')[0];\n\t\t\t\tif (!dates[lang])\n\t\t\t\t\tlang = defaults.language;\n\t\t\t}\n\t\t\to.language = lang;\n\n\t\t\tswitch (o.startView){\n\t\t\t\tcase 2:\n\t\t\t\tcase 'decade':\n\t\t\t\t\to.startView = 2;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\tcase 'year':\n\t\t\t\t\to.startView = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\to.startView = 0;\n\t\t\t}\n\n\t\t\tswitch (o.minViewMode){\n\t\t\t\tcase 1:\n\t\t\t\tcase 'months':\n\t\t\t\t\to.minViewMode = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\tcase 'years':\n\t\t\t\t\to.minViewMode = 2;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\to.minViewMode = 0;\n\t\t\t}\n\n\t\t\tswitch (o.maxViewMode) {\n\t\t\t\tcase 0:\n\t\t\t\tcase 'days':\n\t\t\t\t\to.maxViewMode = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\tcase 'months':\n\t\t\t\t\to.maxViewMode = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\to.maxViewMode = 2;\n\t\t\t}\n\n\t\t\to.startView = Math.min(o.startView, o.maxViewMode);\n\t\t\to.startView = Math.max(o.startView, o.minViewMode);\n\n\t\t\t// true, false, or Number > 0\n\t\t\tif (o.multidate !== true){\n\t\t\t\to.multidate = Number(o.multidate) || false;\n\t\t\t\tif (o.multidate !== false)\n\t\t\t\t\to.multidate = Math.max(0, o.multidate);\n\t\t\t}\n\t\t\to.multidateSeparator = String(o.multidateSeparator);\n\n\t\t\to.weekStart %= 7;\n\t\t\to.weekEnd = ((o.weekStart + 6) % 7);\n\n\t\t\tvar format = DPGlobal.parseFormat(o.format);\n\t\t\tif (o.startDate !== -Infinity){\n\t\t\t\tif (!!o.startDate){\n\t\t\t\t\tif (o.startDate instanceof Date)\n\t\t\t\t\t\to.startDate = this._local_to_utc(this._zero_time(o.startDate));\n\t\t\t\t\telse\n\t\t\t\t\t\to.startDate = DPGlobal.parseDate(o.startDate, format, o.language);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\to.startDate = -Infinity;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (o.endDate !== Infinity){\n\t\t\t\tif (!!o.endDate){\n\t\t\t\t\tif (o.endDate instanceof Date)\n\t\t\t\t\t\to.endDate = this._local_to_utc(this._zero_time(o.endDate));\n\t\t\t\t\telse\n\t\t\t\t\t\to.endDate = DPGlobal.parseDate(o.endDate, format, o.language);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\to.endDate = Infinity;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\to.daysOfWeekDisabled = o.daysOfWeekDisabled||[];\n\t\t\tif (!$.isArray(o.daysOfWeekDisabled))\n\t\t\t\to.daysOfWeekDisabled = o.daysOfWeekDisabled.split(/[,\\s]*/);\n\t\t\to.daysOfWeekDisabled = $.map(o.daysOfWeekDisabled, function(d){\n\t\t\t\treturn parseInt(d, 10);\n\t\t\t});\n\n\t\t\to.daysOfWeekHighlighted = o.daysOfWeekHighlighted||[];\n\t\t\tif (!$.isArray(o.daysOfWeekHighlighted))\n\t\t\t\to.daysOfWeekHighlighted = o.daysOfWeekHighlighted.split(/[,\\s]*/);\n\t\t\to.daysOfWeekHighlighted = $.map(o.daysOfWeekHighlighted, function(d){\n\t\t\t\treturn parseInt(d, 10);\n\t\t\t});\n\n\t\t\to.datesDisabled = o.datesDisabled||[];\n\t\t\tif (!$.isArray(o.datesDisabled)) {\n\t\t\t\tvar datesDisabled = [];\n\t\t\t\tdatesDisabled.push(DPGlobal.parseDate(o.datesDisabled, format, o.language));\n\t\t\t\to.datesDisabled = datesDisabled;\n\t\t\t}\n\t\t\to.datesDisabled = $.map(o.datesDisabled,function(d){\n\t\t\t\treturn DPGlobal.parseDate(d, format, o.language);\n\t\t\t});\n\n\t\t\tvar plc = String(o.orientation).toLowerCase().split(/\\s+/g),\n\t\t\t\t_plc = o.orientation.toLowerCase();\n\t\t\tplc = $.grep(plc, function(word){\n\t\t\t\treturn /^auto|left|right|top|bottom$/.test(word);\n\t\t\t});\n\t\t\to.orientation = {x: 'auto', y: 'auto'};\n\t\t\tif (!_plc || _plc === 'auto')\n\t\t\t\t; // no action\n\t\t\telse if (plc.length === 1){\n\t\t\t\tswitch (plc[0]){\n\t\t\t\t\tcase 'top':\n\t\t\t\t\tcase 'bottom':\n\t\t\t\t\t\to.orientation.y = plc[0];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'left':\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\to.orientation.x = plc[0];\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_plc = $.grep(plc, function(word){\n\t\t\t\t\treturn /^left|right$/.test(word);\n\t\t\t\t});\n\t\t\t\to.orientation.x = _plc[0] || 'auto';\n\n\t\t\t\t_plc = $.grep(plc, function(word){\n\t\t\t\t\treturn /^top|bottom$/.test(word);\n\t\t\t\t});\n\t\t\t\to.orientation.y = _plc[0] || 'auto';\n\t\t\t}\n\t\t\tif (o.defaultViewDate) {\n\t\t\t\tvar year = o.defaultViewDate.year || new Date().getFullYear();\n\t\t\t\tvar month = o.defaultViewDate.month || 0;\n\t\t\t\tvar day = o.defaultViewDate.day || 1;\n\t\t\t\to.defaultViewDate = UTCDate(year, month, day);\n\t\t\t} else {\n\t\t\t\to.defaultViewDate = UTCToday();\n\t\t\t}\n\t\t\to.showOnFocus = o.showOnFocus !== undefined ? o.showOnFocus : true;\n\t\t\to.zIndexOffset = o.zIndexOffset !== undefined ? o.zIndexOffset : 10;\n\t\t},\n\t\t_events: [],\n\t\t_secondaryEvents: [],\n\t\t_applyEvents: function(evs){\n\t\t\tfor (var i=0, el, ch, ev; i < evs.length; i++){\n\t\t\t\tel = evs[i][0];\n\t\t\t\tif (evs[i].length === 2){\n\t\t\t\t\tch = undefined;\n\t\t\t\t\tev = evs[i][1];\n\t\t\t\t}\n\t\t\t\telse if (evs[i].length === 3){\n\t\t\t\t\tch = evs[i][1];\n\t\t\t\t\tev = evs[i][2];\n\t\t\t\t}\n\t\t\t\tel.on(ev, ch);\n\t\t\t}\n\t\t},\n\t\t_unapplyEvents: function(evs){\n\t\t\tfor (var i=0, el, ev, ch; i < evs.length; i++){\n\t\t\t\tel = evs[i][0];\n\t\t\t\tif (evs[i].length === 2){\n\t\t\t\t\tch = undefined;\n\t\t\t\t\tev = evs[i][1];\n\t\t\t\t}\n\t\t\t\telse if (evs[i].length === 3){\n\t\t\t\t\tch = evs[i][1];\n\t\t\t\t\tev = evs[i][2];\n\t\t\t\t}\n\t\t\t\tel.off(ev, ch);\n\t\t\t}\n\t\t},\n\t\t_buildEvents: function(){\n            var events = {\n                keyup: $.proxy(function(e){\n                    if ($.inArray(e.keyCode, [27, 37, 39, 38, 40, 32, 13, 9]) === -1)\n                        this.update();\n                }, this),\n                keydown: $.proxy(this.keydown, this),\n                paste: $.proxy(this.paste, this)\n            };\n\n            if (this.o.showOnFocus === true) {\n                events.focus = $.proxy(this.show, this);\n            }\n\n            if (this.isInput) { // single input\n                this._events = [\n                    [this.element, events]\n                ];\n            }\n            else if (this.component && this.hasInput) { // component: input + button\n                this._events = [\n                    // For components that are not readonly, allow keyboard nav\n                    [this.element.find('input'), events],\n                    [this.component, {\n                        click: $.proxy(this.show, this)\n                    }]\n                ];\n            }\n\t\t\telse if (this.element.is('div')){  // inline datepicker\n\t\t\t\tthis.isInline = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._events = [\n\t\t\t\t\t[this.element, {\n\t\t\t\t\t\tclick: $.proxy(this.show, this)\n\t\t\t\t\t}]\n\t\t\t\t];\n\t\t\t}\n\t\t\tthis._events.push(\n\t\t\t\t// Component: listen for blur on element descendants\n\t\t\t\t[this.element, '*', {\n\t\t\t\t\tblur: $.proxy(function(e){\n\t\t\t\t\t\tthis._focused_from = e.target;\n\t\t\t\t\t}, this)\n\t\t\t\t}],\n\t\t\t\t// Input: listen for blur on element\n\t\t\t\t[this.element, {\n\t\t\t\t\tblur: $.proxy(function(e){\n\t\t\t\t\t\tthis._focused_from = e.target;\n\t\t\t\t\t}, this)\n\t\t\t\t}]\n\t\t\t);\n\n\t\t\tif (this.o.immediateUpdates) {\n\t\t\t\t// Trigger input updates immediately on changed year/month\n\t\t\t\tthis._events.push([this.element, {\n\t\t\t\t\t'changeYear changeMonth': $.proxy(function(e){\n\t\t\t\t\t\tthis.update(e.date);\n\t\t\t\t\t}, this)\n\t\t\t\t}]);\n\t\t\t}\n\n\t\t\tthis._secondaryEvents = [\n\t\t\t\t[this.picker, {\n\t\t\t\t\tclick: $.proxy(this.click, this)\n\t\t\t\t}],\n\t\t\t\t[$(window), {\n\t\t\t\t\tresize: $.proxy(this.place, this)\n\t\t\t\t}],\n\t\t\t\t[$(document), {\n\t\t\t\t\tmousedown: $.proxy(function(e){\n\t\t\t\t\t\t// Clicked outside the datepicker, hide it\n\t\t\t\t\t\tif (!(\n\t\t\t\t\t\t\tthis.element.is(e.target) ||\n\t\t\t\t\t\t\tthis.element.find(e.target).length ||\n\t\t\t\t\t\t\tthis.picker.is(e.target) ||\n\t\t\t\t\t\t\tthis.picker.find(e.target).length ||\n\t\t\t\t\t\t\tthis.picker.hasClass('datepicker-inline')\n\t\t\t\t\t\t)){\n\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this)\n\t\t\t\t}]\n\t\t\t];\n\t\t},\n\t\t_attachEvents: function(){\n\t\t\tthis._detachEvents();\n\t\t\tthis._applyEvents(this._events);\n\t\t},\n\t\t_detachEvents: function(){\n\t\t\tthis._unapplyEvents(this._events);\n\t\t},\n\t\t_attachSecondaryEvents: function(){\n\t\t\tthis._detachSecondaryEvents();\n\t\t\tthis._applyEvents(this._secondaryEvents);\n\t\t},\n\t\t_detachSecondaryEvents: function(){\n\t\t\tthis._unapplyEvents(this._secondaryEvents);\n\t\t},\n\t\t_trigger: function(event, altdate){\n\t\t\tvar date = altdate || this.dates.get(-1),\n\t\t\t\tlocal_date = this._utc_to_local(date);\n\n\t\t\tthis.element.trigger({\n\t\t\t\ttype: event,\n\t\t\t\tdate: local_date,\n\t\t\t\tdates: $.map(this.dates, this._utc_to_local),\n\t\t\t\tformat: $.proxy(function(ix, format){\n\t\t\t\t\tif (arguments.length === 0){\n\t\t\t\t\t\tix = this.dates.length - 1;\n\t\t\t\t\t\tformat = this.o.format;\n\t\t\t\t\t}\n\t\t\t\t\telse if (typeof ix === 'string'){\n\t\t\t\t\t\tformat = ix;\n\t\t\t\t\t\tix = this.dates.length - 1;\n\t\t\t\t\t}\n\t\t\t\t\tformat = format || this.o.format;\n\t\t\t\t\tvar date = this.dates.get(ix);\n\t\t\t\t\treturn DPGlobal.formatDate(date, format, this.o.language);\n\t\t\t\t}, this)\n\t\t\t});\n\t\t},\n\n\t\tshow: function(){\n\t\t\tif (this.element.attr('readonly') && this.o.enableOnReadonly === false)\n\t\t\t\treturn;\n\t\t\tif (!this.isInline)\n\t\t\t\tthis.picker.appendTo(this.o.container);\n\t\t\tthis.place();\n\t\t\tthis.picker.show();\n\t\t\tthis._attachSecondaryEvents();\n\t\t\tthis._trigger('show');\n\t\t\tif ((window.navigator.msMaxTouchPoints || 'ontouchstart' in document) && this.o.disableTouchKeyboard) {\n\t\t\t\t$(this.element).blur();\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\n\t\thide: function(){\n\t\t\tif (this.isInline)\n\t\t\t\treturn this;\n\t\t\tif (!this.picker.is(':visible'))\n\t\t\t\treturn this;\n\t\t\tthis.focusDate = null;\n\t\t\tthis.picker.hide().detach();\n\t\t\tthis._detachSecondaryEvents();\n\t\t\tthis.viewMode = this.o.startView;\n\t\t\tthis.showMode();\n\n\t\t\tif (\n\t\t\t\tthis.o.forceParse &&\n\t\t\t\t(\n\t\t\t\t\tthis.isInput && this.element.val() ||\n\t\t\t\t\tthis.hasInput && this.element.find('input').val()\n\t\t\t\t)\n\t\t\t)\n\t\t\t\tthis.setValue();\n\t\t\tthis._trigger('hide');\n\t\t\treturn this;\n\t\t},\n\n\t\tremove: function(){\n\t\t\tthis.hide();\n\t\t\tthis._detachEvents();\n\t\t\tthis._detachSecondaryEvents();\n\t\t\tthis.picker.remove();\n\t\t\tdelete this.element.data().datepicker;\n\t\t\tif (!this.isInput){\n\t\t\t\tdelete this.element.data().date;\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\n\t\tpaste: function(evt){\n\t\t\tvar dateString;\n\t\t\tif (evt.originalEvent.clipboardData && evt.originalEvent.clipboardData.types\n\t\t\t\t&& $.inArray('text/plain', evt.originalEvent.clipboardData.types) !== -1) {\n\t\t\t\tdateString = evt.originalEvent.clipboardData.getData('text/plain');\n\t\t\t}\n\t\t\telse if (window.clipboardData) {\n\t\t\t\tdateString = window.clipboardData.getData('Text');\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.setDate(dateString);\n\t\t\tthis.update();\n\t\t\tevt.preventDefault();\n\t\t},\n\n\t\t_utc_to_local: function(utc){\n\t\t\treturn utc && new Date(utc.getTime() + (utc.getTimezoneOffset()*60000));\n\t\t},\n\t\t_local_to_utc: function(local){\n\t\t\treturn local && new Date(local.getTime() - (local.getTimezoneOffset()*60000));\n\t\t},\n\t\t_zero_time: function(local){\n\t\t\treturn local && new Date(local.getFullYear(), local.getMonth(), local.getDate());\n\t\t},\n\t\t_zero_utc_time: function(utc){\n\t\t\treturn utc && new Date(Date.UTC(utc.getUTCFullYear(), utc.getUTCMonth(), utc.getUTCDate()));\n\t\t},\n\n\t\tgetDates: function(){\n\t\t\treturn $.map(this.dates, this._utc_to_local);\n\t\t},\n\n\t\tgetUTCDates: function(){\n\t\t\treturn $.map(this.dates, function(d){\n\t\t\t\treturn new Date(d);\n\t\t\t});\n\t\t},\n\n\t\tgetDate: function(){\n\t\t\treturn this._utc_to_local(this.getUTCDate());\n\t\t},\n\n\t\tgetUTCDate: function(){\n\t\t\tvar selected_date = this.dates.get(-1);\n\t\t\tif (typeof selected_date !== 'undefined') {\n\t\t\t\treturn new Date(selected_date);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\n\t\tclearDates: function(){\n\t\t\tvar element;\n\t\t\tif (this.isInput) {\n\t\t\t\telement = this.element;\n\t\t\t} else if (this.component) {\n\t\t\t\telement = this.element.find('input');\n\t\t\t}\n\n\t\t\tif (element) {\n\t\t\t\telement.val('');\n\t\t\t}\n\n\t\t\tthis.update();\n\t\t\tthis._trigger('changeDate');\n\n\t\t\tif (this.o.autoclose) {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t},\n\t\tsetDates: function(){\n\t\t\tvar args = $.isArray(arguments[0]) ? arguments[0] : arguments;\n\t\t\tthis.update.apply(this, args);\n\t\t\tthis._trigger('changeDate');\n\t\t\tthis.setValue();\n\t\t\treturn this;\n\t\t},\n\n\t\tsetUTCDates: function(){\n\t\t\tvar args = $.isArray(arguments[0]) ? arguments[0] : arguments;\n\t\t\tthis.update.apply(this, $.map(args, this._utc_to_local));\n\t\t\tthis._trigger('changeDate');\n\t\t\tthis.setValue();\n\t\t\treturn this;\n\t\t},\n\n\t\tsetDate: alias('setDates'),\n\t\tsetUTCDate: alias('setUTCDates'),\n\n\t\tsetValue: function(){\n\t\t\tvar formatted = this.getFormattedDate();\n\t\t\tif (!this.isInput){\n\t\t\t\tif (this.component){\n\t\t\t\t\tthis.element.find('input').val(formatted);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.element.val(formatted);\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\n\t\tgetFormattedDate: function(format){\n\t\t\tif (format === undefined)\n\t\t\t\tformat = this.o.format;\n\n\t\t\tvar lang = this.o.language;\n\t\t\treturn $.map(this.dates, function(d){\n\t\t\t\treturn DPGlobal.formatDate(d, format, lang);\n\t\t\t}).join(this.o.multidateSeparator);\n\t\t},\n\n\t\tsetStartDate: function(startDate){\n\t\t\tthis._process_options({startDate: startDate});\n\t\t\tthis.update();\n\t\t\tthis.updateNavArrows();\n\t\t\treturn this;\n\t\t},\n\n\t\tsetEndDate: function(endDate){\n\t\t\tthis._process_options({endDate: endDate});\n\t\t\tthis.update();\n\t\t\tthis.updateNavArrows();\n\t\t\treturn this;\n\t\t},\n\n\t\tsetDaysOfWeekDisabled: function(daysOfWeekDisabled){\n\t\t\tthis._process_options({daysOfWeekDisabled: daysOfWeekDisabled});\n\t\t\tthis.update();\n\t\t\tthis.updateNavArrows();\n\t\t\treturn this;\n\t\t},\n\n\t\tsetDaysOfWeekHighlighted: function(daysOfWeekHighlighted){\n\t\t\tthis._process_options({daysOfWeekHighlighted: daysOfWeekHighlighted});\n\t\t\tthis.update();\n\t\t\treturn this;\n\t\t},\n\n\t\tsetDatesDisabled: function(datesDisabled){\n\t\t\tthis._process_options({datesDisabled: datesDisabled});\n\t\t\tthis.update();\n\t\t\tthis.updateNavArrows();\n\t\t},\n\n\t\tplace: function(){\n\t\t\tif (this.isInline)\n\t\t\t\treturn this;\n\t\t\tvar calendarWidth = this.picker.outerWidth(),\n\t\t\t\tcalendarHeight = this.picker.outerHeight(),\n\t\t\t\tvisualPadding = 10,\n\t\t\t\tcontainer = $(this.o.container),\n\t\t\t\twindowWidth = container.width(),\n\t\t\t\tscrollTop = container.scrollTop(),\n\t\t\t\tappendOffset = container.offset();\n\n\t\t\tvar parentsZindex = [];\n\t\t\tthis.element.parents().each(function(){\n\t\t\t\tvar itemZIndex = $(this).css('z-index');\n\t\t\t\tif (itemZIndex !== 'auto' && itemZIndex !== 0) parentsZindex.push(parseInt(itemZIndex));\n\t\t\t});\n\t\t\tvar zIndex = Math.max.apply(Math, parentsZindex) + this.o.zIndexOffset;\n\t\t\tvar offset = this.component ? this.component.parent().offset() : this.element.offset();\n\t\t\tvar height = this.component ? this.component.outerHeight(true) : this.element.outerHeight(false);\n\t\t\tvar width = this.component ? this.component.outerWidth(true) : this.element.outerWidth(false);\n\t\t\tvar left = offset.left - appendOffset.left,\n\t\t\t\ttop = offset.top - appendOffset.top;\n\n\t\t\tthis.picker.removeClass(\n\t\t\t\t'datepicker-orient-top datepicker-orient-bottom '+\n\t\t\t\t'datepicker-orient-right datepicker-orient-left'\n\t\t\t);\n\n\t\t\tif (this.o.orientation.x !== 'auto'){\n\t\t\t\tthis.picker.addClass('datepicker-orient-' + this.o.orientation.x);\n\t\t\t\tif (this.o.orientation.x === 'right')\n\t\t\t\t\tleft -= calendarWidth - width;\n\t\t\t}\n\t\t\t// auto x orientation is best-placement: if it crosses a window\n\t\t\t// edge, fudge it sideways\n\t\t\telse {\n\t\t\t\tif (offset.left < 0) {\n\t\t\t\t\t// component is outside the window on the left side. Move it into visible range\n\t\t\t\t\tthis.picker.addClass('datepicker-orient-left');\n\t\t\t\t\tleft -= offset.left - visualPadding;\n\t\t\t\t} else if (left + calendarWidth > windowWidth) {\n\t\t\t\t\t// the calendar passes the widow right edge. Align it to component right side\n\t\t\t\t\tthis.picker.addClass('datepicker-orient-right');\n\t\t\t\t\tleft = offset.left + width - calendarWidth;\n\t\t\t\t} else {\n\t\t\t\t\t// Default to left\n\t\t\t\t\tthis.picker.addClass('datepicker-orient-left');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// auto y orientation is best-situation: top or bottom, no fudging,\n\t\t\t// decision based on which shows more of the calendar\n\t\t\tvar yorient = this.o.orientation.y,\n\t\t\t\ttop_overflow;\n\t\t\tif (yorient === 'auto'){\n\t\t\t\ttop_overflow = -scrollTop + top - calendarHeight;\n\t\t\t\tyorient = top_overflow < 0 ? 'bottom' : 'top';\n\t\t\t}\n\n\t\t\tthis.picker.addClass('datepicker-orient-' + yorient);\n\t\t\tif (yorient === 'top')\n\t\t\t\ttop -= calendarHeight + parseInt(this.picker.css('padding-top'));\n\t\t\telse\n\t\t\t\ttop += height;\n\n\t\t\tif (this.o.rtl) {\n\t\t\t\tvar right = windowWidth - (left + width);\n\t\t\t\tthis.picker.css({\n\t\t\t\t\ttop: top,\n\t\t\t\t\tright: right,\n\t\t\t\t\tzIndex: zIndex\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.picker.css({\n\t\t\t\t\ttop: top,\n\t\t\t\t\tleft: left,\n\t\t\t\t\tzIndex: zIndex\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\n\t\t_allow_update: true,\n\t\tupdate: function(){\n\t\t\tif (!this._allow_update)\n\t\t\t\treturn this;\n\n\t\t\tvar oldDates = this.dates.copy(),\n\t\t\t\tdates = [],\n\t\t\t\tfromArgs = false;\n\t\t\tif (arguments.length){\n\t\t\t\t$.each(arguments, $.proxy(function(i, date){\n\t\t\t\t\tif (date instanceof Date)\n\t\t\t\t\t\tdate = this._local_to_utc(date);\n\t\t\t\t\tdates.push(date);\n\t\t\t\t}, this));\n\t\t\t\tfromArgs = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdates = this.isInput\n\t\t\t\t\t\t? this.element.val()\n\t\t\t\t\t\t: this.element.data('date') || this.element.find('input').val();\n\t\t\t\tif (dates && this.o.multidate)\n\t\t\t\t\tdates = dates.split(this.o.multidateSeparator);\n\t\t\t\telse\n\t\t\t\t\tdates = [dates];\n\t\t\t\tdelete this.element.data().date;\n\t\t\t}\n\n\t\t\tdates = $.map(dates, $.proxy(function(date){\n\t\t\t\treturn DPGlobal.parseDate(date, this.o.format, this.o.language);\n\t\t\t}, this));\n\t\t\tdates = $.grep(dates, $.proxy(function(date){\n\t\t\t\treturn (\n\t\t\t\t\tdate < this.o.startDate ||\n\t\t\t\t\tdate > this.o.endDate ||\n\t\t\t\t\t!date\n\t\t\t\t);\n\t\t\t}, this), true);\n\t\t\tthis.dates.replace(dates);\n\n\t\t\tif (this.dates.length)\n\t\t\t\tthis.viewDate = new Date(this.dates.get(-1));\n\t\t\telse if (this.viewDate < this.o.startDate)\n\t\t\t\tthis.viewDate = new Date(this.o.startDate);\n\t\t\telse if (this.viewDate > this.o.endDate)\n\t\t\t\tthis.viewDate = new Date(this.o.endDate);\n\t\t\telse\n\t\t\t\tthis.viewDate = this.o.defaultViewDate;\n\n\t\t\tif (fromArgs){\n\t\t\t\t// setting date by clicking\n\t\t\t\tthis.setValue();\n\t\t\t}\n\t\t\telse if (dates.length){\n\t\t\t\t// setting date by typing\n\t\t\t\tif (String(oldDates) !== String(this.dates))\n\t\t\t\t\tthis._trigger('changeDate');\n\t\t\t}\n\t\t\tif (!this.dates.length && oldDates.length)\n\t\t\t\tthis._trigger('clearDate');\n\n\t\t\tthis.fill();\n\t\t\tthis.element.change();\n\t\t\treturn this;\n\t\t},\n\n\t\tfillDow: function(){\n\t\t\tvar dowCnt = this.o.weekStart,\n\t\t\t\thtml = '<tr>';\n\t\t\tif (this.o.calendarWeeks){\n\t\t\t\tthis.picker.find('.datepicker-days .datepicker-switch')\n\t\t\t\t\t.attr('colspan', function(i, val){\n\t\t\t\t\t\treturn parseInt(val) + 1;\n\t\t\t\t\t});\n\t\t\t\thtml += '<th class=\"cw\">&#160;</th>';\n\t\t\t}\n\t\t\twhile (dowCnt < this.o.weekStart + 7){\n\t\t\t\thtml += '<th class=\"dow\">'+dates[this.o.language].daysMin[(dowCnt++)%7]+'</th>';\n\t\t\t}\n\t\t\thtml += '</tr>';\n\t\t\tthis.picker.find('.datepicker-days thead').append(html);\n\t\t},\n\n\t\tfillMonths: function(){\n\t\t\tvar html = '',\n\t\t\ti = 0;\n\t\t\twhile (i < 12){\n\t\t\t\thtml += '<span class=\"month\">'+dates[this.o.language].monthsShort[i++]+'</span>';\n\t\t\t}\n\t\t\tthis.picker.find('.datepicker-months td').html(html);\n\t\t},\n\n\t\tsetRange: function(range){\n\t\t\tif (!range || !range.length)\n\t\t\t\tdelete this.range;\n\t\t\telse\n\t\t\t\tthis.range = $.map(range, function(d){\n\t\t\t\t\treturn d.valueOf();\n\t\t\t\t});\n\t\t\tthis.fill();\n\t\t},\n\n\t\tgetClassNames: function(date){\n\t\t\tvar cls = [],\n\t\t\t\tyear = this.viewDate.getUTCFullYear(),\n\t\t\t\tmonth = this.viewDate.getUTCMonth(),\n\t\t\t\ttoday = new Date();\n\t\t\tif (date.getUTCFullYear() < year || (date.getUTCFullYear() === year && date.getUTCMonth() < month)){\n\t\t\t\tcls.push('old');\n\t\t\t}\n\t\t\telse if (date.getUTCFullYear() > year || (date.getUTCFullYear() === year && date.getUTCMonth() > month)){\n\t\t\t\tcls.push('new');\n\t\t\t}\n\t\t\tif (this.focusDate && date.valueOf() === this.focusDate.valueOf())\n\t\t\t\tcls.push('focused');\n\t\t\t// Compare internal UTC date with local today, not UTC today\n\t\t\tif (this.o.todayHighlight &&\n\t\t\t\tdate.getUTCFullYear() === today.getFullYear() &&\n\t\t\t\tdate.getUTCMonth() === today.getMonth() &&\n\t\t\t\tdate.getUTCDate() === today.getDate()){\n\t\t\t\tcls.push('today');\n\t\t\t}\n\t\t\tif (this.dates.contains(date) !== -1)\n\t\t\t\tcls.push('active');\n\t\t\tif (date.valueOf() < this.o.startDate || date.valueOf() > this.o.endDate ||\n\t\t\t\t$.inArray(date.getUTCDay(), this.o.daysOfWeekDisabled) !== -1){\n\t\t\t\tcls.push('disabled');\n\t\t\t}\n\t\t\tif ($.inArray(date.getUTCDay(), this.o.daysOfWeekHighlighted) !== -1){\n\t\t\t\tcls.push('highlighted');\n\t\t\t}\n\t\t\tif (this.o.datesDisabled.length > 0 &&\n\t\t\t\t$.grep(this.o.datesDisabled, function(d){\n\t\t\t\t\treturn isUTCEquals(date, d); }).length > 0) {\n\t\t\t\tcls.push('disabled', 'disabled-date');\n\t\t\t}\n\n\t\t\tif (this.range){\n\t\t\t\tif (date > this.range[0] && date < this.range[this.range.length-1]){\n\t\t\t\t\tcls.push('range');\n\t\t\t\t}\n\t\t\t\tif ($.inArray(date.valueOf(), this.range) !== -1){\n\t\t\t\t\tcls.push('selected');\n\t\t\t\t}\n\t\t\t\tif (date.valueOf() === this.range[0]){\n          cls.push('range-start');\n        }\n        if (date.valueOf() === this.range[this.range.length-1]){\n          cls.push('range-end');\n        }\n\t\t\t}\n\t\t\treturn cls;\n\t\t},\n\n\t\tfill: function(){\n\t\t\tvar d = new Date(this.viewDate),\n\t\t\t\tyear = d.getUTCFullYear(),\n\t\t\t\tmonth = d.getUTCMonth(),\n\t\t\t\tstartYear = this.o.startDate !== -Infinity ? this.o.startDate.getUTCFullYear() : -Infinity,\n\t\t\t\tstartMonth = this.o.startDate !== -Infinity ? this.o.startDate.getUTCMonth() : -Infinity,\n\t\t\t\tendYear = this.o.endDate !== Infinity ? this.o.endDate.getUTCFullYear() : Infinity,\n\t\t\t\tendMonth = this.o.endDate !== Infinity ? this.o.endDate.getUTCMonth() : Infinity,\n\t\t\t\ttodaytxt = dates[this.o.language].today || dates['en'].today || '',\n\t\t\t\tcleartxt = dates[this.o.language].clear || dates['en'].clear || '',\n\t\t\t\ttitleFormat = dates[this.o.language].titleFormat || dates['en'].titleFormat,\n\t\t\t\ttooltip;\n\t\t\tif (isNaN(year) || isNaN(month))\n\t\t\t\treturn;\n\t\t\tthis.picker.find('.datepicker-days thead .datepicker-switch')\n\t\t\t\t\t\t.text(DPGlobal.formatDate(new UTCDate(year, month), titleFormat, this.o.language));\n\t\t\tthis.picker.find('tfoot .today')\n\t\t\t\t\t\t.text(todaytxt)\n\t\t\t\t\t\t.toggle(this.o.todayBtn !== false);\n\t\t\tthis.picker.find('tfoot .clear')\n\t\t\t\t\t\t.text(cleartxt)\n\t\t\t\t\t\t.toggle(this.o.clearBtn !== false);\n\t\t\tthis.picker.find('thead .datepicker-title')\n\t\t\t\t\t\t.text(this.o.title)\n\t\t\t\t\t\t.toggle(this.o.title !== '');\n\t\t\tthis.updateNavArrows();\n\t\t\tthis.fillMonths();\n\t\t\tvar prevMonth = UTCDate(year, month-1, 28),\n\t\t\t\tday = DPGlobal.getDaysInMonth(prevMonth.getUTCFullYear(), prevMonth.getUTCMonth());\n\t\t\tprevMonth.setUTCDate(day);\n\t\t\tprevMonth.setUTCDate(day - (prevMonth.getUTCDay() - this.o.weekStart + 7)%7);\n\t\t\tvar nextMonth = new Date(prevMonth);\n\t\t\tif (prevMonth.getUTCFullYear() < 100){\n        nextMonth.setUTCFullYear(prevMonth.getUTCFullYear());\n      }\n\t\t\tnextMonth.setUTCDate(nextMonth.getUTCDate() + 42);\n\t\t\tnextMonth = nextMonth.valueOf();\n\t\t\tvar html = [];\n\t\t\tvar clsName;\n\t\t\twhile (prevMonth.valueOf() < nextMonth){\n\t\t\t\tif (prevMonth.getUTCDay() === this.o.weekStart){\n\t\t\t\t\thtml.push('<tr>');\n\t\t\t\t\tif (this.o.calendarWeeks){\n\t\t\t\t\t\t// ISO 8601: First week contains first thursday.\n\t\t\t\t\t\t// ISO also states week starts on Monday, but we can be more abstract here.\n\t\t\t\t\t\tvar\n\t\t\t\t\t\t\t// Start of current week: based on weekstart/current date\n\t\t\t\t\t\t\tws = new Date(+prevMonth + (this.o.weekStart - prevMonth.getUTCDay() - 7) % 7 * 864e5),\n\t\t\t\t\t\t\t// Thursday of this week\n\t\t\t\t\t\t\tth = new Date(Number(ws) + (7 + 4 - ws.getUTCDay()) % 7 * 864e5),\n\t\t\t\t\t\t\t// First Thursday of year, year from thursday\n\t\t\t\t\t\t\tyth = new Date(Number(yth = UTCDate(th.getUTCFullYear(), 0, 1)) + (7 + 4 - yth.getUTCDay())%7*864e5),\n\t\t\t\t\t\t\t// Calendar week: ms between thursdays, div ms per day, div 7 days\n\t\t\t\t\t\t\tcalWeek =  (th - yth) / 864e5 / 7 + 1;\n\t\t\t\t\t\thtml.push('<td class=\"cw\">'+ calWeek +'</td>');\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tclsName = this.getClassNames(prevMonth);\n\t\t\t\tclsName.push('day');\n\n\t\t\t\tif (this.o.beforeShowDay !== $.noop){\n\t\t\t\t\tvar before = this.o.beforeShowDay(this._utc_to_local(prevMonth));\n\t\t\t\t\tif (before === undefined)\n\t\t\t\t\t\tbefore = {};\n\t\t\t\t\telse if (typeof(before) === 'boolean')\n\t\t\t\t\t\tbefore = {enabled: before};\n\t\t\t\t\telse if (typeof(before) === 'string')\n\t\t\t\t\t\tbefore = {classes: before};\n\t\t\t\t\tif (before.enabled === false)\n\t\t\t\t\t\tclsName.push('disabled');\n\t\t\t\t\tif (before.classes)\n\t\t\t\t\t\tclsName = clsName.concat(before.classes.split(/\\s+/));\n\t\t\t\t\tif (before.tooltip)\n\t\t\t\t\t\ttooltip = before.tooltip;\n\t\t\t\t}\n\n\t\t\t\tclsName = $.unique(clsName);\n\t\t\t\thtml.push('<td class=\"'+clsName.join(' ')+'\"' + (tooltip ? ' title=\"'+tooltip+'\"' : '') + '>'+prevMonth.getUTCDate() + '</td>');\n\t\t\t\ttooltip = null;\n\t\t\t\tif (prevMonth.getUTCDay() === this.o.weekEnd){\n\t\t\t\t\thtml.push('</tr>');\n\t\t\t\t}\n\t\t\t\tprevMonth.setUTCDate(prevMonth.getUTCDate()+1);\n\t\t\t}\n\t\t\tthis.picker.find('.datepicker-days tbody').empty().append(html.join(''));\n\n\t\t\tvar months = this.picker.find('.datepicker-months')\n\t\t\t\t\t\t.find('.datepicker-switch')\n\t\t\t\t\t\t\t.text(this.o.maxViewMode < 2 ? 'Months' : year)\n\t\t\t\t\t\t\t.end()\n\t\t\t\t\t\t.find('span').removeClass('active');\n\n\t\t\t$.each(this.dates, function(i, d){\n\t\t\t\tif (d.getUTCFullYear() === year)\n\t\t\t\t\tmonths.eq(d.getUTCMonth()).addClass('active');\n\t\t\t});\n\n\t\t\tif (year < startYear || year > endYear){\n\t\t\t\tmonths.addClass('disabled');\n\t\t\t}\n\t\t\tif (year === startYear){\n\t\t\t\tmonths.slice(0, startMonth).addClass('disabled');\n\t\t\t}\n\t\t\tif (year === endYear){\n\t\t\t\tmonths.slice(endMonth+1).addClass('disabled');\n\t\t\t}\n\n\t\t\tif (this.o.beforeShowMonth !== $.noop){\n\t\t\t\tvar that = this;\n\t\t\t\t$.each(months, function(i, month){\n\t\t\t\t\tif (!$(month).hasClass('disabled')) {\n\t\t\t\t\t\tvar moDate = new Date(year, i, 1);\n\t\t\t\t\t\tvar before = that.o.beforeShowMonth(moDate);\n\t\t\t\t\t\tif (before === false)\n\t\t\t\t\t\t\t$(month).addClass('disabled');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\thtml = '';\n\t\t\tyear = parseInt(year/10, 10) * 10;\n\t\t\tvar yearCont = this.picker.find('.datepicker-years')\n\t\t\t\t\t\t\t\t.find('.datepicker-switch')\n\t\t\t\t\t\t\t\t\t.text(year + '-' + (year + 9))\n\t\t\t\t\t\t\t\t\t.end()\n\t\t\t\t\t\t\t\t.find('td');\n\t\t\tyear -= 1;\n\t\t\tvar years = $.map(this.dates, function(d){\n\t\t\t\t\treturn d.getUTCFullYear();\n\t\t\t\t}),\n\t\t\t\tclasses;\n\t\t\tfor (var i = -1; i < 11; i++){\n\t\t\t\tclasses = ['year'];\n\t\t\t\ttooltip = null;\n\n\t\t\t\tif (i === -1)\n\t\t\t\t\tclasses.push('old');\n\t\t\t\telse if (i === 10)\n\t\t\t\t\tclasses.push('new');\n\t\t\t\tif ($.inArray(year, years) !== -1)\n\t\t\t\t\tclasses.push('active');\n\t\t\t\tif (year < startYear || year > endYear)\n\t\t\t\t\tclasses.push('disabled');\n\n\t\t\t\tif (this.o.beforeShowYear !== $.noop) {\n\t\t\t\t\tvar yrBefore = this.o.beforeShowYear(new Date(year, 0, 1));\n\t\t\t\t\tif (yrBefore === undefined)\n\t\t\t\t\t\tyrBefore = {};\n\t\t\t\t\telse if (typeof(yrBefore) === 'boolean')\n\t\t\t\t\t\tyrBefore = {enabled: yrBefore};\n\t\t\t\t\telse if (typeof(yrBefore) === 'string')\n\t\t\t\t\t\tyrBefore = {classes: yrBefore};\n\t\t\t\t\tif (yrBefore.enabled === false)\n\t\t\t\t\t\tclasses.push('disabled');\n\t\t\t\t\tif (yrBefore.classes)\n\t\t\t\t\t\tclasses = classes.concat(yrBefore.classes.split(/\\s+/));\n\t\t\t\t\tif (yrBefore.tooltip)\n\t\t\t\t\t\ttooltip = yrBefore.tooltip;\n\t\t\t\t}\n\n\t\t\t\thtml += '<span class=\"' + classes.join(' ') + '\"' + (tooltip ? ' title=\"'+tooltip+'\"' : '') + '>' + year + '</span>';\n\t\t\t\tyear += 1;\n\t\t\t}\n\t\t\tyearCont.html(html);\n\t\t},\n\n\t\tupdateNavArrows: function(){\n\t\t\tif (!this._allow_update)\n\t\t\t\treturn;\n\n\t\t\tvar d = new Date(this.viewDate),\n\t\t\t\tyear = d.getUTCFullYear(),\n\t\t\t\tmonth = d.getUTCMonth();\n\t\t\tswitch (this.viewMode){\n\t\t\t\tcase 0:\n\t\t\t\t\tif (this.o.startDate !== -Infinity && year <= this.o.startDate.getUTCFullYear() && month <= this.o.startDate.getUTCMonth()){\n\t\t\t\t\t\tthis.picker.find('.prev').css({visibility: 'hidden'});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.picker.find('.prev').css({visibility: 'visible'});\n\t\t\t\t\t}\n\t\t\t\t\tif (this.o.endDate !== Infinity && year >= this.o.endDate.getUTCFullYear() && month >= this.o.endDate.getUTCMonth()){\n\t\t\t\t\t\tthis.picker.find('.next').css({visibility: 'hidden'});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.picker.find('.next').css({visibility: 'visible'});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\tcase 2:\n\t\t\t\t\tif (this.o.startDate !== -Infinity && year <= this.o.startDate.getUTCFullYear() || this.o.maxViewMode < 2){\n\t\t\t\t\t\tthis.picker.find('.prev').css({visibility: 'hidden'});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.picker.find('.prev').css({visibility: 'visible'});\n\t\t\t\t\t}\n\t\t\t\t\tif (this.o.endDate !== Infinity && year >= this.o.endDate.getUTCFullYear() || this.o.maxViewMode < 2){\n\t\t\t\t\t\tthis.picker.find('.next').css({visibility: 'hidden'});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.picker.find('.next').css({visibility: 'visible'});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\t\tclick: function(e){\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tvar target = $(e.target).closest('span, td, th'),\n\t\t\t\tyear, month, day;\n\t\t\tif (target.length === 1){\n\t\t\t\tswitch (target[0].nodeName.toLowerCase()){\n\t\t\t\t\tcase 'th':\n\t\t\t\t\t\tswitch (target[0].className){\n\t\t\t\t\t\t\tcase 'datepicker-switch':\n\t\t\t\t\t\t\t\tthis.showMode(1);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'prev':\n\t\t\t\t\t\t\tcase 'next':\n\t\t\t\t\t\t\t\tvar dir = DPGlobal.modes[this.viewMode].navStep * (target[0].className === 'prev' ? -1 : 1);\n\t\t\t\t\t\t\t\tswitch (this.viewMode){\n\t\t\t\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\t\t\t\t\tthis.viewDate = this.moveMonth(this.viewDate, dir);\n\t\t\t\t\t\t\t\t\t\tthis._trigger('changeMonth', this.viewDate);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\t\t\tthis.viewDate = this.moveYear(this.viewDate, dir);\n\t\t\t\t\t\t\t\t\t\tif (this.viewMode === 1)\n\t\t\t\t\t\t\t\t\t\t\tthis._trigger('changeYear', this.viewDate);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.fill();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'today':\n\t\t\t\t\t\t\t\tvar date = new Date();\n\t\t\t\t\t\t\t\tdate = UTCDate(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0);\n\n\t\t\t\t\t\t\t\tthis.showMode(-2);\n\t\t\t\t\t\t\t\tvar which = this.o.todayBtn === 'linked' ? null : 'view';\n\t\t\t\t\t\t\t\tthis._setDate(date, which);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'clear':\n\t\t\t\t\t\t\t\tthis.clearDates();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'span':\n\t\t\t\t\t\tif (!target.hasClass('disabled')){\n\t\t\t\t\t\t\tthis.viewDate.setUTCDate(1);\n\t\t\t\t\t\t\tif (target.hasClass('month')){\n\t\t\t\t\t\t\t\tday = 1;\n\t\t\t\t\t\t\t\tmonth = target.parent().find('span').index(target);\n\t\t\t\t\t\t\t\tyear = this.viewDate.getUTCFullYear();\n\t\t\t\t\t\t\t\tthis.viewDate.setUTCMonth(month);\n\t\t\t\t\t\t\t\tthis._trigger('changeMonth', this.viewDate);\n\t\t\t\t\t\t\t\tif (this.o.minViewMode === 1){\n\t\t\t\t\t\t\t\t\tthis._setDate(UTCDate(year, month, day));\n\t\t\t\t\t\t\t\t\tthis.showMode();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthis.showMode(-1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tday = 1;\n\t\t\t\t\t\t\t\tmonth = 0;\n\t\t\t\t\t\t\t\tyear = parseInt(target.text(), 10)||0;\n\t\t\t\t\t\t\t\tthis.viewDate.setUTCFullYear(year);\n\t\t\t\t\t\t\t\tthis._trigger('changeYear', this.viewDate);\n\t\t\t\t\t\t\t\tif (this.o.minViewMode === 2){\n\t\t\t\t\t\t\t\t\tthis._setDate(UTCDate(year, month, day));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.showMode(-1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.fill();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'td':\n\t\t\t\t\t\tif (target.hasClass('day') && !target.hasClass('disabled')){\n\t\t\t\t\t\t\tday = parseInt(target.text(), 10)||1;\n\t\t\t\t\t\t\tyear = this.viewDate.getUTCFullYear();\n\t\t\t\t\t\t\tmonth = this.viewDate.getUTCMonth();\n\t\t\t\t\t\t\tif (target.hasClass('old')){\n\t\t\t\t\t\t\t\tif (month === 0){\n\t\t\t\t\t\t\t\t\tmonth = 11;\n\t\t\t\t\t\t\t\t\tyear -= 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tmonth -= 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (target.hasClass('new')){\n\t\t\t\t\t\t\t\tif (month === 11){\n\t\t\t\t\t\t\t\t\tmonth = 0;\n\t\t\t\t\t\t\t\t\tyear += 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tmonth += 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis._setDate(UTCDate(year, month, day));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.picker.is(':visible') && this._focused_from){\n\t\t\t\t$(this._focused_from).focus();\n\t\t\t}\n\t\t\tdelete this._focused_from;\n\t\t},\n\n\t\t_toggle_multidate: function(date){\n\t\t\tvar ix = this.dates.contains(date);\n\t\t\tif (!date){\n\t\t\t\tthis.dates.clear();\n\t\t\t}\n\n\t\t\tif (ix !== -1){\n\t\t\t\tif (this.o.multidate === true || this.o.multidate > 1 || this.o.toggleActive){\n\t\t\t\t\tthis.dates.remove(ix);\n\t\t\t\t}\n\t\t\t} else if (this.o.multidate === false) {\n\t\t\t\tthis.dates.clear();\n\t\t\t\tthis.dates.push(date);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.dates.push(date);\n\t\t\t}\n\n\t\t\tif (typeof this.o.multidate === 'number')\n\t\t\t\twhile (this.dates.length > this.o.multidate)\n\t\t\t\t\tthis.dates.remove(0);\n\t\t},\n\n\t\t_setDate: function(date, which){\n\t\t\tif (!which || which === 'date')\n\t\t\t\tthis._toggle_multidate(date && new Date(date));\n\t\t\tif (!which || which  === 'view')\n\t\t\t\tthis.viewDate = date && new Date(date);\n\n\t\t\tthis.fill();\n\t\t\tthis.setValue();\n\t\t\tif (!which || which  !== 'view') {\n\t\t\t\tthis._trigger('changeDate');\n\t\t\t}\n\t\t\tvar element;\n\t\t\tif (this.isInput){\n\t\t\t\telement = this.element;\n\t\t\t}\n\t\t\telse if (this.component){\n\t\t\t\telement = this.element.find('input');\n\t\t\t}\n\t\t\tif (element){\n\t\t\t\telement.change();\n\t\t\t}\n\t\t\tif (this.o.autoclose && (!which || which === 'date')){\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t},\n\n\t\tmoveMonth: function(date, dir){\n\t\t\tif (!isValidDate(date))\n\t\t\t\treturn this.o.defaultViewDate;\n\t\t\tif (!dir)\n\t\t\t\treturn date;\n\t\t\tvar new_date = new Date(date.valueOf()),\n\t\t\t\tday = new_date.getUTCDate(),\n\t\t\t\tmonth = new_date.getUTCMonth(),\n\t\t\t\tmag = Math.abs(dir),\n\t\t\t\tnew_month, test;\n\t\t\tdir = dir > 0 ? 1 : -1;\n\t\t\tif (mag === 1){\n\t\t\t\ttest = dir === -1\n\t\t\t\t\t// If going back one month, make sure month is not current month\n\t\t\t\t\t// (eg, Mar 31 -> Feb 31 == Feb 28, not Mar 02)\n\t\t\t\t\t? function(){\n\t\t\t\t\t\treturn new_date.getUTCMonth() === month;\n\t\t\t\t\t}\n\t\t\t\t\t// If going forward one month, make sure month is as expected\n\t\t\t\t\t// (eg, Jan 31 -> Feb 31 == Feb 28, not Mar 02)\n\t\t\t\t\t: function(){\n\t\t\t\t\t\treturn new_date.getUTCMonth() !== new_month;\n\t\t\t\t\t};\n\t\t\t\tnew_month = month + dir;\n\t\t\t\tnew_date.setUTCMonth(new_month);\n\t\t\t\t// Dec -> Jan (12) or Jan -> Dec (-1) -- limit expected date to 0-11\n\t\t\t\tif (new_month < 0 || new_month > 11)\n\t\t\t\t\tnew_month = (new_month + 12) % 12;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// For magnitudes >1, move one month at a time...\n\t\t\t\tfor (var i=0; i < mag; i++)\n\t\t\t\t\t// ...which might decrease the day (eg, Jan 31 to Feb 28, etc)...\n\t\t\t\t\tnew_date = this.moveMonth(new_date, dir);\n\t\t\t\t// ...then reset the day, keeping it in the new month\n\t\t\t\tnew_month = new_date.getUTCMonth();\n\t\t\t\tnew_date.setUTCDate(day);\n\t\t\t\ttest = function(){\n\t\t\t\t\treturn new_month !== new_date.getUTCMonth();\n\t\t\t\t};\n\t\t\t}\n\t\t\t// Common date-resetting loop -- if date is beyond end of month, make it\n\t\t\t// end of month\n\t\t\twhile (test()){\n\t\t\t\tnew_date.setUTCDate(--day);\n\t\t\t\tnew_date.setUTCMonth(new_month);\n\t\t\t}\n\t\t\treturn new_date;\n\t\t},\n\n\t\tmoveYear: function(date, dir){\n\t\t\treturn this.moveMonth(date, dir*12);\n\t\t},\n\n\t\tdateWithinRange: function(date){\n\t\t\treturn date >= this.o.startDate && date <= this.o.endDate;\n\t\t},\n\n\t\tkeydown: function(e){\n\t\t\tif (!this.picker.is(':visible')){\n\t\t\t\tif (e.keyCode === 40 || e.keyCode === 27) { // allow down to re-show picker\n\t\t\t\t\tthis.show();\n\t\t\t\t\te.stopPropagation();\n        }\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar dateChanged = false,\n\t\t\t\tdir, newDate, newViewDate,\n\t\t\t\tfocusDate = this.focusDate || this.viewDate;\n\t\t\tswitch (e.keyCode){\n\t\t\t\tcase 27: // escape\n\t\t\t\t\tif (this.focusDate){\n\t\t\t\t\t\tthis.focusDate = null;\n\t\t\t\t\t\tthis.viewDate = this.dates.get(-1) || this.viewDate;\n\t\t\t\t\t\tthis.fill();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 37: // left\n\t\t\t\tcase 39: // right\n\t\t\t\t\tif (!this.o.keyboardNavigation)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdir = e.keyCode === 37 ? -1 : 1;\n\t\t\t\t\tif (e.ctrlKey){\n\t\t\t\t\t\tnewDate = this.moveYear(this.dates.get(-1) || UTCToday(), dir);\n\t\t\t\t\t\tnewViewDate = this.moveYear(focusDate, dir);\n\t\t\t\t\t\tthis._trigger('changeYear', this.viewDate);\n\t\t\t\t\t}\n\t\t\t\t\telse if (e.shiftKey){\n\t\t\t\t\t\tnewDate = this.moveMonth(this.dates.get(-1) || UTCToday(), dir);\n\t\t\t\t\t\tnewViewDate = this.moveMonth(focusDate, dir);\n\t\t\t\t\t\tthis._trigger('changeMonth', this.viewDate);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tnewDate = new Date(this.dates.get(-1) || UTCToday());\n\t\t\t\t\t\tnewDate.setUTCDate(newDate.getUTCDate() + dir);\n\t\t\t\t\t\tnewViewDate = new Date(focusDate);\n\t\t\t\t\t\tnewViewDate.setUTCDate(focusDate.getUTCDate() + dir);\n\t\t\t\t\t}\n\t\t\t\t\tif (this.dateWithinRange(newViewDate)){\n\t\t\t\t\t\tthis.focusDate = this.viewDate = newViewDate;\n\t\t\t\t\t\tthis.setValue();\n\t\t\t\t\t\tthis.fill();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 38: // up\n\t\t\t\tcase 40: // down\n\t\t\t\t\tif (!this.o.keyboardNavigation)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdir = e.keyCode === 38 ? -1 : 1;\n\t\t\t\t\tif (e.ctrlKey){\n\t\t\t\t\t\tnewDate = this.moveYear(this.dates.get(-1) || UTCToday(), dir);\n\t\t\t\t\t\tnewViewDate = this.moveYear(focusDate, dir);\n\t\t\t\t\t\tthis._trigger('changeYear', this.viewDate);\n\t\t\t\t\t}\n\t\t\t\t\telse if (e.shiftKey){\n\t\t\t\t\t\tnewDate = this.moveMonth(this.dates.get(-1) || UTCToday(), dir);\n\t\t\t\t\t\tnewViewDate = this.moveMonth(focusDate, dir);\n\t\t\t\t\t\tthis._trigger('changeMonth', this.viewDate);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tnewDate = new Date(this.dates.get(-1) || UTCToday());\n\t\t\t\t\t\tnewDate.setUTCDate(newDate.getUTCDate() + dir * 7);\n\t\t\t\t\t\tnewViewDate = new Date(focusDate);\n\t\t\t\t\t\tnewViewDate.setUTCDate(focusDate.getUTCDate() + dir * 7);\n\t\t\t\t\t}\n\t\t\t\t\tif (this.dateWithinRange(newViewDate)){\n\t\t\t\t\t\tthis.focusDate = this.viewDate = newViewDate;\n\t\t\t\t\t\tthis.setValue();\n\t\t\t\t\t\tthis.fill();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 32: // spacebar\n\t\t\t\t\t// Spacebar is used in manually typing dates in some formats.\n\t\t\t\t\t// As such, its behavior should not be hijacked.\n\t\t\t\t\tbreak;\n\t\t\t\tcase 13: // enter\n\t\t\t\t\tif (!this.o.forceParse) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tfocusDate = this.focusDate || this.dates.get(-1) || this.viewDate;\n\t\t\t\t\tif (this.o.keyboardNavigation) {\n\t\t\t\t\t\tthis._toggle_multidate(focusDate);\n\t\t\t\t\t\tdateChanged = true;\n\t\t\t\t\t}\n\t\t\t\t\tthis.focusDate = null;\n\t\t\t\t\tthis.viewDate = this.dates.get(-1) || this.viewDate;\n\t\t\t\t\tthis.setValue();\n\t\t\t\t\tthis.fill();\n\t\t\t\t\tif (this.picker.is(':visible')){\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tif (typeof e.stopPropagation === 'function') {\n\t\t\t\t\t\t\te.stopPropagation(); // All modern browsers, IE9+\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\te.cancelBubble = true; // IE6,7,8 ignore \"stopPropagation\"\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.o.autoclose)\n\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 9: // tab\n\t\t\t\t\tthis.focusDate = null;\n\t\t\t\t\tthis.viewDate = this.dates.get(-1) || this.viewDate;\n\t\t\t\t\tthis.fill();\n\t\t\t\t\tthis.hide();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (dateChanged){\n\t\t\t\tif (this.dates.length)\n\t\t\t\t\tthis._trigger('changeDate');\n\t\t\t\telse\n\t\t\t\t\tthis._trigger('clearDate');\n\t\t\t\tvar element;\n\t\t\t\tif (this.isInput){\n\t\t\t\t\telement = this.element;\n\t\t\t\t}\n\t\t\t\telse if (this.component){\n\t\t\t\t\telement = this.element.find('input');\n\t\t\t\t}\n\t\t\t\tif (element){\n\t\t\t\t\telement.change();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tshowMode: function(dir){\n\t\t\tif (dir){\n\t\t\t\tthis.viewMode = Math.max(this.o.minViewMode, Math.min(this.o.maxViewMode, this.viewMode + dir));\n\t\t\t}\n\t\t\tthis.picker\n\t\t\t\t.children('div')\n\t\t\t\t.hide()\n\t\t\t\t.filter('.datepicker-' + DPGlobal.modes[this.viewMode].clsName)\n\t\t\t\t\t.show();\n\t\t\tthis.updateNavArrows();\n\t\t}\n\t};\n\n\tvar DateRangePicker = function(element, options){\n\t\tthis.element = $(element);\n\t\tthis.inputs = $.map(options.inputs, function(i){\n\t\t\treturn i.jquery ? i[0] : i;\n\t\t});\n\t\tdelete options.inputs;\n\n\t\tdatepickerPlugin.call($(this.inputs), options)\n\t\t\t.on('changeDate', $.proxy(this.dateUpdated, this));\n\n\t\tthis.pickers = $.map(this.inputs, function(i){\n\t\t\treturn $(i).data('datepicker');\n\t\t});\n\t\tthis.updateDates();\n\t};\n\tDateRangePicker.prototype = {\n\t\tupdateDates: function(){\n\t\t\tthis.dates = $.map(this.pickers, function(i){\n\t\t\t\treturn i.getUTCDate();\n\t\t\t});\n\t\t\tthis.updateRanges();\n\t\t},\n\t\tupdateRanges: function(){\n\t\t\tvar range = $.map(this.dates, function(d){\n\t\t\t\treturn d.valueOf();\n\t\t\t});\n\t\t\t$.each(this.pickers, function(i, p){\n\t\t\t\tp.setRange(range);\n\t\t\t});\n\t\t},\n\t\tdateUpdated: function(e){\n\t\t\t// `this.updating` is a workaround for preventing infinite recursion\n\t\t\t// between `changeDate` triggering and `setUTCDate` calling.  Until\n\t\t\t// there is a better mechanism.\n\t\t\tif (this.updating)\n\t\t\t\treturn;\n\t\t\tthis.updating = true;\n\n\t\t\tvar dp = $(e.target).data('datepicker');\n\n\t\t\tif (typeof(dp) === \"undefined\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar new_date = dp.getUTCDate(),\n\t\t\t\ti = $.inArray(e.target, this.inputs),\n\t\t\t\tj = i - 1,\n\t\t\t\tk = i + 1,\n\t\t\t\tl = this.inputs.length;\n\t\t\tif (i === -1)\n\t\t\t\treturn;\n\n\t\t\t$.each(this.pickers, function(i, p){\n\t\t\t\tif (!p.getUTCDate())\n\t\t\t\t\tp.setUTCDate(new_date);\n\t\t\t});\n\n\t\t\tif (new_date < this.dates[j]){\n\t\t\t\t// Date being moved earlier/left\n\t\t\t\twhile (j >= 0 && new_date < this.dates[j]){\n\t\t\t\t\tthis.pickers[j--].setUTCDate(new_date);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (new_date > this.dates[k]){\n\t\t\t\t// Date being moved later/right\n\t\t\t\twhile (k < l && new_date > this.dates[k]){\n\t\t\t\t\tthis.pickers[k++].setUTCDate(new_date);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.updateDates();\n\n\t\t\tdelete this.updating;\n\t\t},\n\t\tremove: function(){\n\t\t\t$.map(this.pickers, function(p){ p.remove(); });\n\t\t\tdelete this.element.data().datepicker;\n\t\t}\n\t};\n\n\tfunction opts_from_el(el, prefix){\n\t\t// Derive options from element data-attrs\n\t\tvar data = $(el).data(),\n\t\t\tout = {}, inkey,\n\t\t\treplace = new RegExp('^' + prefix.toLowerCase() + '([A-Z])');\n\t\tprefix = new RegExp('^' + prefix.toLowerCase());\n\t\tfunction re_lower(_,a){\n\t\t\treturn a.toLowerCase();\n\t\t}\n\t\tfor (var key in data)\n\t\t\tif (prefix.test(key)){\n\t\t\t\tinkey = key.replace(replace, re_lower);\n\t\t\t\tout[inkey] = data[key];\n\t\t\t}\n\t\treturn out;\n\t}\n\n\tfunction opts_from_locale(lang){\n\t\t// Derive options from locale plugins\n\t\tvar out = {};\n\t\t// Check if \"de-DE\" style date is available, if not language should\n\t\t// fallback to 2 letter code eg \"de\"\n\t\tif (!dates[lang]){\n\t\t\tlang = lang.split('-')[0];\n\t\t\tif (!dates[lang])\n\t\t\t\treturn;\n\t\t}\n\t\tvar d = dates[lang];\n\t\t$.each(locale_opts, function(i,k){\n\t\t\tif (k in d)\n\t\t\t\tout[k] = d[k];\n\t\t});\n\t\treturn out;\n\t}\n\n\tvar old = $.fn.datepicker;\n\tvar datepickerPlugin = function(option){\n\t\tvar args = Array.apply(null, arguments);\n\t\targs.shift();\n\t\tvar internal_return;\n\t\tthis.each(function(){\n\t\t\tvar $this = $(this),\n\t\t\t\tdata = $this.data('datepicker'),\n\t\t\t\toptions = typeof option === 'object' && option;\n\t\t\tif (!data){\n\t\t\t\tvar elopts = opts_from_el(this, 'date'),\n\t\t\t\t\t// Preliminary otions\n\t\t\t\t\txopts = $.extend({}, defaults, elopts, options),\n\t\t\t\t\tlocopts = opts_from_locale(xopts.language),\n\t\t\t\t\t// Options priority: js args, data-attrs, locales, defaults\n\t\t\t\t\topts = $.extend({}, defaults, locopts, elopts, options);\n\t\t\t\tif ($this.hasClass('input-daterange') || opts.inputs){\n\t\t\t\t\tvar ropts = {\n\t\t\t\t\t\tinputs: opts.inputs || $this.find('input').toArray()\n\t\t\t\t\t};\n\t\t\t\t\t$this.data('datepicker', (data = new DateRangePicker(this, $.extend(opts, ropts))));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$this.data('datepicker', (data = new Datepicker(this, opts)));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof option === 'string' && typeof data[option] === 'function'){\n\t\t\t\tinternal_return = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\tif (\n\t\t\tinternal_return === undefined ||\n\t\t\tinternal_return instanceof Datepicker ||\n\t\t\tinternal_return instanceof DateRangePicker\n\t\t)\n\t\t\treturn this;\n\n\t\tif (this.length > 1)\n\t\t\tthrow new Error('Using only allowed for the collection of a single element (' + option + ' function)');\n\t\telse\n\t\t\treturn internal_return;\n\t};\n\t$.fn.datepicker = datepickerPlugin;\n\n\tvar defaults = $.fn.datepicker.defaults = {\n\t\tautoclose: false,\n\t\tbeforeShowDay: $.noop,\n\t\tbeforeShowMonth: $.noop,\n\t\tbeforeShowYear: $.noop,\n\t\tcalendarWeeks: false,\n\t\tclearBtn: false,\n\t\ttoggleActive: false,\n\t\tdaysOfWeekDisabled: [],\n\t\tdaysOfWeekHighlighted: [],\n\t\tdatesDisabled: [],\n\t\tendDate: Infinity,\n\t\tforceParse: true,\n\t\tformat: 'mm/dd/yyyy',\n\t\tkeyboardNavigation: true,\n\t\tlanguage: 'en',\n\t\tminViewMode: 0,\n\t\tmaxViewMode: 2,\n\t\tmultidate: false,\n\t\tmultidateSeparator: ',',\n\t\torientation: \"auto\",\n\t\trtl: false,\n\t\tstartDate: -Infinity,\n\t\tstartView: 0,\n\t\ttodayBtn: false,\n\t\ttodayHighlight: false,\n\t\tweekStart: 0,\n\t\tdisableTouchKeyboard: false,\n\t\tenableOnReadonly: true,\n\t\tcontainer: 'body',\n\t\timmediateUpdates: false,\n\t\ttitle: ''\n\t};\n\tvar locale_opts = $.fn.datepicker.locale_opts = [\n\t\t'format',\n\t\t'rtl',\n\t\t'weekStart'\n\t];\n\t$.fn.datepicker.Constructor = Datepicker;\n\tvar dates = $.fn.datepicker.dates = {\n\t\ten: {\n\t\t\tdays: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\n\t\t\tdaysShort: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n\t\t\tdaysMin: [\"Su\", \"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\"],\n\t\t\tmonths: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n\t\t\tmonthsShort: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n\t\t\ttoday: \"Today\",\n\t\t\tclear: \"Clear\",\n\t\t\ttitleFormat: \"MM yyyy\"\n\t\t}\n\t};\n\n\tvar DPGlobal = {\n\t\tmodes: [\n\t\t\t{\n\t\t\t\tclsName: 'days',\n\t\t\t\tnavFnc: 'Month',\n\t\t\t\tnavStep: 1\n\t\t\t},\n\t\t\t{\n\t\t\t\tclsName: 'months',\n\t\t\t\tnavFnc: 'FullYear',\n\t\t\t\tnavStep: 1\n\t\t\t},\n\t\t\t{\n\t\t\t\tclsName: 'years',\n\t\t\t\tnavFnc: 'FullYear',\n\t\t\t\tnavStep: 10\n\t\t}],\n\t\tisLeapYear: function(year){\n\t\t\treturn (((year % 4 === 0) && (year % 100 !== 0)) || (year % 400 === 0));\n\t\t},\n\t\tgetDaysInMonth: function(year, month){\n\t\t\treturn [31, (DPGlobal.isLeapYear(year) ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month];\n\t\t},\n\t\tvalidParts: /dd?|DD?|mm?|MM?|yy(?:yy)?/g,\n\t\tnonpunctuation: /[^ -\\/:-@\\[\\u3400-\\u9fff-`{-~\\t\\n\\r]+/g,\n\t\tparseFormat: function(format){\n\t\t\tif (typeof format.toValue === 'function' && typeof format.toDisplay === 'function')\n                return format;\n            // IE treats \\0 as a string end in inputs (truncating the value),\n\t\t\t// so it's a bad format delimiter, anyway\n\t\t\tvar separators = format.replace(this.validParts, '\\0').split('\\0'),\n\t\t\t\tparts = format.match(this.validParts);\n\t\t\tif (!separators || !separators.length || !parts || parts.length === 0){\n\t\t\t\tthrow new Error(\"Invalid date format.\");\n\t\t\t}\n\t\t\treturn {separators: separators, parts: parts};\n\t\t},\n\t\tparseDate: function(date, format, language){\n\t\t\tif (!date)\n\t\t\t\treturn undefined;\n\t\t\tif (date instanceof Date)\n\t\t\t\treturn date;\n\t\t\tif (typeof format === 'string')\n\t\t\t\tformat = DPGlobal.parseFormat(format);\n\t\t\tif (format.toValue)\n                return format.toValue(date, format, language);\n            var part_re = /([\\-+]\\d+)([dmwy])/,\n\t\t\t\tparts = date.match(/([\\-+]\\d+)([dmwy])/g),\n\t\t\t\tpart, dir, i;\n\t\t\tif (/^[\\-+]\\d+[dmwy]([\\s,]+[\\-+]\\d+[dmwy])*$/.test(date)){\n\t\t\t\tdate = new Date();\n\t\t\t\tfor (i=0; i < parts.length; i++){\n\t\t\t\t\tpart = part_re.exec(parts[i]);\n\t\t\t\t\tdir = parseInt(part[1]);\n\t\t\t\t\tswitch (part[2]){\n\t\t\t\t\t\tcase 'd':\n\t\t\t\t\t\t\tdate.setUTCDate(date.getUTCDate() + dir);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'm':\n\t\t\t\t\t\t\tdate = Datepicker.prototype.moveMonth.call(Datepicker.prototype, date, dir);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'w':\n\t\t\t\t\t\t\tdate.setUTCDate(date.getUTCDate() + dir * 7);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'y':\n\t\t\t\t\t\t\tdate = Datepicker.prototype.moveYear.call(Datepicker.prototype, date, dir);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn UTCDate(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), 0, 0, 0);\n\t\t\t}\n\t\t\tparts = date && date.match(this.nonpunctuation) || [];\n\t\t\tdate = new Date();\n\t\t\tvar parsed = {},\n\t\t\t\tsetters_order = ['yyyy', 'yy', 'M', 'MM', 'm', 'mm', 'd', 'dd'],\n\t\t\t\tsetters_map = {\n\t\t\t\t\tyyyy: function(d,v){\n\t\t\t\t\t\treturn d.setUTCFullYear(v);\n\t\t\t\t\t},\n\t\t\t\t\tyy: function(d,v){\n\t\t\t\t\t\treturn d.setUTCFullYear(2000+v);\n\t\t\t\t\t},\n\t\t\t\t\tm: function(d,v){\n\t\t\t\t\t\tif (isNaN(d))\n\t\t\t\t\t\t\treturn d;\n\t\t\t\t\t\tv -= 1;\n\t\t\t\t\t\twhile (v < 0) v += 12;\n\t\t\t\t\t\tv %= 12;\n\t\t\t\t\t\td.setUTCMonth(v);\n\t\t\t\t\t\twhile (d.getUTCMonth() !== v)\n\t\t\t\t\t\t\td.setUTCDate(d.getUTCDate()-1);\n\t\t\t\t\t\treturn d;\n\t\t\t\t\t},\n\t\t\t\t\td: function(d,v){\n\t\t\t\t\t\treturn d.setUTCDate(v);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tval, filtered;\n\t\t\tsetters_map['M'] = setters_map['MM'] = setters_map['mm'] = setters_map['m'];\n\t\t\tsetters_map['dd'] = setters_map['d'];\n\t\t\tdate = UTCDate(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0);\n\t\t\tvar fparts = format.parts.slice();\n\t\t\t// Remove noop parts\n\t\t\tif (parts.length !== fparts.length){\n\t\t\t\tfparts = $(fparts).filter(function(i,p){\n\t\t\t\t\treturn $.inArray(p, setters_order) !== -1;\n\t\t\t\t}).toArray();\n\t\t\t}\n\t\t\t// Process remainder\n\t\t\tfunction match_part(){\n\t\t\t\tvar m = this.slice(0, parts[i].length),\n\t\t\t\t\tp = parts[i].slice(0, m.length);\n\t\t\t\treturn m.toLowerCase() === p.toLowerCase();\n\t\t\t}\n\t\t\tif (parts.length === fparts.length){\n\t\t\t\tvar cnt;\n\t\t\t\tfor (i=0, cnt = fparts.length; i < cnt; i++){\n\t\t\t\t\tval = parseInt(parts[i], 10);\n\t\t\t\t\tpart = fparts[i];\n\t\t\t\t\tif (isNaN(val)){\n\t\t\t\t\t\tswitch (part){\n\t\t\t\t\t\t\tcase 'MM':\n\t\t\t\t\t\t\t\tfiltered = $(dates[language].months).filter(match_part);\n\t\t\t\t\t\t\t\tval = $.inArray(filtered[0], dates[language].months) + 1;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'M':\n\t\t\t\t\t\t\t\tfiltered = $(dates[language].monthsShort).filter(match_part);\n\t\t\t\t\t\t\t\tval = $.inArray(filtered[0], dates[language].monthsShort) + 1;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tparsed[part] = val;\n\t\t\t\t}\n\t\t\t\tvar _date, s;\n\t\t\t\tfor (i=0; i < setters_order.length; i++){\n\t\t\t\t\ts = setters_order[i];\n\t\t\t\t\tif (s in parsed && !isNaN(parsed[s])){\n\t\t\t\t\t\t_date = new Date(date);\n\t\t\t\t\t\tsetters_map[s](_date, parsed[s]);\n\t\t\t\t\t\tif (!isNaN(_date))\n\t\t\t\t\t\t\tdate = _date;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn date;\n\t\t},\n\t\tformatDate: function(date, format, language){\n\t\t\tif (!date)\n\t\t\t\treturn '';\n\t\t\tif (typeof format === 'string')\n\t\t\t\tformat = DPGlobal.parseFormat(format);\n\t\t\tif (format.toDisplay)\n                return format.toDisplay(date, format, language);\n            var val = {\n\t\t\t\td: date.getUTCDate(),\n\t\t\t\tD: dates[language].daysShort[date.getUTCDay()],\n\t\t\t\tDD: dates[language].days[date.getUTCDay()],\n\t\t\t\tm: date.getUTCMonth() + 1,\n\t\t\t\tM: dates[language].monthsShort[date.getUTCMonth()],\n\t\t\t\tMM: dates[language].months[date.getUTCMonth()],\n\t\t\t\tyy: date.getUTCFullYear().toString().substring(2),\n\t\t\t\tyyyy: date.getUTCFullYear()\n\t\t\t};\n\t\t\tval.dd = (val.d < 10 ? '0' : '') + val.d;\n\t\t\tval.mm = (val.m < 10 ? '0' : '') + val.m;\n\t\t\tdate = [];\n\t\t\tvar seps = $.extend([], format.separators);\n\t\t\tfor (var i=0, cnt = format.parts.length; i <= cnt; i++){\n\t\t\t\tif (seps.length)\n\t\t\t\t\tdate.push(seps.shift());\n\t\t\t\tdate.push(val[format.parts[i]]);\n\t\t\t}\n\t\t\treturn date.join('');\n\t\t},\n\t\theadTemplate: '<thead>'+\n\t\t\t              '<tr>'+\n\t\t\t                '<th colspan=\"7\" class=\"datepicker-title\"></th>'+\n\t\t\t              '</tr>'+\n\t\t\t\t\t\t\t'<tr>'+\n\t\t\t\t\t\t\t\t'<th class=\"prev\">&#171;</th>'+\n\t\t\t\t\t\t\t\t'<th colspan=\"5\" class=\"datepicker-switch\"></th>'+\n\t\t\t\t\t\t\t\t'<th class=\"next\">&#187;</th>'+\n\t\t\t\t\t\t\t'</tr>'+\n\t\t\t\t\t\t'</thead>',\n\t\tcontTemplate: '<tbody><tr><td colspan=\"7\"></td></tr></tbody>',\n\t\tfootTemplate: '<tfoot>'+\n\t\t\t\t\t\t\t'<tr>'+\n\t\t\t\t\t\t\t\t'<th colspan=\"7\" class=\"today\"></th>'+\n\t\t\t\t\t\t\t'</tr>'+\n\t\t\t\t\t\t\t'<tr>'+\n\t\t\t\t\t\t\t\t'<th colspan=\"7\" class=\"clear\"></th>'+\n\t\t\t\t\t\t\t'</tr>'+\n\t\t\t\t\t\t'</tfoot>'\n\t};\n\tDPGlobal.template = '<div class=\"datepicker\">'+\n\t\t\t\t\t\t\t'<div class=\"datepicker-days\">'+\n\t\t\t\t\t\t\t\t'<table class=\" table-condensed\">'+\n\t\t\t\t\t\t\t\t\tDPGlobal.headTemplate+\n\t\t\t\t\t\t\t\t\t'<tbody></tbody>'+\n\t\t\t\t\t\t\t\t\tDPGlobal.footTemplate+\n\t\t\t\t\t\t\t\t'</table>'+\n\t\t\t\t\t\t\t'</div>'+\n\t\t\t\t\t\t\t'<div class=\"datepicker-months\">'+\n\t\t\t\t\t\t\t\t'<table class=\"table-condensed\">'+\n\t\t\t\t\t\t\t\t\tDPGlobal.headTemplate+\n\t\t\t\t\t\t\t\t\tDPGlobal.contTemplate+\n\t\t\t\t\t\t\t\t\tDPGlobal.footTemplate+\n\t\t\t\t\t\t\t\t'</table>'+\n\t\t\t\t\t\t\t'</div>'+\n\t\t\t\t\t\t\t'<div class=\"datepicker-years\">'+\n\t\t\t\t\t\t\t\t'<table class=\"table-condensed\">'+\n\t\t\t\t\t\t\t\t\tDPGlobal.headTemplate+\n\t\t\t\t\t\t\t\t\tDPGlobal.contTemplate+\n\t\t\t\t\t\t\t\t\tDPGlobal.footTemplate+\n\t\t\t\t\t\t\t\t'</table>'+\n\t\t\t\t\t\t\t'</div>'+\n\t\t\t\t\t\t'</div>';\n\n\t$.fn.datepicker.DPGlobal = DPGlobal;\n\n\n\t/* DATEPICKER NO CONFLICT\n\t* =================== */\n\n\t$.fn.datepicker.noConflict = function(){\n\t\t$.fn.datepicker = old;\n\t\treturn this;\n\t};\n\n\t/* DATEPICKER VERSION\n\t * =================== */\n\t$.fn.datepicker.version = '1.6.0-dev';\n\n\t/* DATEPICKER DATA-API\n\t* ================== */\n\n\t$(document).on(\n\t\t'focus.datepicker.data-api click.datepicker.data-api',\n\t\t'[data-provide=\"datepicker\"]',\n\t\tfunction(e){\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.data('datepicker'))\n\t\t\t\treturn;\n\t\t\te.preventDefault();\n\t\t\t// component click requires us to explicitly show it\n\t\t\tdatepickerPlugin.call($this, 'show');\n\t\t}\n\t);\n\t$(function(){\n\t\tdatepickerPlugin.call($('[data-provide=\"datepicker-inline\"]'));\n\t});\n\n}));","$(function() {\n\tvar touchY=0;\n\t$(\".journey .card\").bind(\"touchstart\",function(e) {\n\t\t$card=$(e.target);\n\t\tif ($card.hasClass(\"message_1\")) {\n\t\t\tactivateDelay();\n\t\t} else {\n\t\t\tif ($(this).parent().hasClass(\"open\")) {\n\t\t\t\t$(this).parent().removeClass(\"open\");\n\t\t\t} else {\n\t\t\t\t$(this).parent().addClass(\"open\");\n\t\t\t}\n\t\t}\n\t});\n\n\t$(\".schedule .card\").bind(\"touchstart\",touchstartHandler);\n\n\tfunction touchstartHandler(e) {\n\t\t$(\".schedule .card\").bind(\"touchend\",touchendHandler);\n\t\ttouchY = e.originalEvent.changedTouches[0].clientY;\n\t\tconsole.log(\"touch start\",touchY);\n\t}\n\tfunction touchendHandler(e) {\n\t\tvar thisY = e.originalEvent.changedTouches[0].clientY;\n\t\tif (Math.abs(touchY-thisY)>20) {\n\t\t\tif (touchY-thisY<0) {\n\t\t\t\t$(this).parent().removeClass(\"open\");\n\t\t\t} else {\n\t\t\t\t$(this).parent().addClass(\"open\");\n\t\t\t}\n\t\t}\n\t}\n\tfunction activateDelay() {\n\t\t$($card).fadeOut();\n\t\t$(\".journey .message_2\").fadeIn();\n\t\t\n\t\t$(\".journey .card img\").attr(\"src\",\"img/gfx_hand.svg\");\n\t\tvar activeBucket = clock_slider.activeBucket();\n\t\tvar time_str = ($(\".bottomslider span.time\").eq(activeBucket).html());\n\t\tvar time = time_str.split(\":\");\n\t\tvar h = parseInt(time[0]);\n\t\tvar m = parseInt(time[1]);\n\t\tm+=22;\n\t\tif (m>=60) {\n\t\t\tm-=60;\n\t\t\th+=1;\n\t\t}\n\t\t$(\".info\").animate({opacity:0}, 00);\n\n\t\tvar delaydepart = '<span class=\"delay\">Running behind</span>';\n\t\tvar delayarrive = '<span class=\"platform\">Platform 12</span><span class=\"delay\">Exp '+pad(h,2)+':'+pad(m,2)+'</span>';\n\t\t$(\".info.depart\").html(delaydepart);\n\t\t$(\".info.arrive\").html(delayarrive);\n\t\t$(\".info\").animate({opacity:1},200);\n\t}\n});\n// $(function() {\n// \t$(\"section.helper\").bind(\"click\",function() {\n// \t\t$(this).addClass(\"active\");\n// \t\t$(\"div.search_station\").addClass(\"inactive\");\n// \t})\n// });","var currentTime;\n\n\tvar clock_slider = function() {\n\t\tvar activeBucket = 0;\n\t\tvar entryTouchPoint = new Object();\n\t\tvar entryTouchTime;\n\t\tvar exitTouchPoint = new Object();\n\t\tvar pixelsMoved = 0;\n\t\tvar swipeDetectionPixelAmount = 60;\n\t\tvar firstMove = true;\n\t\tvar touchTimeout;\n\t\tvar scrollMuch = 0;\n\t\tvar windowWidth = $(window).width();\n\t\tvar initBucket;\n\t\t\n\t\tfunction activateBucket(no, speed, elm, init) {\n\t\t\tvar delaydepart, delayarrive;\n\t\t\tactiveBucket=no;\n\t\t\t$bucket = $(\".options time\",$(\".clock_slider\").eq(0)).eq(activeBucket);\n\t\t\tvar delay=$bucket.attr(\"data-message\");\n\t\t\tvar time = $bucket.attr(\"datetime\")+\" \";\n\t\t\tvar time = time.trim().replace(\" \",\"T\");\n\t\t\tvar time = new Date(time);\n\t\t\tvar now = new Date();\n\t\t\ttime.setHours(time.getHours() - 1);\n\t\t\t$(\".journey .plan li\").each(function(i,e) {\n\t\t\t\tvar targetTime = new Date(time.getTime() + (parseInt($(this).attr(\"data-distance\"))*60000));\n\t\t\t\tvar timeString = pad(targetTime.getHours(),2) + \":\" +pad(targetTime.getMinutes(),2);\n\t\t\t\t\n\t\t\t\tif (i<4 && now>time) {\n\t\t\t\t\t$(this).addClass(\"passed\");\n\t\t\t\t} else {\n\t\t\t\t\t$(this).removeClass(\"passed\");\n\t\t\t\t}\n\t\t\t\t$(\"strong\",$(this)).html(timeString);\n\t\t\t});\n\t\t\tif (now>time) {\n\t\t\t\t$(\".current_status\").css(\"display\",\"block\");\n\t\t\t} else {\n\t\t\t\t$(\".current_status\").css(\"display\",\"none\");\n\t\t\t}\n\t\t\tvar now = new Date();\n\t\t\tif (no<initBucket) {\n\t\t\t\tdelaydepart = '<span class=\"journey_link\">Running on time</span>';\n\t\t\t\tdelayarrive = '<span class=\"platform\">Platform 4: Train to Portsmouth Harbour</span><span class=\"delay\">45min</span>';\n\t\t\t} else if (no==initBucket) {\n\t\t\t\tdelaydepart = '<span class=\"platform\">Platform 15: Train to Portsmouth Harbour</span><span class=\"delay\">2h 5min</span>';\n\t\t\t\tdelayarrive = '<span class=\"delay\">2h 5min</span>';\n\t\t\t} else {\n\t\t\t\tdelaydepart = '<span class=\"delay\">Exp on time</span>';\n\t\t\t \tdelayarrive = '<span class=\"delay\">2h 5min</span>';\n\t\t\t}\n\t\t\tif (!speed) {\n\t\t\t\t$(\".options\",elm).css(\"transition\",\"all 0s cubic-bezier(.6,.0,.4,1)\");\n\t\t\t} else {\n\t\t\t\tif (speed>.5) speed=.5;\n\t\t\t\t$(\".options\",elm).css(\"transition\",\"all \"+speed+\"s ease-out\");\n\t\t\t}\n\n\t\t\tvar targetX =  0-(no*$(\".clock_slider .options time\").width());\n\t\t\t$(\".options\",elm).css(\"transform\",\"translateX(\"+(targetX+(windowWidth/2-($(\"time.bucket\").width()/2)))+\"px)\");\n\t\t\t$(\".info\").animate({opacity:0}, 200);\n\t\t\tsetTimeout(function(delay) {\n\t\t\t\tif (delay) {\n\t\t\t\t\t$(\".info.depart\").html(delaydepart);\n\t\t\t\t\t$(\".info.arrive\").html(delayarrive);\n\t\t\t\t} else {\n\t\t\t\t\t$(\".info.depart\").html(delaydepart);\n\t\t\t\t\t$(\".info.arrive\").html(delayarrive);\n\t\t\t\t}\n\t\t\t\t$(\".info\").animate({opacity:1},200);\n\t\t\t},350,delay);\n\t\t}\n\n\t\t\n\t\tfunction touchstartHandler(e) {\n\t\t\tvar clock_slider = $(e.target.parentNode.parentNode.parentNode.parentNode);\n\t\t\tscrollBucket = clock_slider;\n\t\t\t$(\".clock_slider\").removeClass(\"active\");\n\t\t\tclock_slider.addClass(\"active\");\n\t\t\tscrollMuch = scrollBucket.scrollTop;\n\t\t\tpixelsMoved=0;\n\t\t\tvar timeSinceTouchstart = new Date().getTime() - entryTouchTime;\n\t\t\t$(\".options\",clock_slider).bind(\"touchend\",touchendHandler).bind(\"touchmove\",touchmoveHandler).css(\"transition-duration\",\"0s\");\n\t\t\tvar matrix=$(\".options\",clock_slider).css(\"transform\").toString().replace(\"matrix(\",\"\").replace(\")\",\"\").split(\",\");\n\t\t\tentryTouchPoint.touchOffsetX = (parseInt(matrix[4].trim())); \n\t\t\tentryTouchPoint.x = e.originalEvent.touches[0].clientX;\n\t\t\tentryTouchTime = new Date().getTime();\n\n\t\t}\n\t\tfunction possiblyUnbind(e) {\n\t\t\tcurrentBucket = findScrollingBucket(e.target);\n\t\t\tcurrentScroll = currentBucket.scrollTop;\n\t\t\tif (currentScroll-scrollMuch>20) {\n\t\t\t\tunbindSwipeHandlers(e);\n\t\t\t}\n\t\t}\n\t\tfunction findScrollingBucket(obj) {\n\t\t\tif ($(obj).hasClass(\"bucket\")) {\n\t\t\t\treturn obj;\n\t\t\t} else {\n\t\t\t\treturn findScrollingBucket(obj.parentNode);\n\t\t\t}\n\t\t}\n\t\tfunction touchmoveHandler(e) {\n\t\t\tvar clock_slider = $(e.target.parentNode.parentNode.parentNode.parentNode);\n\t\t\tclearTimeout(touchTimeout);\n\t\t\t\n\t\t\tvar matrix=$(\".options\", clock_slider).css(\"transform\").toString().replace(\"matrix(\",\"\").replace(\")\",\"\").split(\",\");\n\t\t\texitTouchPoint.x = e.originalEvent.touches[0].clientX;\n\t\t\texitTouchPoint.touchOffsetX = parseInt(matrix[4].trim()); \n\n\t\t\tpixelsMoved = entryTouchPoint.x - exitTouchPoint.x;\n\n\t\t\tvar timeSinceTouchstart = new Date().getTime() - entryTouchTime;\n\n\t\t\tvar targetX = ((entryTouchPoint.x - exitTouchPoint.x)-entryTouchPoint.touchOffsetX)*-1;\n\t\t\t$(\".options\",clock_slider).css(\"transform\",\"translateX(\"+targetX+\"px)\");\n\n\t\t}\n\t\tfunction touchendHandler(e) {\n\t\t\tvar clock_slider = $(e.target.parentNode.parentNode.parentNode.parentNode);\n\t\t\tclearTimeout(touchTimeout);\n\t\t\t$(\".options\",clock_slider).css(\"transition-duration\",\"0.4s\").unbind(\"touchmove\",touchmoveHandler).unbind(\"touchend\",touchendHandler);\n\t\t\tvar timeSinceTouchstart = new Date().getTime() - entryTouchTime;\n\t\t\t\n\t\t\tvar destination = (entryTouchPoint.x - exitTouchPoint.x);\n\n\t\t\tvar closestBucket = Math.round((destination/$(\".options time\",clock_slider).width()));\n\n\t\t\tclosestBucket = activeBucket + closestBucket;\n\t\t\tif (closestBucket<0) closestBucket = 0;\n\t\t\t\n\t\t\tvar animationTime = Math.abs(timeSinceTouchstart/pixelsMoved)*0.6;\n\t\t\tconsole.log(animationTime);\n\t\t\tif (animationTime<0.2) {\n\t\t\t\tanimationTime=0.2;\n\t\t\t}\n\t\t\tactivateBucket(closestBucket,animationTime);\n\t\t}\n\t\tfunction unbindSwipeHandlers(e) {\n\t\t\t$(\".clock_slider .options\").unbind(\"touchmove\",touchmoveHandler);\n\t\t\t$(\".clock_slider .options\").unbind(\"touchend\",touchendHandler);\n\t\t\t$(\".bucket\").unbind(\"scroll\",unbindSwipeHandlers);\n\t\t}\n\t\tfunction findCurrentTime(elm) {\n\t\t\tvar d = new Date();\n\t\t\tvar h = d.getHours();\n\t\t\tvar m = d.getMinutes();\n\n\t\t\tm_rounded = 5 * Math.ceil(m/5);\n\t\t\tif (m_rounded==60) {\n\t\t\t\tm_rounded=0;\n\t\t\t\th+=1;\n\t\t\t}\n\t\t\tm_rounded+=5;\n\t\t\tvar currentTime = pad(h,2)+\":\"+pad(m_rounded,2);\n\t\t\tvar activeChild=0;\n\t\t\t$(\".options time span\",$(elm)).each(function(i,e) {\n\t\t\t\tthisHour=parseInt($(this).html().substring(0,2));\n\t\t\t\tthisMinute=parseInt($(this).html().substring(3,5));\n\n\t\t\t\tif ((thisHour==h && thisMinute>=m_rounded) || thisHour>h) {\n\t\t\t\t\tactiveChild = i;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn activeChild;\n\t\t}\n\t\t\n\t\t\n\t\tNumber.prototype.map = function (in_min, in_max, out_min, out_max) {\n\t\t  return (this - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;\n\t\t}\n\t\tfunction scaleAccordingToCenterPos(obj) {\n\n\t\t\ttry {\n\t\t\t\tvar elm = document.querySelector(obj);\n\t\t\t\tvar center = document.elementFromPoint(windowWidth/2,elm.getBoundingClientRect().top+5).parentNode;\n\t\t\t\tif (typeof center!=\"undefined\") {\n\t\t\t\t\tif (center.tagName==\"TIME\") {\n\t\t\t\t\t\tvar objects = new Array();\n\t\t\t\t\t\tobjects.push(center);\n\t\t\t\t\t\tobjects.push(center.parentNode.previousSibling.firstChild);\n\t\t\t\t\t\tobjects.push(center.parentNode.nextSibling.firstChild);\n\t\t\t\t\t\t\n\t\t\t\t\t\tfunction getDistanceFromCenter(obj) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tvar returnValue =Math.abs((windowWidth/2)- (obj.getBoundingClientRect().left + obj.getBoundingClientRect().width/2));\n\t\t\t\t\t\t\t} catch (e) {\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn returnValue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (object in objects) {\n\t\t\t\t\t\t\tif (objects[object]!=\"undefined\") {\n\t\t\t\t\t\t\t\tcenterMeasure = getDistanceFromCenter(objects[object])*-1;\n\n\t\t\t\t\t\t\t\tif (centerMeasure!=elm.centerMeasure) {\n\t\t\t\t\t\t\t\t\tspanTime=objects[object].firstChild;\n\n\n\t\t\t\t\t\t\t\t\tobjects[object].centerMeasure = centerMeasure;\n\t\t\t\t\t\t\t\t\tcenterScale = Math.abs(centerMeasure.map(-100,0,1,1.6));\n\t\t\t\t\t\t\t\t\tcenterOpacity = centerMeasure.map(-180,0,.3,1);\n\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (spanTime.getAttribute(\"data-centerscale\")!=centerScale) {\n\t\t\t\t\t\t\t\t\t\tif (centerScale<1) centerScale=1;\n\t\t\t\t\t\t\t\t\t\tspanTime.setAttribute(\"data-centerscale\",centerScale);\n\t\t\t\t\t\t\t\t\t\t$(spanTime).css(\"transform\",\"scale(\"+centerScale+\",\"+centerScale+\")\").css(\"opacity\",centerOpacity);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tdraw: function() {\n\t\t\t\tscaleAccordingToCenterPos(\".topslider\");\n\t\t\t\tscaleAccordingToCenterPos(\".bottomslider\");\n\t\t\t\tsetTimeout(clock_slider.draw,10);\n\t\t\t\t// window.requestAnimationFrame(clock_slider.draw);\n\t\t\t},\n\t\t\tInit: function(elm,no) {\n\t\t\t\tvar startBucket = findCurrentTime(elm);\n\t\t\t\tinitBucket = startBucket;\n\t\t\t\t$(\".options\",$(\".clock_slider\")).bind(\"touchstart\",touchstartHandler);\n\t\t\t\tactivateBucket(startBucket,false, $(\".clock_slider\").eq(0));\n\t\t\t\tactivateBucket(startBucket,false, $(\".clock_slider\").eq(1));\n\t\t\t\t$(\".clock_slider\").each(function() {\n\t\t\t\t\t$(this)[0].fromTop = $(this).offset().top;\n\t\t\t\t});\n\t\t\t\t$(\"a.swap\").bind(\"click\",swapStations);\n\t\t\t\tclock_slider.draw();\n\t\t\t\tif (document.location.hash==\"#scanner\") {\n\t\t\t\t\t$(\"body\").removeClass(\"pre\");\n\t\t\t\t\t$(\".top .location\").html(\"London Waterloo\").addClass(\"valid\");\n\t\t\t\t\t$(\".bottom .location\").html(\"Clapham Junction\").addClass(\"valid\");\n\t\t\t\t\t$(\".get_tickets button\").prop(\"disabled\",false);\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t},\n\t\t\tactiveBucket: function() {\n\t\t\t\treturn activeBucket;\n\t\t\t}\n\t\t}\n\t\t\n\t}();\n// $(document).ready(function($) {\n// \tsetTimeout(function() { clock_slider.draw(); },200);\n\t// $(function() {\n\t// \tdocument.body.ontouchstart = function(e){\n\t// \t\t$source = $(e.target);\n\t// \t\tvar source = e.target;\n\t\t\n\t// \t\tif (source.tagName!=\"INPUT\" && source.tagName!=\"BUTTON\" && source.tagName!=\"A\" && !$source.hasClass(\"clickaction\") && !$source.hasClass(\"link_arrow\")) e.preventDefault(); \n\t// \t}\n\t// })\n// });\nfunction swapStations(e) {\n\tvar startPoint = $(\".top .location\").html();\n\tvar endPoint = $(\".bottom .location\").html();\n\t$(\".bottom .location\").html(startPoint);\n\t$(\".top .location\").html(endPoint);\n\te.preventDefault();\n}\nfunction parentHasClass(elm,className) {\n\tif (elm.className.indexOf(className)<0) {\n\t\tif (elm!=document.body) {\n\t\t\treturn parentHasClass(elm.parentNode, className);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\treturn true;\n\t}\n}\nfunction pad(n, width, z) {\n\t\t\tz = z || '0';\n\t\t\tn = n + '';\n\t\t\treturn n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;\n\t\t}","var headerMinHeight = null;\nvar historyCount=0;\n$(function() {\n\theaderMinHeight=parseInt($(\".headerMinHeight\").css(\"height\"));\n\ttry {\n\t\twebkit.messageHandlers.callbackHandler.postMessage(\"white\");\n\t} catch (er) {}\n\tfunction stepHandler() {\n\t\tif ($(\"body\").hasClass(\"step1\")) {\n\t\t\t// for (i=0;i<history.length;i++) {;\n\t\t\tdocument.location.href='planning.php';\n\t\t}\n\t\tif ($(\"body\").hasClass(\"step2\")) {\n\t\t\t$(\"body\").removeClass(\"step1 step2 step3 step4\");\n\t\t\t$(\"body\").addClass(\"step1\");\n\t\t\ttrainDirection = \"outbound\";\n\t\t\tsetSlideMinNow();\n\t\t\tupdatePriceList();\n\t\t\t$(\".outbound li, .returning li, .ticket_options li\").removeClass(\"faded\");\n\t\t\t$(\".schedule_container .opacityZero\").css(\"opacity\",0);\n\t\t\tschedule.sizeUp();\n\t\t}\n\t\tif ($(\"body\").hasClass(\"step3\")) {\n\t\t\t$(\"body\").removeClass(\"step1 step2 step3 step4\");\n\t\t\t$(\"body\").addClass(\"step2\");\n\t\t\tupdatePriceList();\n\t\t\ttrainDirection = \"returning\";\n\t\t\t$(\".schedule_container .opacityZero\").css(\"opacity\",0);\n\t\t\t$(\".outbound li, .returning li, .ticket_options li\").removeClass(\"faded\");\n\t\t\tschedule.sizeUp();\n\t\t}\n\t\tif ($(\"body\").hasClass(\"step4\") && !$(\"body\").hasClass(\"confirmation-page\")) {\n\t\t\t$(\"body\").removeClass(\"step1 step2 step3 step4\");;\n\t\t\t$(\"body\").addClass(\"step3\");\n\t\t\t$(\".schedule_container .opacityZero\").css(\"opacity\",0);\n\t\t\t$(\".ticket_options li\").removeClass(\"faded\");\n\t\t\tschedule.sizeUp();\n\t\t}\n\t\tif ($(\"body\").hasClass(\"confirmation-page\")) {\n\t\t\tdocument.location.href='index.php#scanner';\n\t\t}\n\t}\n\tfunction scrollHandler(e) {\n\t\tvar scrollTop = $(window).scrollTop();\n\t\tvar scrollPoint = 5;\n\t\tif (scrollTop>scrollPoint && !$(\"body\").hasClass(\"scrolled\")) {\n\t\t\t$(\"body\").addClass(\"scrolled\");\n\t\t} else {\n\t\t\tif (scrollTop<=scrollPoint) {\n\t\t\t\t$(\"body\").removeClass(\"scrolled\");\n\t\t\t}\n\t\t}\n\t}\n\t$(\".back_nav\").bind(\"click\",function() {\n\t\tif ($(\"body\").hasClass(\"helper\")) {\n\t\t\tdocument.location.hash='helper';\n\t\t} else if ($(\"body\").hasClass(\"schedule\")) {\n\t\t\tstepHandler();\n\t\t} else if ($(\"body\").hasClass(\"planning\")) {\n\t\t\tdocument.location.href='index.php#scanner';\n\t\t} else {\n\t\t\thistory.go(-1);\n\t\t}\n\t});\n\t$(window).bind(\"scroll\",scrollHandler);\n\t$(\"a.filters\").bind(\"click\",function(e) {\n\t\t$(\".swt_modal\").addClass(\"active\");\n\t\t$(\"body\").addClass(\"modals\");\n\t\t$(\".swt_modal > div\").removeClass(\"active\");\n\t\t$(\".back_nav\").addClass(\"inactive\");\n\t\t$(\".swt_modal .departure_controls\").addClass(\"active\");\n\t\t$(\".swt_modal\").removeClass(\"trainmessage\");\n\t\t$(\"a.burger\").addClass(\"close-button\");\n\t\te.preventDefault();\n\t\treturn false;\n\t});\n\t$(\"a.burger\").bind(\"click\",function(e) {\n\t\tif ($(\"body\").hasClass(\"schedule\")) {\n\t\t\thistoryCount++;\n\t\t}\n\t\t$(window).unbind('hashchange');\n\t\t$(\"header.controls\").removeClass(\"toolactive navigateactive\");\n\t\tif ($(this).hasClass(\"close-button\")) {\n\t\t\t$(\"body\").removeClass(\"station_picker\");\n\t\t\tif ($(\".swt_modal\").hasClass(\"active\")) {\n\t\t\t\t$(\".swt_modal\").removeClass(\"active train_message\");\n\t\t\t\t$(\"body\").removeClass(\"modals\");\n\t\t\t\t$(\".back_nav\").removeClass(\"inactive\");\n\t\t\t} else {\n\t\t\t\tcloseJourneyScreen();\n\t\t\t\t$(\"body\").removeClass(\"helper\");\n\t\t\t\tsetTimeout(enterHomeScreen,550);\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t$(\".home .top\").css(\"transition-duration\",\"0.4s\").css(\"transition-timing-function\",\"cubic-bezier(0,.91,.12,.99)\");\n\t\t\t\t\t\t$(\".home .bottom\").css(\"transition-duration\",\"0.4s\").css(\"transition-timing-function\",\"cubic-bezier(0,.91,.12,.99)\");\n\t\t\t\t\t},100);\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t$(\".home .top\").css(\"transform\",\"translateY(0)\").css(\"opacity\",1);\n\t\t\t\t\t\t$(\".home .bottom\").css(\"transform\",\"translateY(0)\").css(\"opacity\",1);\n\t\t\t\t\t},110);\n\t\t\t\t},200);\n\t\t\t}\n\t\t\t$(this).removeClass(\"close-button\");\n\t\t} else if ($(this).hasClass(\"signpost\")) {\n\t\t\tif ($(\"section.helper\").hasClass(\"choices\") || $(\"section.helper\").hasClass(\"profile\")) {\n\t\t\t\tdocument.location.hash=\"\";\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t$(\"body\").removeClass(\"helper\");\n\t\t\t\t\t$(\"header .price\").removeClass(\"inactive\");\n\t\t\t\t\t$(\"a.burger\").removeClass(\"signpost\");\n\t\t\t\t\t$(\"section.helper\").removeClass(\"active\")\n\t\t\t\t\t$(\"div.search_station\").removeClass(\"inactive\");\n\t\t\t\t},450);\n\t\t\t} else {\n\t\t\t\tdocument.location.hash=\"\";\n\t\t\t\t$(\"body\").removeClass(\"helper\");\n\t\t\t\t$(\"header .price\").removeClass(\"inactive\");\n\t\t\t\t$(this).removeClass(\"signpost\");\n\t\t\t\t$(\"section.helper\").removeClass(\"active\")\n\t\t\t\t$(\"div.search_station\").removeClass(\"inactive\");\n\t\t\t}\n\t\t\t$(\".choice_info\").html(\"\");\n\t\t} else {\n\t\t\t\n\t\t\tdocument.location.hash=\"helper\";\n\t\t\thashChangeHandler();\n\t\t\t$(\"body\").addClass(\"helper\");\n\t\t\t$(this).addClass(\"signpost\");\n\t\t\t$(\"section.helper\").unbind();\n\t\t}\n\t\t$(window).bind('hashchange', hashChangeHandler);\n\t\te.preventDefault();\n\t\treturn false;\n\t});\n\t$(\".choices-menu button.journey_alerts\").bind(\"click\",function() {\n\t\thistoryCount++;\n\t\t$(window).unbind('hashchange');\n\t\tdocument.location.hash=\"journey_alerts\";\n\t\t$(\"header.controls\").removeClass(\"toolactive\").addClass(\"navigateactive\");\n\t\t$(\"section.helper\").addClass(\"choices\");\n\t\t$(window).bind('hashchange', hashChangeHandler);\n\t});\n\t\n\t$(\".controls .profile\").bind(\"click\",function(e) {\n\t\tif ($(\".touch_test\").css(\"display\")==\"inline\") {\n\t\t\te.preventDefault();\n\t\t\tdocument.location.href=\"profile.php\";\n\t\t} else {\n\t\t\te.preventDefault();\n\t\t\tdocument.location.hash=\"profile\";\n\t\t}\n\t\t\n\t});\n});","var departure_data;\nvar departurePriceAverageTemp = new Array();\nvar departurePriceAverage = new Array();\nvar sortField = \"departure_ms\";\nvar sliderValues;\nvar cheapestTotal = 0;\nvar trainDirection = \"outbound\";\nvar globalJSON;\n\n// variables specific for this trip\nvar cheapReturn1 = 28;\nvar cheapReturn2 = 51;\nvar feedFile = \"departures-wat_clj.json\";\nvar childFactor = 0.55; //child price percentage of adult price\n\nStorage.prototype.setObject = function(key, value) {\n    this.setItem(key, JSON.stringify(value));\n}\n\nStorage.prototype.getObject = function(key) {\n    var value = this.getItem(key);\n    return value && JSON.parse(value);\n}\n\n// resetting localstorage object for page reload\nvar nullObject = new Object();\nlocalStorage.setObject(\"cheapest_outbound\",nullObject);\nlocalStorage.setObject(\"cheapest_returning\",nullObject);\nlocalStorage.setObject(\"selected_outbound\",nullObject);\nlocalStorage.setObject(\"selected_returning\",nullObject);\nvar currentCheapestPrice = 0;\n\n$(function() {\n\t\n\t$(\"body.schedule\").each(function() {\n\t\t$(\".sort_by\").bind(\"change\",function() {\n\t\t\tsortField = $(\".sort_by:checked\").val();\n\t\t\tconsole.log(sortField);\n\t\t\t$(\".range_slider\").slider( { values: sliderValues } );\n\t\t\t$(window).scrollTop(0);\n\t\t});\n\t\t$(\".departure_controls .range_slider\" ).slider({\n\t\t\trange: true,\n\t\t\tmin: 0,\n\t\t\tmax: 12,\n\t\t\tvalues: [ 0, 12 ],\n\t\t\tchange: slideHandler,\n\t\t\tslide: slideHandler\n\t\t});\n\t\tvar jqxhr = $.getJSON( \"feeds/\"+feedFile, {format: \"json\"}, function(data) {\n\t\t\tdeparture_data = data;\n\t\t\tvar start_ms =19560001, end_ms = 25980000;\n\t\t\tglobalJSON = data;\n\t\t\t// $(\".outbound ul.travel_list\").html(dataHandler(data));\n\t\t\tdataHandler(data, { direction:trainDirection });\n\t\t\tschedule.Update();\n\t\t\tvar myDataPoints = new Array();\n\t\t\tfor (i=0;i<12;i++) {\n\t\t\t\tvar tempAverage = 0;\n\t\t\t\tfor (a=0;a<departurePriceAverageTemp[i].length; a++) {\n\t\t\t\t\ttempAverage += departurePriceAverageTemp[i][a];\n\t\t\t\t}\n\t\t\t\tif (tempAverage>0) {\n\t\t\t\t\tdeparturePriceAverage[i]=(tempAverage/departurePriceAverageTemp[i].length);\n\t\t\t\t} else {\n\t\t\t\t\tdeparturePriceAverage[i]=0;\n\t\t\t\t}\n\t\t\t\tconsole.log(\"Average price: \"+Math.floor(i*2)+\"-\"+(Math.floor(i*2)+2)+\": \"+departurePriceAverage[i],((departurePriceAverage[i]/8)*100));\n\t\t\t\t$(\".departure_controls .price_stat ol li:nth-child(\"+(i+1)+\") .bar\").css(\"height\",((departurePriceAverage[i]/8)*100)+\"%\");\n\t\t\t\t//mySVG+=\" S\"+Math.floor(100*(i/12))+\",\" +Math.floor(100-((departurePriceAverage[i]/8)*100));\n\t\t\t\tmyDataPoints.push({ x: i*2, y: departurePriceAverage[i] });\n\n\t\t\t\t// mySVG += \" S\"+prev.X+\",\"+(prev.Y+10)+\"\"\n\t\t\t}\n\t\t\tmyDataPoints.push({ x: 24, y: departurePriceAverage[11]});\n\t\t\tconsole.log(myDataPoints);\n\n\t\t\tvar chart = new CanvasJS.Chart(\"chartContainer\",\n\t\t\t\t{\n\t\t\t\t\tanimationEnabled: true,  \n\t\t\t\t\t axisY: {\n\t\t\t\t\t \ttickLength: 0,\n\t\t\t\t\t \tlabelFontFamily: \"Roboto\",\n\t\t\t\t\t \tlineThickness: .5,\n\t\t\t\t\t\tgridThickness: .0,\n\t\t\t\t\t\ttickThickness: 0,\n\t\t\t\t\t\tlabelFontSize: 10,\n\t\t\t\t\t\tlabelFormatter: function(e){\n\t\t\t\t\t\t\treturn  \"£\" + e.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t// \ttitle: \"Units Sold\",\n\t\t\t\t\t// \tvalueFormatString: \"#0,,.\",\n\t\t\t\t\t// \tsuffix: \" m\"\n\t\t\t\t\t},\n\t\t\t\t\taxisX: {\n\t\t\t\t\t\tinterval:2,\n\t\t\t\t\t\tminimum:0,\n\t\t\t\t\t\tlabelFontFamily: \"Roboto\",\n\t\t\t\t\t\ttickLength: 7,\n\t\t\t\t\t\tlineThickness: .5,\n\t\t\t\t\t\tgridThickness: .0,\n\t\t\t\t\t\ttickThickness: 0,\n\t\t\t\t\t\tmargin: 10,\n\t\t\t\t\t\tlabelFontSize: 10\n\t\t\t\t\t},\n\t\t\t\t\tdata: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"splineArea\",\n\t\t\t\t\t\tmarkerSize: 0,\n\t\t\t\t\t\tcolor: \"rgba(67,181,102,.7)\",\n\t\t\t\t\t\tdataPoints: myDataPoints\n\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\tchart.render();\n\t\t\t// mySVG+='T100 100 L0 100 Z\" fill=\"red\" /></svg>';\n\t\t\t\n\t\t}).done(function() {\n\t\t\t// console.log( \"second success\" );\n\t\t})\n\t\t.fail(function(e) {\n\t\t\tconsole.log( \"error\",e );\n\t\t})\n\t\tsetTimeout(setSlideMinNow,200);\n\t});\n});\nfunction setSlideMinNow() {\n\tvar now = new Date();\n\tvar currentHour = Math.floor(now.getHours()*0.5);\n\t$(\".departure_controls .range_slider\" ).slider({ values: [ currentHour, 12 ] });\n}\nfunction resetSlideHandler() {\n\t$(\".departure_controls .range_slider\" ).slider({ values: [ 0, 12 ] });\n}\nfunction slideHandler( event, ui ) {\n\tsliderValues = ui.values;\n\tvar start_ms =(ui.values[ 0 ]*2*(1000*60*60)), end_ms = (ui.values[ 1 ]*2*(1000*60*60));\n\t$(\".range_slider\").removeClass(\"zero\");\n\tif (ui.values[0]==0) {\n\t\t$(\".range_slider\").addClass(\"zero\");\n\t} \n\t$(\".range_slider\").removeClass(\"full\");\n\tif (ui.values[1]==12) {\n\t\t$(\".range_slider\").addClass(\"full\");\n\t}\n\t\n\tvar start_hour = Math.floor(((start_ms/1000)/60)/60);\n\tvar start_minute = Math.floor((start_ms/1000)/60) - (start_hour*60);\n\tvar end_hour = Math.floor(((end_ms/1000)/60)/60);\n\tvar end_minute = Math.floor((end_ms/1000)/60) - (end_hour*60);\n\n\t$(\".departure_controls .range_info\").html(pad(start_hour,2)+\":\"+pad(start_minute,2)+\" - \"+pad(end_hour,2)+\":\"+pad(end_minute,2));\n\t$(\".departure_controls .price_stat ol li\").removeClass(\"inactive\");\n\tfor (i=0;i<ui.values[0];i++) {\n\t\t$(\".departure_controls .price_stat ol li:nth-child(\"+(i+1)+\")\").addClass(\"inactive\");\n\t}\n\tfor (i=ui.values[1]; i<12;i++) {\n\t\t$(\".departure_controls .price_stat ol li:nth-child(\"+(i+1)+\")\").addClass(\"inactive\");\n\t}\n\tif (event.type == \"slidechange\") {\n\t\tvar options = {\n\t\t\tdeparture_ms: {gte:start_ms, lte:end_ms},\n\t\t\tdirection: trainDirection\n\t\t};\n\t\tdataHandler(departure_data, options);\n\t\tschedule.Update();\n\t}\n}\nfunction calculatePrice(single) {\n\tvar ticketList = new Array();\n\n\tvar outbound \t= localStorage.getObject(\"selected_outbound\");\n\tvar returning \t= localStorage.getObject(\"selected_returning\");\n\n\tif (!outbound.cheapest_single) {\n\t\toutbound \t= localStorage.getObject(\"cheapest_outbound\");\n\t}\n\tif (!returning.cheapest_single) {\n\t\treturning \t= localStorage.getObject(\"cheapest_outbound\");\n\t}\n\tvar adults \t\t= localStorage.getItem(\"adults\");\n\tvar children\t= localStorage.getItem(\"children\");\n\n\tvar cheapestDoubleSingle = outbound.cheapest_single + returning.cheapest_single; // price of singles combined\n\n\tif (outbound.cheap_rtn_1 && returning.cheap_rtn_1 ) {\n\t\tvar cheapestReturn = cheapReturn1;\n\t\tvar firstMessage = \"Valid for off-peak trains only\";\n\t} else if (outbound.cheap_rtn_2 && returning.cheap_rtn_2) {\n\t\tvar cheapestReturn = cheapReturn2;\n\t\tvar firstMessage = \"Valid for off-peak trains only. Enjoy a free lunch with this ticket.\";\n\t} else {\n\t\tcheapestReturn = outbound.cheapest_single + returning.cheapest_single;\n\t}\n\tif (cheapestReturn<cheapestDoubleSingle) {\n\t\tcheapestTicketPrice = cheapestReturn;\n\t\tcurrentCheapestPrice = (adults * cheapestTicketPrice + children * (cheapestTicketPrice * childFactor));\n\t\t//<li>off-peak standard return</li>,<li>off-peak first return</li>\"; //either rtn_1 or rtn_2 price \n\t\tvar ticketOptions = '<li>\n\t\t\t<div class=\"price\">£'+cheapestReturn+'</div>\n\t\t\t<div class=\"name\">Off-peak Return</div>\n\t\t\t<div class=\"description\"><small>Valid for off-peak trains only</small></div>\n\t\t</li>\n\t\t<li>\n\t\t\t<div class=\"price\">£'+(cheapestReturn*1.75)+'</div>\n\t\t\t<div class=\"name\">First Off-peak Return</div>\n\t\t\t<div class=\"description\"><small>'+firstMessage+'</small></div>\n\t\t</li>';\n\t} else {\n\t\tcheapestTicketPrice = cheapestDoubleSingle;\n\t\tcurrentCheapestPrice = (adults * cheapestTicketPrice + children * (cheapestTicketPrice * childFactor));\n\t\tif (outbound.cheap_rtn_1 || outbound.cheap_rtn_2) {\n\t\t\tvar outbound_name=\"Off-peak\";\n\t\t\tvar outboundStandardMessage = \"Ticket valid for off-peak trains only on outbound journey.\";\n\t\t\tvar outboundFirstMessage = outboundStandardMessage + \" Enjoy a free lunch on the outbound train.\";\n\t\t} else {\n\t\t\tvar outbound_name=\"Anytime\";\n\t\t\tvar outboundStandardMessage = \"Ticket valid for all trains on outbound journey.\";\n\t\t\tvar outboundFirstMessage = outboundStandardMessage + \" Enjoy a free lunch on the outbound train.\";\n\t\t}\n\t\tif (returning.cheap_rtn_1 || returning.cheap_rtn_2) {\n\t\t\tvar returning_name=\"Off-peak Combo\";\n\t\t\tvar returningStandardMessage = \"Ticket valid for off-peak trains only on returning journey.\";\n\t\t\tvar returningFirstMessage = returningStandardMessage + \" Enjoy a free lunch on the returning train.\";\n\t\t\tif (outbound_name==\"Off-peak\") { // prevent duplicate message for both trains\n\t\t\t\treturningStandardMessage=\"\";\n\t\t\t\treturningFirstMessage=\"\"\n\t\t\t\toutboundStandardMessage=\"Ticket valid for off-peak trains only.\";\n\t\t\t\toutboundFirstMessage=outboundStandardMessage+\" Enjoy a free lunch on the returning train.\";\n\t\t\t}\n\t\t} else {\n\t\t\tvar returning_name=\"Anytime Combo\";\n\t\t\tvar returningStandardMessage = \"Ticket valid for all trains on returning journey.\";\n\t\t\tvar returningFirstMessage = returningStandardMessage + \" Enjoy a free lunch on the returning train.\";\n\t\t\tif (outboundFirstMessage.indexOf('lunch')>-1) {\n\t\t\t\toutboundFirstMessage = outboundStandardMessage;\n\t\t\t\treturningFirstMessage = returningStandardMessage + \" Enjoy a free lunch on both trains.\";\n\t\t\t}\n\t\t\tif (outbound_name==\"Anytime\") { // prevent duplicate message for both trains\n\t\t\t\treturningStandardMessage=\"\";\n\t\t\t\treturningFirstMessage=\"\"\n\t\t\t\toutboundStandardMessage=\"Ticket valid for all trains.\";\n\t\t\t\toutboundFirstMessage=outboundStandardMessage+\" Enjoy a free lunch on both trains.\";\n\t\t\t}\n\t\t}\n\n\t\tvar ticketOptions = '<li>\n\t\t\t<div class=\"price\">£'+currentCheapestPrice.toFixed(2)+'</div>\n\t\t\t<div class=\"name\">'+outbound_name+\" + \"+returning_name+'</div>\n\t\t\t<div class=\"description\"><small>'+outboundStandardMessage+\" \"+ returningStandardMessage+'</small></div>\n\t\t</li>\n\t\t<li>\n\t\t\t<div class=\"price\">£'+(currentCheapestPrice*1.75).toFixed(2)+'</div>\n\t\t\t<div class=\"name\" title=\"'+outbound_name+\" + \"+returning_name+' First\">Upgrade to first class</div>\n\t\t\t<div class=\"description\"><small>'+outboundFirstMessage+\" \"+returningFirstMessage+'</small></div>\n\t\t</li>';\n\t}\n\t$(\".ticket_options ul\").html(ticketOptions+'<li><a href=\"#\">Show other ticket options</a></li>');\n\t$(\".ticket_options ul li\").bind(\"click\",schedule.ScheduleStep);\n\t$(\".schedule .sticky_info .price .amount, .schedule .controls .price .amount, .schedule .itinerary_container .price .amount\").html(\"£\"+currentCheapestPrice.toFixed(2));\n\t$(\".itinerary .travel_list .price\").html(\"£\"+currentCheapestPrice.toFixed(2));\n\t$(\".schedule button.buy .amount\").html(\"£\"+currentCheapestPrice.toFixed(2));\n\treturn currentCheapestPrice;\n}\n\nfunction calculatePriceDifference(journeyObj) {\n\tvar offpeak\t\t= false;\n\tvar returnT \t= true;\n\tvar outbound \t= localStorage.getObject(\"selected_outbound\");\n\tvar returning \t= localStorage.getObject(\"selected_returning\");\n\n\tif (!outbound.cheapest_single) {\n\t\toutbound \t= localStorage.getObject(\"cheapest_outbound\");\n\t}\n\tif (!returning.cheapest_single) {\n\t\treturning \t= localStorage.getObject(\"cheapest_outbound\");\n\t}\n\n\tvar adults \t\t= localStorage.getItem(\"adults\");\n\tvar children\t= localStorage.getItem(\"children\");\n\n\tif (trainDirection == \"outbound\") {\n\t\toutbound = journeyObj;\n\t} else {\n\t\treturning = journeyObj;\n\t}\n\n\tvar cheapestDoubleSingle = outbound.cheapest_single + returning.cheapest_single; // price of singles combined\n\n\tif (outbound.cheap_rtn_1 && returning.cheap_rtn_1 ) {\n\t\tvar cheapestReturn = cheapReturn1;\n\t\toffpeak = true;\n\t} else if (outbound.cheap_rtn_2 && returning.cheap_rtn_2) {\n\t\tvar cheapestReturn = cheapReturn2;\n\t\toffpeak = true;\n\t} else {\n\t\tcheapestReturn = outbound + returning;\n\t}\n\tif (cheapestReturn<cheapestDoubleSingle) {\n\t\tcheapestTicketPrice = cheapestReturn;\n\t} else {\n\t\tcheapestTicketPrice = cheapestDoubleSingle;\n\t\treturnT = false;\n\t}\n\tthisCheapestPrice = (adults * cheapestTicketPrice + children * (cheapestTicketPrice * childFactor));\n\n\tlocalStorage.setItem(\"offpeak\",offpeak);\n\tlocalStorage.setItem(\"returnTicket\",returnT);\n\n\treturn thisCheapestPrice-currentCheapestPrice;\n}\n\nfunction dataHandler(json, options) {\n\tif (typeof json == \"undefined\") {\n\t\tjson = globalJSON;\n\t\tif (typeof json == \"undefined\") return false;\n\t}\n\tvar departures = TAFFY(json);\n\tprevPeak=true;\n\tvar scheduleHTML = \"\";\n\tif (typeof options.departure_ms == \"undefined\" && departurePriceAverageTemp.length==0) {\n\t\tfor (i=0;i<12;i++) {\n\t\t\tvar tempArray = new Array();\n\t\t\tdeparturePriceAverageTemp.push(tempArray);\n\t\t\t//detect outbound vs returning\n\t\t}\n\t}\n\tvar cheapestDepartureItem = departures(options).order(\"cheapest_single\").first();\n\tglobalAdultPrice =cheapestDepartureItem.cheapest_single;\n\tglobalChildPrice = globalAdultPrice*childFactor;\n\n\t// var tempCheapestTotal = localStorage.getItem(\"adults\") * globalAdultPrice + localStorage.getItem(\"children\") * globalChildPrice;\n\tvar returnOptions = clone(options);\n\treturnOptions.direction = \"returning\";\n\n\tlocalStorage.setObject(\"cheapest_outbound\",departures(options).order(\"cheapest_single\").first());\n\tlocalStorage.setObject(\"cheapest_returning\",departures(returnOptions).order(\"cheapest_single\").first());\n\n\tvar tempCheapestTotal = calculatePrice(departures(options).order(\"cheapest_single\").first().cheapest_single);\n\tvar returnCheapestTotal = tempCheapestTotal + calculatePrice(departures(returnOptions).order(\"cheapest_single\").first().cheapest_single);\n\t// $(\"header.controls .price .amount\").html(\"£\"+returnCheapestTotal.toFixed(2));\n\tdocument.querySelector(\".\"+trainDirection+\" ul.travel_list\").innerHTML=\"\";\n\t\n\tdepartures(options).order(sortField).each(function(journey) {\n\t\tvar peak = (journey.cheap_rtn_1 || journey.cheap_rtn_2);\n\t\tif (prevPeak!=peak) {\n\t\t\t// peak changed\n\t\t\tprevPeak = peak;\n\t\t}\n\t\tvar thisAdultPrice = journey.cheapest_single;\n\t\tvar thisChildPrice = journey.cheapest_single * childFactor;\n\n\t\tvar thisPrice = localStorage.getItem(\"adults\") * thisAdultPrice + localStorage.getItem(\"children\") * thisChildPrice;\n\n\t\tvar today = new Date();\n\t\tvar tempDepartureTime = journey.departure.split(\":\");\n\t\tvar departureTime = new Date(today.getFullYear(), today.getMonth(), today.getDate(), tempDepartureTime[0], tempDepartureTime[1], 0, 0);\n\t\tvar arrivalTime = new Date(departureTime);\n\t\tvar valid_info = \"Valid anytime\";\n\t\tif (journey.cheap_rtn_1 && journey.cheap_rtn_2) valid_info = \"Off-peak\";\n\t\tarrivalTime.setTime(arrivalTime.getTime() + journey.duration*60*1000);\n\t\t// console.log(departureTime + \" --> \" + arrivalTime + \"  (\"+journey.duration+\"min)\");\n\t\tvar dLi = document.createElement(\"li\");\n\t\tvar thisPriceAdd = Math.round(10*(thisPrice-currentCheapestPrice))/10;\n\t\tdLi.journeyData=journey;\n\t\tvar thisPriceDifference = calculatePriceDifference(journey);\n\t\tdLi.innerHTML =  '<div class=\"price\">'+formatPrice(thisPriceDifference)+'</div>\n\t\t\t\t\t\t\t<datetime>'+journey.departure+'</datetime><span class=\"arrow\"></span><a href=\"#\" class=\"changes\">'+journey.changes+'</a><span class=\"arrow\"></span><datetime>'+pad(arrivalTime.getHours(),2)+':'+pad(arrivalTime.getMinutes(),2)+'</datetime><br>\n\t\t\t\t\t\t\t<span class=\"valid_info\">'+valid_info+'</span><span class=\"platform\">Platform '+journey.platform+'</span><span class=\"duration\">'+formatMinutes(journey.duration)+'</span>';\n\t\tif (journey.delay!=\"\" || journey.offer_header!=\"\") {\n\t\t\tfooterHTML=\"<footer>\";\n\t\t\tif (journey.delay!=\"\") {\n\t\t\t\tfooterHTML+='<span class=\"delay\">'+journey.delay+'</span>';\n\t\t\t}\n\t\t\tif (journey.offer_header!=\"\") {\n\t\t\t\tfooterHTML+='<span class=\"offer\"><span class=\"header\">'+journey.offer_header+'</span><span class=\"offer_icon\"><img src=\"img/'+journey.offer_icon+'.svg\"></span><span class=\"offer_message\"><p>'+journey.offer_message+'</p></span></span>';\n\t\t\t}\n\t\t\tfooterHTML+='</footer>';\n\t\t\tdLi.innerHTML+=footerHTML;\n\t\t}\n\t\t\n\t\tdLi.journeyData.cheapest_single_child = journey.cheapest_single*childFactor;\n\t\tdLi.addEventListener(\"click\",schedule.ScheduleStep);\n\t\tdocument.querySelector(\".\"+journey.direction+\" ul.travel_list\").appendChild(dLi);\n\n\t\t// average prices\n\t\tvar number = Math.floor(parseInt(tempDepartureTime[0])/2);\n\t\tif (typeof options.departure_ms == \"undefined\") {\n\t\t\t var tempSubArray = departurePriceAverageTemp[number];\n\t\t\t tempSubArray.push(journey.cheapest_single);\n\t\t}\n\t\t\n\t});\n\t// return scheduleHTML;\n\t$(\"ul.travel_list span.offer\").bind(\"click\",offerHandler);\n}\nfunction formatMinutes(min) {\n\tvar hours = Math.floor(min/60);\n\tvar minutes = min - hours * 60\n\treturn hours +\"h \"+ minutes+\"m\";\n}\nfunction clone(obj) {\n\tif (null == obj || \"object\" != typeof obj) return obj;\n\tvar copy = obj.constructor();\n\tfor (var attr in obj) {\n\t\tif (obj.hasOwnProperty(attr)) copy[attr] = obj[attr];\n\t}\n\treturn copy;\n}\nfunction formatPrice(price) {\n\tvar formattedPrice;\n\tif (price<0) {\n\t\tformattedPrice = \"- £\" +Math.abs(price).toFixed(2);\n\t} else {\n\t\tformattedPrice = \"+ £\" + price.toFixed(2);\n\t}\n\treturn formattedPrice;\n}\nfunction updatePriceList() {\n\t$(\".\"+trainDirection+\" ul.travel_list li\").each(function(i, obj) {\n\t\t// console.log(obj)\n\t\t$(\".price\",$(obj)).html(formatPrice(calculatePriceDifference(obj.journeyData)));\n\t});\n}\n","var keyboardTimeout;\nvar searchTimeout;\nvar activeInput;\n$(function() {\n    $(\"body.home .location\").bind(\"click\",function() {\n        activeInput = this;\n        this.blur();\n        $(\"body\").addClass(\"station_picker\");\n        $(\".burger\").addClass(\"close-button\");\n    });\n    $(\"body.home .station_list li\").bind(\"click\",function() {\n        $(activeInput).html(this.innerHTML).addClass(\"valid\");\n        $(\"body\").removeClass(\"station_picker\");\n        $(\".burger\").removeClass(\"close-button\");\n        if ($(\".top .location\").html()!=\"&nbsp;\" && $(\".bottom .location\").html()!=\"&nbsp;\") $(\".get_tickets button\").prop(\"disabled\",false);\n    });\n    $(\"input.station\").bind(\"keyup\", update);\n\n    function update(e) {\n        clearTimeout(keyboardTimeout);\n        var value = $(\"input.station\").val();\n        if (value == \"\") value = \"a\";\n        stationSearch(value);\n    }\n\n    function stationSearch(value) {\n        $(\"ul.list\").html(\"<li><span class=\\\"searching\\\"></span></li>\");\n        clearTimeout(searchTimeout);\n        searchTimeout = setTimeout(function() {\n            $(\"ul.list\").css(\"opacity\", 0).html('<li style=\"opacity:0\" class=\"clickaction\"><a href=\"javascript:void(0);\">Birmingham Arena</a></li><li style=\"opacity:0\" class=\"remove\" class=\"clickaction\"><a href=\"javascript:void(0);\"\">Birmingham City Centre</a></li>');\n            $(\"ul.list\").animate({\n                opacity: 1\n            }, 300);\n            $(\"ul.list li\").each(function(i, e) {\n                setTimeout(function(obj) {\n                    $(obj).animate({\n                        opacity: 1\n                    }, 300);\n                }, i * 200 + 200, e);\n            }).bind(\"click\", function() {\n                closeDestinationScreen();\n                // enterHomeScreen();\n                $(\"div.search_station\").addClass(\"inactive\");\n                setTimeout(function() {\n\n                    enterLocating();\n\n                },1600);\n            });\n        }, 1000);\n        keyboardTimeout = setTimeout(removeKeyboardFocus, 1500);\n    }\n    \n\n    function removeKeyboardFocus() {\n        $(\"input.station\").blur();\n    }\n    $(\"#return\").bind(\"focus\", function() {\n        $(\".extra\").addClass(\"open\");\n        console.log(\"first \" + window.innerHeight);\n        setTimeout(function() {\n            $(\".extra\").css(\"top\", $(window).scrollTop());\n            console.log(\"second \" + window.outerHeight, $(window).scrollTop());\n        }, 300);\n\n    });\n    $(\"#return\").bind(\"blur\", function() {\n        $(\".extra\").removeClass(\"open\");\n    });\n    $(\"input[type=date]\").bind(\"change\",function() {\n        setFormattedDate($(this).next().next()[0],this);\n    });\n    $(\".planning radiogroup input[type=radio]\").bind(\"click\",function() {\n        $(this).prop('checked', true);\n        switch ($(\"input[type=radio]:checked\",$(this).parent()).attr(\"value\")) {\n            case 'single':\n                $(\".dates\").removeClass(\"double\");\n                $(\".dates .return input\").prop(\"disabled\",true);\n                globalAdultPrice = 6;\n                globalChildPrice = globalAdultPrice * childFactor;\n                break;\n            case 'return':\n                $(\".dates .return input\").prop(\"disabled\",false);\n                if ($(\".return input[type=text]\").val()==\"Open\") {\n                     $(\".return input[type=text]\").val(\"\");\n                }\n                globalAdultPrice =12;\n                globalChildPrice = globalAdultPrice * childFactor;\n                setFormattedDate($(\".return input[type=text]\"), $(\".return input[type=date]\"));\n               $(\".dates\").addClass(\"double\");\n                break;\n            case 'open-return':\n                $(\".dates\").addClass(\"double\");\n                $(\".return input[type=text]\").val(\"Open\");\n                break;\n        }\n        var priceAdults = adults.value * globalAdultPrice;\n        var priceChildren = children.value * globalChildPrice;\n        var priceTotal = parseFloat(Math.round(10*(priceAdults+priceChildren))/10);\n        $(\"header.controls .price .amount\").html(\"£\"+priceTotal.toFixed(2));\n        $(\"button.buy .amount\").html(\"£\"+priceTotal.toFixed(2));\n\n    });\n    function setFormattedDate(target, source) {\n        if ($(source).val().length>0) {\n            var today = new Date();\n            var minDate = new Date(source.min);\n            // minDate.setMinutes(minDate.getMinutes()+839);\n            var date = new Date($(source).val());\n            // date.setMinutes(date.getMinutes()+900);\n            if (minDate>date) {\n                date=minDate;\n                $(source).val(date);\n            }\n            \n            var timezoneOffset = date.getTimezoneOffset();\n\n            var daySelected = \"\";\n            var months = [\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];\n            // var months = [\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"];\n\n            if ($(source).attr(\"id\")==\"outbound\") {\n                localStorage.setItem(\"outbound\", date);\n                var compareDate = new Date($(\"#return\").val());\n                document.getElementById('return').min=$(source).val();\n                if (date>compareDate) {\n                    document.getElementById('return').value=\"\";\n                    $(\"#return\").next().next().val(\"\");\n                } else if ( $(\"#return\").next().val().length==0) {\n                    $(\"#return\").attr(\"value\",$(source).val());\n                }\n            } else {\n                localStorage.setItem(\"returning\", date);\n            }\n           \n            date.setMinutes(date.getMinutes()+timezoneOffset);\n            if (date.getDate() == today.getDate() && date.getMonth() == today.getMonth() && date.getYear() == today.getYear()) {\n                daySelected = \"Today\";\n            } else {\n                daySelected = months[date.getMonth()]+\" \"+ date.getDate();\n            }\n            $(target).val(daySelected);\n\n        }\n    }\n    function padDigits(number, digits) {\n        return Array(Math.max(digits - String(number).length + 1, 0)).join(0) + number;\n    }\n    $(\"input[type=date]\").each(function() {\n        var today = new Date();\n        document.getElementById(this.id).min = (today.getYear()+1900) + \"-\" + padDigits(today.getMonth()+1,2) +\"-\" + padDigits(today.getDate(),2);\n        if ( $(this).prop('type') != 'date' ) {\n            $(this).datepicker();\n        }\n    });\n\n});","var page_title_display;\nvar locate = false;\nfunction hashChangeHandler(e) {\n\tvar hash = document.location.hash.replace(\"#\",\"\");\n\tvar page_title;\n\t\n\tconsole.log(\"hash: \"+hash);\n\tswitch (hash) {\n\t\tcase \"helper\":\n\t\t\tif (!$(\"body\").hasClass(\"helper\")) {\n\t\t\t\tpage_title = $(\"header.controls .page_title span\").html();\n\t\t\t\tpage_title_display = $(\"header.controls .page_title\").css(\"display\");\n\t\t\t}\n\t\t\tlocate = $(\"body\").hasClass(\"locate\");\n\t\t\t\n\t\t\tif (!$(\"section.helper\").hasClass(\"active\")) {\n\t\t\t\tconsole.log(\"come on\");\n\t\t\t\t$(\".back_nav\").addClass(\"inactive\");\n\t\t\t\t$(\".controls .profile\").removeClass(\"inactive\");\n\t\t\t\t$(\"body\").addClass(\"helper\").removeClass(\"profile\");\n\t\t\t\t$(\"header.controls .page_title span\").html(\"Concierge\");\n\t\t\t\t$(\"header.controls .page_title\").css(\"display\",\"block\");\n\t\t\t\t$(this).addClass(\"signpost\");\n\t\t\t\t$(\"div.search_station\").addClass(\"inactive\");\n\t\t\t\t$(\"header.controls\").addClass(\"toolactive\");\n\t\t\t\t$(\"section.helper\").removeClass(\"choices profile\");\n\t\t\t\t$(\".choice_info\").html(\"\");\n\t\t\t\t$(\".helper .navigate\").removeClass(\"active\");\n\t\t\t\t$(window).scrollTop(0);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\twebkit.messageHandlers.callbackHandler.postMessage(\"white\");\n\t\t\t\t\t} catch (e) {\n\n\t\t\t\t\t}\n\t\t\t\t},600);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"journey_alerts\":\n\t\t\t$(\"header .price\").addClass(\"inactive\");\n\t\t\t$(\"body\").addClass(\"helper\").removeClass(\"profile\");\n\t\t\t$(this).addClass(\"signpost\");\n\t\t\t$(\".helper .navigate\").addClass(\"active\");\n\t\t\t$(\"section.helper\").addClass(\"choices\");\n\t\t\t$(\".back_nav\").removeClass(\"inactive\");\n\t\t\tbreak;\n\t\tcase \"profile\":\n\t\t\t$(\".controls .profile\").addClass(\"inactive\");\n\t\t\t$(\".back_nav\").removeClass(\"inactive\");\n\t\t\t$(\"header .price\").addClass(\"inactive\");\n\t\t\t$(\"section.helper\").removeClass(\"choices\");\n\t\t\t$(\"body\").addClass(\"helper\").addClass(\"profile\");\n\t\t\t$(this).addClass(\"signpost\");\n\t\t\t$(\"div.search_station\").addClass(\"inactive\");\n\t\t\tpage_title = $(\"header.controls .page_title span\").html();\n\t\t\tsetTimeout(function() {\n\t\t\t\t $(\"header.controls .page_title span\").html(\"Profile\");\n\t\t\t\t$(\".choice_info\").html('<span class=\"name\">Good morning<br><strong>John</strong></span><small>Log out</small>');\n\t\t\t\ttry {\n\t\t\t\t\twebkit.messageHandlers.callbackHandler.postMessage(\"white\");\n\t\t\t\t} catch (e) {\n\n\t\t\t\t}\n\t\t\t},500);\n\t\t\tbreak;\n\t\tcase \"locating\":\n\t\t\t// enterLocating();\n\t\t\tbreak;\n\t\tdefault:\n\t\t\topenDestinationScreen();\n\t\t\t$(\".controls .profile\").addClass(\"inactive\");\n\t\t\tif (!$(\"body\").hasClass(\"search_station\")) {\n\t\t\t\t$(\".back_nav\").removeClass(\"inactive\");\n\t\t\t}\n\t\t\t$(\"footer\").removeClass(\"active\");\n\t\t\t$(\".route_vertical\").removeClass(\"active\");\n\t\t\t$(\"header.controls\").removeClass(\"toolactive navigateactive\");\n\t\t\ttry {\n\t\t\t\twebkit.messageHandlers.callbackHandler.postMessage(\"white\");\n\t\t\t} catch (er) {\n\t\t\t\tconsole.log(\"oh no\");\n\t\t\t}\n\t\t\tif ($(\"section.helper\").hasClass(\"choices\") || $(\"section.helper\").hasClass(\"profile\")) {\n\t\t\t\t$(\"section.helper\").removeClass(\"choices profile\");\n\t\t\t\tconsole.log(\"closing slowly\");\n\t\t\t\tdocument.location.hash=\"\";\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t$(\"body\").removeClass(\"helper\");\n\t\t\t\t\t$(\"header .price\").removeClass(\"inactive\");\n\t\t\t\t\t$(\"a.burger\").removeClass(\"signpost\");\n\t\t\t\t\t$(\"section.helper\").removeClass(\"active\")\n\t\t\t\t\t$(\"div.search_station\").removeClass(\"inactive\");\n\t\t\t\t\t$(\"header.controls .page_title span\").html(page_title);\n\t\t\t\t\t$(\"header.controls .page_title\").css(\"display\",page_title_display);\n\t\t\t\t},450);\n\t\t\t\t$(\"body.home .back_nav\").addClass(\"inactive\");\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tdocument.location.hash=\"\";\n\t\t\t\tconsole.log(\"go back!\");\n\t\t\t\t$(\".controls .profile\").addClass(\"inactive\");\n\t\t\t\t$(\"body.home .back_nav\").addClass(\"inactive\");\n\t\t\t\t$(\"header.controls .page_title span\").html(page_title);\n\t\t\t\t$(\"header.controls .page_title\").css(\"display\",page_title_display);\n\t\t\t\t$(\"body\").removeClass(\"helper\");\n\t\t\t\t$(\"header .price\").removeClass(\"inactive\");\n\t\t\t\t$(this).removeClass(\"signpost\");\n\t\t\t\t\n\t\t\t\t$(\"section.helper\").removeClass(\"active\")\n\t\t\t\t$(\"div.search_station\").removeClass(\"inactive\");\n\t\t\t\tif (locate) {\n\t\t\t\t\t$(\"body\").addClass(\"locate\");\n\t\t\t\t\t$(\".route_vertical\").addClass(\"active\");\n\t\t\t\t\t$(\"div.search_station\").addClass(\"inactive\");\n\t\t\t\t}\n\t\t\t}\n\t\t\t$(\".choice_info\").html(\"\");\n\t\t\tbreak;\n\t}\n\n}\n$(function() {\n\t$(\"section.helper header .navigate a, section.helper .delete_message\").bind(\"click\",function(e) {\n\t\t$(window).unbind('hashchange');\n\t\tdocument.location.hash=\"helper\";\n\n\t\t$(\"section.helper\").removeClass(\"choices profile\");\n\t\t$(\".choice_info\").html(\"\");\n\t\t$(\"header.controls\").removeClass(\"navigateactive\").addClass(\"toolactive\");\n\t\te.preventDefault();\n\t\t$(window).bind('hashchange', hashChangeHandler);\n\t});\n\t$(\"section.helper, section.helper .swt_avatar p\").bind(\"click\", helperToggle);\n})\nfunction helperToggle(e) {\n\tif (!$(\"body\").hasClass(\"helper\")) {\n\t\t$(\"a.burger\").trigger(\"click\");\n\t}\n}","(function ($, window, document) {\n  \"use strict\";\n  // This code is only for iOS\n  if (!window.navigator.userAgent.match(/(iPhone|iPad|iPod)/)) {\n    return;\n  }\n\n  var CONFIG = {\n    TOUCH_MOVE_THRESHHOLD: 10,\n    PRESSED_CLASS: \"pressed\",\n    GHOST_CLICK_TIMEOUT: 500,\n    GHOST_CLICK_THRESHOLD: 10\n  }, clicks = [];\n\n  function withinDistance(x1, y1, x2, y2, distance) {\n    return Math.abs(x1 - x2) < distance && Math.abs(y1 - y2) < distance;\n  }\n\n  // Use a native event listener so we can set useCapture\n  document.addEventListener('click', function (e) {\n    for (var i = 0; i < clicks.length; i++) {\n      // For some reason, the ghost click events don't always appear where the touchend event was\n      if (withinDistance(clicks[i][0], clicks[i][1], e.clientX, e.clientY,\n        CONFIG.GHOST_CLICK_THRESHOLD)) {\n        e.preventDefault();\n        e.stopPropagation();\n        return;\n      }\n    }\n  }, true);\n\n  $(document).on('touchstart', '.no_delay_button', function (e) {\n    var elem = $(this);\n\n    // Disable the webkit tap highlight, since it is no longer accurate\n    elem.css('webkitTapHighlightColor', 'rgba(0,0,0,0)');\n\n    elem.addClass(CONFIG.PRESSED_CLASS);\n\n    var touch = e.originalEvent.touches[0];\n    var location = [touch.clientX, touch.clientY];\n    this.__eventLocation = location;\n\n    this.__onTouchMove = function (e) {\n      var touch = e.originalEvent.touches[0];\n      if (withinDistance(touch.clientX, touch.clientY, location[0], location[1],\n        CONFIG.TOUCH_MOVE_THRESHHOLD)) {\n        elem.addClass(CONFIG.PRESSED_CLASS);\n      } else {\n        elem.removeClass(CONFIG.PRESSED_CLASS);\n      }\n    };\n\n    $(document.body).on('touchmove', this.__onTouchMove);\n  });\n\n  $(document).on('touchcancel', '.no_delay_button', function () {\n    var elem = $(this);\n    elem.removeClass(CONFIG.PRESSED_CLASS);\n    $(document.body).off('touchmove', this.__onTouchMove);\n  });\n\n  $(document).on('touchend', '.no_delay_button', function (e) {\n    var elem = $(this);\n    if (elem.hasClass(CONFIG.PRESSED_CLASS)) {\n      elem.removeClass(CONFIG.PRESSED_CLASS);\n      var location = this.__eventLocation;\n      if (location) {\n        var touch = e.originalEvent.changedTouches[0];\n        if (!withinDistance(touch.clientX, touch.clientY, location[0], location[1],\n          CONFIG.TOUCH_MOVE_THRESHHOLD)) {\n          return;\n        }\n        // Dispatch a fake click event within a setTimeout. If we don't do this, there's a strange bug where\n        // the next view can't correctly bring the keyboard up\n        setTimeout(function() {\n          var evt = document.createEvent(\"MouseEvents\");\n          evt.initMouseEvent(\"click\", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n          elem.get(0).dispatchEvent(evt);\n        }, 1);\n\n        // Don't process the default action for this event to avoid WebKit stealing focus from a\n        // view we might be loading, and from dispatching a click event\n        e.preventDefault();\n\n        // Eat further \"ghost\" click events at this location that appear if the user holds the link down\n        // longer than the double-tap cancel threshold (these are not cancelled when preventing default)\n        var clickLocation = [touch.clientX, touch.clientY];\n        clicks.push(clickLocation);\n        window.setTimeout(function() {\n          var i = clicks.indexOf(clickLocation);\n          if (i >= 0) {\n            clicks.splice(i, 1);\n          }\n        }, CONFIG.GHOST_CLICK_TIMEOUT);\n      }\n    }\n\n    $(document.body).off('touchmove', this.__onTouchMove);\n  });\n\n})(jQuery, window, document);","var locationHandler = function() {\n\tvar googlePlacesAPI = \"AIzaSyCHh4oobxVPkxm0NuPSpusns3QNe9ZdJHU\";\n\tvar userPosition;\n\tvar lastInput;\n\t// https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=51.4859846,-0.1672702&types=train_station&key=AIzaSyCHh4oobxVPkxm0NuPSpusns3QNe9ZdJHU&rankby=distance\n\t\t\n\tfunction getCurrentLocation() {\n\t\tif (navigator.geolocation) {\n      \tnavigator.geolocation.getCurrentPosition(showPosition);\n     \t}\n\t}\n\tfunction showPosition(position) {\n\t\tuserPosition = position;\n\t\tconsole.log(userPosition);\n\t}\n\tfunction stationSearch(geolocation,searchname,sourceInput) {\n\t\t// var apiUrl = \"https://maps.googleapis.com/maps/api/place/nearbysearch/json\";\n\t\t// // ?location=51.4859846,-0.1672702&types=train_station&key=AIzaSyCHh4oobxVPkxm0NuPSpusns3QNe9ZdJHU&rankby=distance\";\n\t\t// var data = {\n\t\t//     key: googlePlacesAPI,\n\t\t//     location: geolocation,\n\t\t//     types: \"train_station\",\n\t\t//     rankby: \"distance\",\n\t\t//     format: \"json\"\n\t\t// };\n\t\t// $.ajax({\n\t\t//   url: apiUrl,\n\t\t//   data: data,\n\t\t//   type: \"GET\",  \n\t\t//   jsonpCallback: 'callback',\n\t\t//   dataType:\"html\",\n\t\t//   crossDomain: true,\n\t\t//   success: function(success) {\n\t\t// \t\tconsole.log(success);\n\t\t// \t\t// var places=stationSearch(geolocation);\n\t\t// \t}\n\t\t// });\n\t\tmap = new google.maps.Map(document.getElementById('map'), {\n\t      center: geolocation,\n\t      zoom: 15\n   \t});\n\t\tvar service = new google.maps.places.PlacesService(map);\n\t\tservice.nearbySearch({\n\t\t location: geolocation,\n\t\t name: searchname,\n\t\t // types: ['train_station'],\n\t\t rankBy: google.maps.places.RankBy.DISTANCE,\n\t\t}, processResults);\n\t}\n\tfunction travelSearch() {\n\t\tconsole.log(\"go travelsearch\");\n\t\tvar directionsService = new google.maps.DirectionsService();\n      var request = {\n         origin: $(\"#from_geo\").val(),\n         destination: $(\"#to_geo\").val(),\n         transitOptions: {\n\t\t\t\tdepartureTime: new Date(),\n\t\t\t\tmodes: [google.maps.TransitMode.RAIL],\n\t\t\t\talternatives: true,\n\t\t\t\troutingPreference: google.maps.TransitRoutePreference.FEWER_TRANSFERS\n\t\t\t},\n\t\t\tunitSystem: google.maps.UnitSystem.IMPERIAL,\n   \n         travelMode: google.maps.TravelMode[\"TRANSIT\"]\n      };\n      directionsService.route(request, function(response, status) {\n\t\t\tif (status == google.maps.DirectionsStatus.OK) {\n           \tconsole.log(response);\n         } else {\n         \tconsole.log(\"error\",response);\n         }\n      });\n   }\n\tfunction processResults(results,status,sourceInput){\n\t\tconsole.log(results,status);\n\t\t$choices=$(lastInput).next();\n\t\t$choices.css(\"height\",\"auto\");\n\t\t$choices.css(\"height\",\"0\");\n\n\t\tconsole.log($choices);\n\t\t$choices.html(\"<label>Nearby locations</label><ul></ul>\");\n\t\tvar a=0;\n\t\tfor (i=0; i<results.length;i++) {\n\t\t\t// if (i>0) {\n\t\t\t// \tif (results[i].name.indexOf(results[i-1].name)>-1) {\n\t\t\t// \t\t$(\"li\",$choices).filter(\":last\").remove();\n\t\t\t// \t\ta-=1;\n\t\t\t// \t}\n\t\t\t// }\n\t\t\t$(\"ul\",$choices).append('<li><a href=\"#\" data-place_geo=\"'+results[i].geometry.location.J+','+results[i].geometry.location.M+'\">'+results[i].name+'</li>');\n\t\t\tif (a>3) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t// if (i<results.length-1) {\n\t\t\t// \tif (results[i].name.indexOf(results[i+1].name)>-1) {\n\t\t\t// \t\ti+=1;\n\t\t\t// \t}\n\t\t\t// }\n\t\t\ta+=1;\n\t\t}\n\t\tif (a==0) {\n\t\t\t$choices.css(\"height\",0);\n\t\t} else {\n\t\t\t$choices.css(\"height\",(a*30)+30);\n\t\t}\n\t\t\n\t\t$(\"a\",$choices).bind(\"click\",stationChoiceHandler);\n\t\t// $(lastInput);\n\n\t}\n\tfunction stationChoiceHandler(e) {\n\t\tvar sourceElement = e.target;\n\t\tvar place_id = sourceElement.getAttribute(\"data-place_geo\");\n\t\t$(lastInput).val(sourceElement.innerHTML);\n\t\t$(\"#\"+$(lastInput).attr(\"id\")+\"_geo\").val(place_id);\n\t\te.preventDefault();\n\t\tconsole.log($(sourceElement).parent().parent().parent());\n\t\t$(sourceElement).parent().parent().parent().css(\"height\",0);\n\t}\n\tfunction nameSearch(sourceElm) {\n\t\tconsole.log(\"searching for: \", sourceElm.value);\n\t\tlastInput=sourceElm;\n\t\tvar apiUrl = \"https://maps.googleapis.com/maps/api/geocode/json\";\n\t\tvar data = {\n\t\t    key: googlePlacesAPI,\n\t\t    address: sourceElm.value,\n\t\t    components:'country:uk'\n\t\t};\n\t\t$.ajax({\n\t\t  url: apiUrl,\n\t\t  type: 'GET',\n\t\t  data: data,    \n\t\t  dataType:\"json\",\n\t\t  crossDomain: true,\n\t\t  success: function(data) {\n\t\t  // \t\tconsole.log(data);\n\t\t\t\t// // var geolocation = data.results[0].geometry.location.lat+\",\"+data.results[0].geometry.location.lng;\n\t\t\t\t// var geolocation = new google.maps.LatLng(data.results[0].geometry.location.lat,data.results[0].geometry.location.lng);\n\t\t\t\t// stationSearch(geolocation, sourceElm.value, sourceElm);\n\t\t\t\t\tvar results=data.results;\n\t\t\t\t\t$choices=$(sourceElm).next();\n\t\t\t\t\t$choices.css(\"height\",\"auto\");\n\t\t\t\t\t$choices.css(\"height\",\"0\");\n\n\t\t\t\t\tconsole.log($choices);\n\t\t\t\t\t$choices.html(\"<label>Nearby locations</label><ul></ul>\");\n\t\t\t\t\tvar a=0;\n\t\t\t\t\tfor (i=0; i<results.length;i++) {\n\t\t\t\t\t\t// if (i>0) {\n\t\t\t\t\t\t// \tif (results[i].name.indexOf(results[i-1].name)>-1) {\n\t\t\t\t\t\t// \t\t$(\"li\",$choices).filter(\":last\").remove();\n\t\t\t\t\t\t// \t\ta-=1;\n\t\t\t\t\t\t// \t}\n\t\t\t\t\t\t// }\n\t\t\t\t\t\tconsole.log(results[i]);\n\t\t\t\t\t\tvar append='<li><a href=\"#\" data-place_geo=\"'+results[i].geometry.location.lat+','+results[i].geometry.location.lng+'\">';\n\t\t\t\t\t\tplace = results[i];\n\t\t\t\t\t\tvar address = '';\n\t\t\t\t\t\tif (place.address_components) {\n\t\t\t\t\t\t      address = [\n\t\t\t\t\t\t        (place.address_components[0] && place.address_components[0].short_name || ''),\n\t\t\t\t\t\t        (place.address_components[1] && place.address_components[1].short_name || ''),\n\t\t\t\t\t\t        (place.address_components[2] && place.address_components[2].short_name || '')\n\t\t\t\t\t\t      ].join(', ');\n\t\t\t\t\t\t    }\n\t\t\t\t\t\t    append+=address;\n\t\t\t\t\t\tappend+=\"</li>\";\n\t\t\t\t\t\t$(\"ul\",$choices).append(append);\n\t\t\t\t\t\tif (a>3) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// if (i<results.length-1) {\n\t\t\t\t\t\t// \tif (results[i].name.indexOf(results[i+1].name)>-1) {\n\t\t\t\t\t\t// \t\ti+=1;\n\t\t\t\t\t\t// \t}\n\t\t\t\t\t\t// }\n\t\t\t\t\t\ta+=1;\n\t\t\t\t\t}\n\t\t\t\t\tif (a==0) {\n\t\t\t\t\t\t$choices.css(\"height\",0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$choices.css(\"height\",(a*30)+30);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t$(\"a\",$choices).bind(\"click\",stationChoiceHandler);\n\n\t\t\t}\n\t\t});\n\t\t// var input = sourceElm;\n\t\t// // var autocomplete = new google.maps.places.Autocomplete(input);\n\t\t// var autocomplete = new google.maps.places.Autocomplete(input, {\n       \n  //       componentRestrictions: {country: 'uk'}\n  //     });\n\t\t// autocomplete.addListener('place_changed', function() {\n\t\t// \tvar place = autocomplete.getPlace();\n\t\t// \tconsole.log(place);\n\t\t// });\n\t}\n\tfunction stationSearchKeyUpHandler(e) {\n\t\t// console.log(\"key up\");\n\t\tvar sourceElm = e.target;\n\t\tlastInput = e.target;\n\t\tclearTimeout(sourceElm.timeout);\n\t\tsourceElm.timeout = setTimeout(nameSearch,500,sourceElm);\n\t}\n\treturn {\n\t\tInit:function() {\n\t\t\t//getCurrentLocation();\n\t\t\t// $(\".station_search\").each(function() {\n\t\t\t// \t$(this).bind(\"keyup\",stationSearchKeyUpHandler);\n\t\t\t// });\n\t\t\t// $(\".planning button\").bind(\"click\",travelSearch);\n\t\t\t$(\".planning button\").bind(\"click\",enterSchedule);\n\t\t},\n\t\tgetLocation:function() {\n\t\t\tgetCurrentLocation();\n\t\t}\n\t}\n}();\n$(function() {\n\t// locationHandler.Init();\n\t$(\"body.search_station a\").bind(\"click\", function(e) {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t});\n})\n","var globalAdultPrice = 6.4;\nvar globalChildPrice = globalAdultPrice * 0.55;\n\tvar travellers = function() {\n\t\tvar children = 0;\n\t\tvar adults = 0;\n\t\tvar adultCounter = 0;\n\t\tvar childCounter = 0;\n\t\tvar adultCharacters = [\"img/gfx-passenger-male-2.svg\",\"img/gfx-passenger-female-1.svg\",\"img/gfx-passenger-male-1.svg\",\"img/gfx-passenger-male-3.svg\"];\n\t\tvar childCharacters = [\"img/gfx-passenger-child-1.svg\"];\n\t\tvar totalAmount = 1;\n\t\t\n\t\tfunction control(e) {\n\t\t\t// $(\".stage\").css(\"width\",\"auto\");\n\t\t\tvar target = e.target;\n\t\t\tvar value = -1;\n\t\t\tvar adultLabel = \"adults\";\n\t\t\tvar childLabel = \"children\";\n\n\t\t\te.preventDefault();\n\t\t\tcategory = e.target.parentNode.className;\n\t\t\tif (!$(\".travellers\").hasClass(\"activated\")) {\n\t\t\t\t$(\".travellers\").addClass(\"activated\");\n\t\t\t}\n\t\t\t\n\n\t\t\tif (e.target.innerHTML==\"+\") {\n\t\t\t\tvalue=1;\n\t\t\t\tif (category ==\"adults\") {\n\n\t\t\t\t\t\n\t\t\t\t\tif (totalAmount % 2) {\n\t\t\t\t\t\t$(\".travellers .stage\").append('<img src=\"'+adultCharacters[adultCounter]+'\" class=\"adult\">');\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t$(\".travellers .stage .adult:last\").addClass(\"added\");\n\t\t\t\t\t\t\tsetTimeout(function(elm) {\n\t\t\t\t\t\t\t\telm.addClass(\"inplace\");\n\t\t\t\t\t\t\t},900,$(\".travellers .stage .adult:last\"));\n\t\t\t\t\t\t},200);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(\".travellers .stage\").prepend('<img src=\"'+adultCharacters[adultCounter]+'\" class=\"adult\">');\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t$(\".travellers .stage .adult:first\").addClass(\"added\");\n\t\t\t\t\t\t\tsetTimeout(function(elm) {\n\t\t\t\t\t\t\t\telm.addClass(\"inplace\");\n\t\t\t\t\t\t\t},900,$(\".travellers .stage .adult:first\"));\n\t\t\t\t\t\t},200);\n\t\t\t\t\t}\n\t\t\t\t\tadultCounter++;\t\n\t\t\t\t} else {\n\t\t\t\t\t\n\t\t\t\t\tif (totalAmount % 2) {\n\t\t\t\t\t\t$(\".travellers .stage\").append('<img src=\"'+childCharacters[childCounter]+'\" class=\"child\">');\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t$(\".travellers .stage .child:last\").addClass(\"added\");\n\t\t\t\t\t\t\tsetTimeout(function(elm) {\n\t\t\t\t\t\t\t\telm.addClass(\"inplace\");\n\t\t\t\t\t\t\t},900,$(\".travellers .stage .child:last\"));\n\t\t\t\t\t\t},200);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(\".travellers .stage\").prepend('<img src=\"'+childCharacters[childCounter]+'\" class=\"child\">');\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t$(\".travellers .stage .child:first\").addClass(\"added\");\n\t\t\t\t\t\t\tsetTimeout(function(elm) {\n\t\t\t\t\t\t\t\telm.addClass(\"inplace\");\n\t\t\t\t\t\t\t},900,$(\".travellers .stage .child:first\"));\n\t\t\t\t\t\t},200);\n\t\t\t\t\t}\n\t\t\t\t\tchildCounter++;\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tvalue=-1;\t\t\t\n\t\t\t\tif (category ==\"adults\") {\n\t\t\t\t\tif (totalAmount % 2) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tsetTimeout(function(elm) {\n\t\t\t\t\t\t\telm.remove();\n\t\t\t\t\t\t},850,$(\".travellers .stage .adult.added\").filter(\":last\"));\n\t\t\t\t\t\t$(\".travellers .stage .adult.added\").filter(\":last\").removeClass(\"added\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\t\n\t\t\t\t\t\tsetTimeout(function(elm) {\n\t\t\t\t\t\t\telm.remove();\n\t\t\t\t\t\t},850,$(\".travellers .stage .adult.added\").filter(\":first\"))\n\t\t\t\t\t\t$(\".travellers .stage .adult.added\").filter(\":first\").removeClass(\"added\");\n\t\t\t\t\t}\n\t\t\t\t\tadultCounter--;\n\t\t\t\t} else {\n\t\t\t\t\tif (totalAmount % 2) {\n\t\t\t\t\t\tsetTimeout(function(elm) {\n\t\t\t\t\t\t\telm.remove();\n\t\t\t\t\t\t},850,$(\".travellers .stage .child.added\").filter(\":last\"));\n\t\t\t\t\t\t$(\".travellers .stage .child.added\").filter(\":last\").removeClass(\"added\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetTimeout(function(elm) {\n\t\t\t\t\t\t\telm.remove();\n\t\t\t\t\t\t},850,$(\".travellers .stage .child.added\").filter(\":first\"))\n\t\t\t\t\t\t$(\".travellers .stage .child.added\").filter(\":first\").removeClass(\"added\");\n\t\t\t\t\t}\n\t\t\t\t\tchildCounter--;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (adultCounter<0) adultCounter=0;\n\t\t\tif (childCounter<0) childCounter=0;\n\t\t\tif (adultCounter>=adultCharacters.length) adultCounter=0;\n\t\t\tif (childCounter>=childCharacters.length) childCounter=0;\n\t\t\tif (category ==\"adults\") {\n\t\t\t\tadults+=value;\n\t\t\t} else {\n\t\t\t\tchildren+=value;\n\t\t\t}\n\t\t\t\n\t\t\tif (adults<0) adults=0;\n\t\t\tif (children<0) children=0;\n\t\t\ttotalAmount = adults + children;\n\n\t\t\t$(\"input#adults\").val(adults);\n\t\t\t$(\"input#children\").val(children);\n\n\t\t\tif (adults==1) {\n\t\t\t\tadultLabel= \"adult\";\n\t\t\t} else {\n\t\t\t\tadultLabel=\"adults\";\n\t\t\t}\n\t\t\tif (children==1) {\n\t\t\t\tchildrenLabel=\"child\";\n\t\t\t} else {\n\t\t\t\tchildrenLabel=\"children\";\n\t\t\t}\n\t\t\tvar priceAdults = adults * globalAdultPrice;\n\t\t\tvar priceChildren = children * globalChildPrice;\n\t\t\tvar priceTotal = parseFloat(Math.round(10*(priceAdults+priceChildren))/10);\n\t\t\tconsole.log(adults, priceAdults);\n\t\t\t$(\"header.meta .price .amount, .controls .price .amount, header.itinerary_container .price .amount\").html(\"£\"+priceTotal.toFixed(2));\n\t\t\t$(\".planning button.buy .amount\").html(\"£\"+priceTotal.toFixed(2));\n\n\t\t\t$(\".travellers_info\").html(adults + \" \" + adultLabel +\", \"+ children + \" \"+ childrenLabel);\n\t\t\t$(\".schedule_container .passengers\").html(adults + \" \" + adultLabel +\", \"+ children + \" \"+ childrenLabel);\n\t\t\tlocalStorage.setItem(\"adults\",adults);\n\t\t\tlocalStorage.setItem(\"children\",children);\n\t\t\t$(\".travellers_button button .adults\").html(adults);\n\t\t\t$(\".travellers_button button .children\").html(children);\n\t\t\t\n\t\t}\n\t\tfunction scrollHandler(e) {\n\t\t\t\n\t\t\tif (document.body.scrollHeight-$(window).height()-$(window).scrollTop()<20) {\n\t\t\t\t$(\".sticky_info\").addClass(\"next\");\n\t\t\t} \n\t\t}\n\t\tfunction showRailcards() {\n\t\t\t$(\".railcards .choices\").css(\"height\",$(\".railcards .choices\")[0].scrollHeight);\n\t\t}\n\t\tfunction travellerToggle(e) {\n\t\t\t$(\".row.travellers\").toggleClass(\"visible\");\n\t\t}\n\t\tfunction detectFieldsCompleted(e) {\n\t\t\tif ($(\"#from\").val().length>0 && $(\"#to\").val().length>0) {\n\t\t\t\t$(\"body.planning\").addClass(\"full\");\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t$(\"body.planning > h2\").html(\"When do you want to travel?\");\n\t\t\t\t},400);\n\t\t\t} else {\n\t\t\t\t$(\"body.planning\").removeClass(\"full\");\n\t\t\t\t$(\"body.planning > h2\").html(\"Where do you want to go?\");\n\t\t\t}\n\t\t}\n\t\tfunction ticketHandler(e) {\n\t\t\tdocument.location.href='schedule.php';\n\t\t}\n\t\treturn {\n\t\t\tInit: function() {\n\t\t\t\t$(\".travellers_button button\").bind(\"click\",travellerToggle);\n\t\t\t\t$(\".travellers a\").bind(\"click\",control);\n\t\t\t\t$(\".travellers .adults a:last-child\").trigger(\"click\");\n\t\t\t\t$(\"body.planning .sticky_info\").bind(\"click\",ticketHandler);\n\t\t\t\t$(\".travellers .close-modal\").bind(\"click\",travellerToggle);\n\t\t\t\t$(\"body.planning input\").bind(\"keyup\",detectFieldsCompleted);\n\t\t\t\t$(\"body.planning input\").bind(\"click\",function() {\n\t\t\t\t\tsetTimeout(detectFieldsCompleted,100);\n\t\t\t\t});\n\t\t\t\t$(\".swap\").bind(\"click\",function(e) {\n\t\t\t\t\tvar tempTo = $(\"input#to\").val();\n\t\t\t\t\t$(\"input#to\").val($(\"input#from\").val());\n\t\t\t\t\t$(\"input#from\").val(tempTo);\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t});\n\t\t\t\t$(window).bind(\"scroll\",scrollHandler);\n\t\t\t\tscrollHandler();\n\t\t\t\t$(\".railcards .add\").bind(\"click\",showRailcards);\n\t\t\t}\n\t\t}\n\t}();\n$(function() {\n\ttravellers.Init();\n\t$(\"body.planning\").bind(\"touchstart\",eccentricGuy);\n\t$(\"body.planning .eccentric_route\").bind(\"touchstart\",function(e) {\n\t\te.stopPropagation();\n\t});\n\tvar referrer = document.referrer;\n\tif (typeof referrer!=\"undefined\") {\n\t\tif (referrer.indexOf('schedule.php')) {\n\t\t\twindow.scrollTo(0,0);\n\t\t}\n\t}\n\tfunction eccentricGuy(e) {\n\t\tconsole.log(e.target);\n\t\t$(\"body.planning\").unbind(\"touchstart\",eccentricGuy);\n\t\t$(\"img.eccentric_route\").addClass(\"out\");\n\t}\n});","\tvar schedule = function() {\n\t\tvar headerHeight = $(\".schedule .results .outbound header\").outerHeight() + $(\".schedule_container > header\").outerHeight();\n\t\tvar windowHeight = 0;\n\t\tvar scrollAnimation = new Object();\n\t\tvar peakTicketAddAdult = 4.1;\n\t\tvar peakTicketAddChild = 2.05;\n\t\tvar firstTicketAddAdult = 30;\n\t\tvar firstTicketAddChild = 15;\n\t\tvar priceAdults = 82;\n\t\tvar priceChildren = 43.1;\n\t\tvar priceTotal = 0;\n\t\tvar currentPrice = 0;\n\n\t\tvar priceStep1=0;\n\t\tvar priceStep2=0;\n\t\tvar priceStep3=0;\n\t\tvar priceStep4=0;\n\n\t\tscrollAnimation.kill = function() {\n\n\t\t}\n\t\tfunction control(e) {\n\t\t\t\n\t\t}\n\t\tfunction resizeHandler(e) {\n\t\t\twindowHeight = $(window).innerHeight();\n\t\t\t// headerHeight = $(\".schedule .results .selecting header\").outerHeight() + $(\".schedule_container > header\").outerHeight();\n\t\t\t// var matrix = $(\".schedule_container .results\").css(\"transform\").split(\", \");\n\t\t\tvar extraHeaderHeight = 0;\n\t\t\tvar headerheight = 0;\n\t\t\tvar headerMinHeight = 140;\n\t\t\t// headerHeight=parseInt(matrix[5]) + parseInt($(\".schedule_container .results\").css(\"top\"));\n\t\t\t$(\"body\").removeClass(\"final\");\n\t\t\t$(\".schedule header.itinerary_container\").removeClass(\"final\");\n\t\t\tif ($(window).innerWidth() < 751) {\n\n\t\t\t\tif (typeof e == \"undefined\") {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t// $(\"body\").scrollTop(0);\n\t\t\t\t\t\t$(\".schedule\").each(function() {\n\t\t\t\t\t\t\tscrollAnimation = TweenMax.to($(\"body\"), 1, {scrollTo:{y:0, x:0}, ease:Power2.easeInOut});\n\t\t\t\t\t\t});\n\t\t\t\t\t},400);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif ($(\"body\").hasClass(\"step1\")) {\n\t\t\t\t\t$(\"header.meta .page_title span\").html(\"Outbound train\");\n\t\t\t\t\textraHeaderHeight = $(\"header.outbound\").outerHeight();\n\t\t\t\t\theaderHeight =  headerMinHeight;\n\t\t\t\t} else if ($(\"body\").hasClass(\"step2\")) {\n\t\t\t\t\t$(\"header.meta .page_title span\").html(\"Return train\");\n\t\t\t\t\textraHeaderHeight = $(\"header.returning\").outerHeight();\n\t\t\t\t\theaderHeight = 95+headerMinHeight;\n\t\t\t\t} else if ($(\"body\").hasClass(\"step3\")) {\n\t\t\t\t\t$(\"header.meta .page_title span\").html(\"Ticket options\");\n\t\t\t\t\textraHeaderHeight = $(\"header.ticket_options \").outerHeight();\n\t\t\t\t\theaderHeight = 187+headerMinHeight;\n\t\t\t\t} else if ($(\"body\").hasClass(\"step4\")) {\n\t\t\t\t\t$(\"header.meta .page_title span\").html(\"Summary\");\n\n\t\t\t\t\textraHeaderHeight = 0;\n\t\t\t\t\theaderHeight =  520+headerMinHeight;\n\t\t\t\t\t\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t$(\".schedule\").addClass(\"final\");\n\t\t\t\t\t\t\n\t\t\t\t\t},400);\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\n\t\t\t\t\t\t$(\".page_title\").css(\"display\",\"block\");\n\t\t\t\t\t},800);\n\t\t\t\t}\n\n\t\t\t\t$(\".schedule header.itinerary_container\").css(\"max-height\",headerHeight);\n\t\t\t\t$(\".schedule div.itinerary_background\").css(\"transform\",\"translateY(-\"+($(\".schedule div.itinerary_background\").outerHeight() - (headerHeight+20))+\"px)\");\n\t\t\t\t$(\"header.table\").css(\"transform\",\"translateY(\"+(headerHeight+20)+\"px)\");\n\t\t\t\t$(\".schedule .results\").css(\"transform\",\"translateY(\"+((headerHeight-100)+extraHeaderHeight)+\"px)\");\n\t\t\t} else {\n\t\t\t\tif (!$(\"body\").hasClass(\"step4\")) {\n\t\t\t\t\textraHeaderHeight = $(\"header.outbound\").outerHeight();\n\t\t\t\t\theaderHeight =  120;\n\t\t\t\t\t$(\".schedule header.itinerary_container\").css(\"max-height\",headerHeight);\n\t\t\t\t\t$(\".schedule div.itinerary_background\").css(\"transform\",\"translateY(-\"+($(\".schedule div.itinerary_background\").outerHeight() - (headerHeight+90))+\"px)\");\n\t\t\t\t\t$(\"header.table\").css(\"transform\",\"translateY(\"+(headerHeight+90)+\"px)\");\n\t\t\t\t\t$(\".schedule .results\").css(\"transform\",\"translateY(\"+((headerHeight-100)+extraHeaderHeight)+\"px)\");\n\t\t\t\t} else {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t$(\".schedule\").addClass(\"final\");\n\t\t\t\t\t},400);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfunction scheduleStepHandler(e) {\n\t\t\tvar target = e.target;\n\t\t\tif (target.tagName != \"LI\") {\n\t\t\t\ttarget = target.parentNode;\n\t\t\t\tif (target.tagName != \"LI\") {\n\t\t\t\t\ttarget = target.parentNode;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar journeyData = target.journeyData;\n\t\t\tvar container = target.parentNode.parentNode;\n\t\t\tif (container.tagName == \"UL\") container = container.parentNode;\n\t\t\tvar activeClass = container.className;\n\t\t\tvar currentStep = $(container).index()+1;\n\t\t\tvar nextStep = currentStep + 1;\n\t\t\tif (nextStep==2 && localStorage.getObject(\"selected_returning\").cheapest_single) {\n\t\t\t\tcurrentStep=1;\n\t\t\t\tnextStep=3;\n\t\t\t}\n\t\t\t$(\"body\").removeClass(\"step\"+currentStep).addClass(\"step\"+nextStep);\n\t\t\t$(\"li\",$(target).parent().parent()).addClass(\"faded\");\n\t\t\tif (typeof journeyData != \"undefined\") {\n\t\t\t\tvar peak=$(target).parent().hasClass(\"peak\");\n\t\t\t\tvar peakLabel = \"Anytime, \"+formatDate(localStorage.getItem(activeClass));\n\t\t\t\tif (journeyData.cheap_rtn_1 || journeyData.cheap_rtn_2) {\n\t\t\t\t\tpeakLabel = \"Off-peak, \"+formatDate(localStorage.getItem(activeClass));\n\t\t\t\t}\n\t\t\t}\n\t\t\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tswitch (nextStep) {\n\t\t\t\tcase 2:\n\t\t\t\t\tlocalStorage.setObject(\"selected_outbound\",journeyData);\n\t\t\t\t\ttrainDirection = \"returning\";\n\t\t\t\t\tresetSlideHandler();\n\t\t\t\t\tpriceStep1 = calculatePrice(journeyData.cheapest_single);\n\t\t\t\t\tdataHandler(globalJSON,{ direction: trainDirection });\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tif (currentStep==2) {\n\t\t\t\t\t\tlocalStorage.setObject(\"selected_returning\",journeyData);\n\t\t\t\t\t\tconsole.log(\"switching\");\n\t\t\t\t\t\tpriceStep2 = calculatePrice(journeyData.cheapest_single);\n\t\t\t\t\t} else if (currentStep==1) {\n\t\t\t\t\t\tlocalStorage.setObject(\"selected_outbound\",journeyData);\n\t\t\t\t\t\ttrainDirection = \"returning\";\n\t\t\t\t\t\tpriceStep1 = calculatePrice(journeyData.cheapest_single);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tconsole.log($(\".price\",$(target)).html());\n\t\t\t\t\tvar myPrice = $(\".price\",$(target)).html();\n\t\t\t\t\t\n\t\t\t\t\tpriceStep3 = parseFloat(myPrice.replace(\"£\",\"\"));\n\t\t\t\t\tconsole.log(priceStep3);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar addedPrice = Math.round(10*(priceStep1 + priceStep2 + priceTotal))/10;\n\t\t\tif ($(\"radiogroup.carpark input[type=radio]:checked\").val()==\"yes\") {\n\t\t\t\tvar tempPrice = Math.round(10*(priceStep3+5))/10;\n\t\t\t\t$(\".pricetag.total\").html(\"£\"+tempPrice.toFixed(2));\n\t\t\t} else {\n\t\t\t\tvar tempPrice = Math.round(10*(priceStep3))/10;\n\t\t\t\t$(\".pricetag.total\").html(\"£\"+tempPrice.toFixed(2));\n\t\t\t}\n\t\t\tvar beforePrice= Math.round(10*(priceStep3))/10;\n\t\t\t$(\".itinerary .travel_list .price\").html(\"£\"+beforePrice.toFixed(2));\n\n\t\t\t$(\".itinerary div.\"+activeClass).next().html(peakLabel);\n\t\t\t$(\"datetime\",$(target)).first().each(function() {\n\t\t\t\t$(\".itinerary div.\"+activeClass+\" datetime\").first().html($(\"datetime\",$(target)).first().html());\n\t\t\t\t$(\".itinerary div.\"+activeClass+\" datetime\").last().html($(\"datetime\",$(target)).last().html());\n\t\t\t\t$(\".itinerary div.\"+activeClass+\" .changes\").html(journeyData.changes);\n\t\t\t});\n\n\t\t\tvar price = $(\".price\",$(target)).html().replace(\"+ £\",\"\");\n\t\t\tif (nextStep == 4) {\n\t\t\t\n\t\t\t\tvar ticket = $(\".name\",$(target)).html();\n\t\t\t\tvar price = $(\".price\",$(target)).html().replace(\"+ £\",\"\");\n\t\t\t\tif (ticket==\"Upgrade to first class\") ticket = $(\".name\",$(target)).prop(\"title\");\n\t\t\t\t$(\".ticket\").html(ticket);\n\t\t\t\t\n\t\t\t\tresizeHandler();\n\t\t\t\tstepAnimateFast(\".itinerary\");\n\t\t\t}\n\t\t\tresizeHandler();\n\t\t\tpeakHourHandler();\n\t\t}\n\t\tfunction peakHourHandler(e) {\n\t\t\t$(\"ul.travel_list .range\").each(function() {\n\t\t\t\tvar container =  $(this).parent().parent();\n\t\t\t\tif (container.css(\"pointer-events\")!=\"none\" && ($(this).offset().top - container.offset().top) < $(window).scrollTop()) {\n\t\t\t\t\t$(this).attr(\"data-showing\",true);\n\t\t\t\t\tif ($(this).next().attr(\"data-showing\")!=\"true\") {\n\t\t\t\t\t\t// $(\"header.\"+container[0].className+\" datetime .peakvalue\").html(this.title);\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$(this).attr(\"data-showing\",false);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t\tfunction carparkHandler(e) {\n\t\t\tif ($(\"radiogroup.carpark input[type=radio]:checked\").val()==\"yes\") {\n\t\t\t\t$(\".last-choices .pricetag.car\").html(\"£5.00\");\n\t\t\t\tvar tempPrice = Math.round(10*(priceStep3+5))/10;\n\t\t\t\t$(\".pricetag.total\").html(\"£\"+tempPrice.toFixed(2));\n\t\t\t} else {\n\t\t\t\tvar tempPrice = Math.round(10*(priceStep3))/10;\n\t\t\t\t$(\".last-choices .pricetag.car\").html(\"£0.00\");\n\t\t\t\t$(\".pricetag.total\").html(\"£\"+tempPrice.toFixed(2));\n\t\t\t}\n\t\t}\n\t\treturn {\n\n\t\t\tInit: function() {\n\t\t\t\tif ($(window).innerWidth()>750) {\n\t\t\t\t\t$(window).bind(\"resize\",resizeHandler);\n\t\t\t\t}\n\t\t\t\tvar adults = parseInt(localStorage.getItem(\"adults\"));\n\t\t\t\tvar children = parseInt(localStorage.getItem(\"children\"));\n\t\t\t\t\n\t\t\t\t// $(\"header.controls .amount\").html(\"£\"+priceTotal.toFixed(2));\n\t\t\t\t// $(\"button.buy .amount\").html(\"£\"+priceTotal.toFixed(2));\n\t\t\t\t// $(\".range.peak .price\").html(\"+ £\"+peakPriceDifference.toFixed(2));\n\t\t\t\t$(window).bind(\"mousewheel\",function(e) {\n\t\t\t\t\tscrollAnimation.kill();\n\t\t\t\t});\n\t\t\t\t$(window).bind(\"touchstart\",function(e) {\n\t\t\t\t\tscrollAnimation.kill();\n\t\t\t\t});\n\t\t\t\t$(window).bind(\"scroll\",peakHourHandler);\n\t\t\t\tpeakHourHandler();\n\t\t\t\tsetTimeout(peakHourHandler,200);\n\t\t\t\tsetTimeout(peakHourHandler,500);\n\t\t\t\tsetTimeout(peakHourHandler,1000);\n\n\t\t\t\t$(\"li .changes\").bind(\"click\",function(e) {\n\t\t\t\t\tenterJourneyScreen();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t});\t\t\n\t\t\t\t$(\"radiogroup.carpark input[type=radio]\").bind(\"change\",carparkHandler);\t\n\t\t\t\tresizeHandler();\n\n\t\t\t\t// going back controls\n\t\t\t\t$(\".schedule .itinerary_container .stations\").bind(\"click\",function(e) {\n \t\t\t\t\twindow.history.back();\n \t\t\t\t\te.preventDefault();\n \t\t\t\t\treturn false;\n\t\t\t\t});\n\t\t\t\t$(\".itinerary .outbound_train, .itinerary datetime.outbound, .itinerary div.outbound\").bind(\"click\",function() {\n\t\t\t\t\t$(\"body\").removeClass(\"step1 step2 step3 step4\");\n\t\t\t\t\t$(\"body\").addClass(\"step1\");\n\t\t\t\t\ttrainDirection = \"outbound\";\n\t\t\t\t\tsetSlideMinNow();\n\t\t\t\t\tupdatePriceList();\n\t\t\t\t\t$(\".outbound li, .returning li, .ticket_options li\").removeClass(\"faded\");\n\t\t\t\t\t$(\".schedule_container .opacityZero\").css(\"opacity\",0);\n\t\t\t\t\tresizeHandler();\n\t\t\t\t});\n\n\t\t\t\t$(\".itinerary .returning_train, .itinerary datetime.returning, .itinerary div.returning\").bind(\"click\",function(e) {\n\t\t\t\t\t$(\"body\").removeClass(\"step1 step2 step3 step4\");\n\t\t\t\t\t$(\"body\").addClass(\"step2\");\n\t\t\t\t\tupdatePriceList();\n\t\t\t\t\ttrainDirection = \"returning\";\n\t\t\t\t\t$(\".schedule_container .opacityZero\").css(\"opacity\",0);\n\t\t\t\t\t$(\".outbound li, .returning li, .ticket_options li\").removeClass(\"faded\");\n\t\t\t\t\tresizeHandler(e);\n\t\t\t\t});\n\n\t\t\t\t$(\"h3.ticket_total\").bind(\"click\",function() {\n\t\t\t\t\t$(\"body\").removeClass(\"step1 step2 step3 step4\");;\n\t\t\t\t\t$(\"body\").addClass(\"step3\");\n\t\t\t\t\t$(\".schedule_container .opacityZero\").css(\"opacity\",0);\n\t\t\t\t\t$(\".ticket_options li\").removeClass(\"faded\");\n\t\t\t\t\tresizeHandler();\n\t\t\t\t});\n\t\t\t\t$(\".last-choices button\").bind(\"click\",function() {\n\t\t\t\t\t$(\".last-choices .final_wrapper\").css(\"opacity\",0);\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t$(\".last-choices .final_wrapper\").css(\"display\",\"none\");\n\t\t\t\t\t\t$(\".ticket_information\").css(\"display\",\"block\").css(\"opacity\",0);\n\t\t\t\t\t\t$(window).scrollTop(0);\n\t\t\t\t\t\t$(\".last-choices\").scrollTop(0);\n\t\t\t\t\t\t$(\"body\").addClass(\"confirmation-page final\");\n\t\t\t\t\t\t$(\".page_title\").html(\"<span>Booking confirmation</span>\");\n\t\t\t\t\t\t$(\".confirmation-header\").addClass(\"active\");\n\t\t\t\t\t\t$(\".outbound_train, .itinerary datetime.outbound, .itinerary div.outbound, .returning_train, h3.ticket, .stations, .itinerary .returning_train, .itinerary datetime.returning, .itinerary div.returning\",$(\".schedule\")).addClass(\"final\").unbind(\"click\");\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t$(\".ticket_information\").css(\"opacity\",1);\n\t\t\t\t\t\t\t$(\".cards\").addClass(\"active\");\n\t\t\t\t\t\t},20);\n\n\t\t\t\t\t},200);\n\t\t\t\t});\n\t\t\t},\n\t\t\tsizeUp: function() {\n\t\t\t\tresizeHandler();\n\t\t\t},\n\t\t\tUpdate: function() {\n\t\t\t\t$(\".results li\").bind(\"click\",scheduleStepHandler);\n\t\t\t},\n\t\t\tScheduleStep: function(e) {\n\t\t\t\tscheduleStepHandler(e);\n\t\t\t}\n\t\t}\n\t}();\n$(function() {\n\t$(\"body.schedule\").each(function() {\n\t\tschedule.Init();\n\n\t\t$(\"div, header, ul\").bind(\"scroll\",function(e) {\n\t\t\tconsole.log(\"scrolling\",e.target);\n\t\t});\n\t\t\n\t\t$(\"header.outbound datetime\").html('<!--<span class=\"peakvalue\"></span>-->'+formatDate(localStorage.getItem(\"outbound\")));\n\t\t$(\"header.returning datetime\").html('<!--<span class=\"peakvalue\"></span>-->'+formatDate(localStorage.getItem(\"returning\")));\n\t\tvar adults = localStorage.getItem(\"adults\");\n\t\tvar children = localStorage.getItem(\"children\");\n\n\t\tif (adults==1) {\n\t\t\tadultLabel= \"adult\";\n\t\t} else {\n\t\t\tadultLabel=\"adults\";\n\t\t}\n\t\tif (children==1) {\n\t\t\tchildrenLabel=\"child\";\n\t\t} else {\n\t\t\tchildrenLabel=\"children\";\n\t\t}\n\n\t\t$(\"header .passengers\").html(adults + \" \" + adultLabel +\", \"+ children + \" \"+ childrenLabel);\n\t\t\n\t});\n\t\n});\nfunction formatDate(date) {\n\tvar date = new Date(date);\n\tvar months = [\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];\n\tvar days = [\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"];\n\t\n\tvar year = date.getYear()+1900;\n\tvar month = months[date.getMonth()];\n\tvar day = days[date.getDay()];\n\treturn day + \", \" + month + \" \" + nth(date.getDay());\n}\nfunction offerHandler(e) {\n\tconsole.log(e.target);\n\te.stopPropagation();\n\t$(\".swt_modal .train_message\").html($(\".offer_icon\",$(e.target)).html()+\"<h3>\"+$(\".header\",$(e.target)).html() + \"</h3>\" + \"<p>\"+$(\".offer_message p\",$(e.target)).html()+\"</p>\");\n\t$(\".swt_modal\").addClass(\"active trainmessage\");\n\t$(\"a.burger\").addClass(\"close-button\");\n}\nfunction nth(d) {\n  if(d>3 && d<21) return d+'th'; // thanks kennebec\n  switch (d % 10) {\n        case 1:  return d+\"st\";\n        case 2:  return d+\"nd\";\n        case 3:  return d+\"rd\";\n        default: return d+\"th\";\n    }\n} \n\t\n"],"sourceRoot":"/source/"}
(window._gsQueue||(window._gsQueue=[])).push(function(){_gsDefine("plugins.ScrollToPlugin",["plugins.TweenPlugin"],function(t){var o=function(o,s){t.call(this,"scrollTo"),this._overwriteProps.pop()},s=o.prototype=new t("scrollTo"),e=function(){return null!=window.pageXOffset?window.pageXOffset:null!=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft},i=function(){return null!=window.pageYOffset?window.pageYOffset:null!=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop},l=t.prototype.setRatio;return s.constructor=o,o.API=2,s._onInitTween=function(t,o,s){return this._wdw=t==window,this._target=t,"object"!=typeof o&&(o={y:Number(o)}),this.x=this._wdw?e():t.scrollLeft,this.y=this._wdw?i():t.scrollTop,null!=o.x?this._addTween(this,"x",this.x,o.x,"scrollTo_x",!0):this.skipX=!0,null!=o.y?this._addTween(this,"y",this.y,o.y,"scrollTo_y",!0):this.skipY=!0,!0},s._kill=function(o){return o.scrollTo_x&&(this.skipX=!0),o.scrollTo_x&&(this.skipY=!0),t.prototype._kill.call(this,o)},s.setRatio=function(t){l.call(this,t),this._wdw?window.scrollTo(this.skipX?e():this.x,this.skipY?i():this.y):(this.skipY||(this._target.scrollTop=this.y),this.skipX||(this._target.scrollLeft=this.x))},t.activate([o]),o},!0)}),window._gsDefine&&_gsQueue.pop()();
function enterLocating(){$(".screen").removeClass("active"),$(".locating").css("display","block").css("opacity",1).addClass("active"),stepAnimate(".locating"),setTimeout(function(){$(".route_container").addClass("on")},300),setTimeout(function(){$(".route_vertical .first-line").addClass("on"),$(".route_vertical .blue-circle").filter(":first").addClass("on"),$(".route_vertical .first_station").addClass("on")},1500),setTimeout(function(){$(".route_vertical .second-line").addClass("on"),$(".route_vertical .change-stop").addClass("on"),$(".route_vertical .change_station").addClass("on")},2500),setTimeout(function(){$(".route_vertical .blue-circle").filter(":last").addClass("on"),$(".route_vertical .last_station").addClass("on"),$(".route_vertical .last_station small").addClass("blink")},3800),setTimeout(function(){$(".route_vertical .third-line").addClass("on")},4e3),setTimeout(function(){$(".route_vertical .fourth-line").addClass("on")},4800),setTimeout(function(){enterHomeScreen()},7500),setTimeout(function(){$(".locating.screen").css("opacity",0),$(".locating.screen").removeClass("active")},7500)}function closeDestinationScreen(){$(".remove").animate({opacity:0},200),$(".search_1 .people").css("transition-duration","0.6s").css("transition-timing-function","cubic-bezier(.73,0,1,.46)").css("transform","translateY(800px)"),setTimeout(function(){$(".search_1 .background").css("transition-duration","0.6s").css("transition-timing-function","cubic-bezier(.73,0,1,.46)").css("transform","translateY(800px)")},100),setTimeout(function(){$(".search_1").animate({opacity:0},300)},300),setTimeout(function(){$(".search_station").animate({opacity:0},300)},600),setTimeout(function(){$(".search_station").css("display","none")},900)}function closeHomeScreen(){$(".cards").removeClass("active"),$(".get_tickets").css("opacity",0),$("div.changes").css("opacity",0),$(".screen.home .top").css("transition-duration","1s").css("transition-timing-function","cubic-bezier(.73,0,1,.46)").css("transform","translateY(-500px)").css("opacity",0),$(".screen.home .bottom").css("transition-duration","1s").css("transition-timing-function","cubic-bezier(.73,0,1,.46)").css("transform","translateY(500px)").css("opacity",0),setTimeout(function(){$(".screen.home").css("display","none")},1200)}function enterHomeScreen(e){lastActiveScreen="home",$(".screen").removeClass("active"),$(".screen.home").addClass("active"),$(".screen.home .opacityZero").each(function(e,t){setTimeout(function(e){$(e).animate({opacity:1},300)},270*e,t)}),"undefined"==typeof e&&(e=1200),setTimeout(function(){$(".screen.home").css("opacity",0).css("display","block").animate({opacity:1},300),$(".home div.changes").css("opacity",1),setTimeout(function(){$(".cards").addClass("active")},500),first&&(clock_slider.Init($(".clock_slider").eq(0),0),first=!1)},e)}function enterJourneyScreen(){$(".burger img").attr("src","img/icon-menu-close.svg"),$(".home div.changes").css("opacity",0),$(".journey .opacityZero").each(function(e,t){setTimeout(function(e){$(e).animate({opacity:1},300)},270*e+500,t)}),$(".journey").css("display","block").animate({opacity:1},300).addClass("active"),$(".journey.screen").scrollTop(($(".journey.screen")[0].scrollHeight-$(window).height())/2),$(".journey ul li:nth-child(4)").addClass("travel"),$(".journey ul .current_status").addClass("travel"),$(".burger").unbind(),$(".burger").bind("click",function(){if("home"==lastActiveScreen){var e=(new Date).getTime();console.log($(this).attr("data-started"),e),closeJourneyScreen(),enterHomeScreen(0),setTimeout(function(){$(".screen.home .top").css("transition-duration","1s").css("transition-timing-function","cubic-bezier(0,.91,.12,.99)"),$(".screen.home .bottom").css("transition-duration","1s").css("transition-timing-function","cubic-bezier(0,.91,.12,.99)")},100),setTimeout(function(){$(".screen.home .top").css("transform","translateY(0)").css("opacity",1),$(".screen.home .bottom").css("transform","translateY(0)").css("opacity",1)},110)}else"planning"==lastActiveScreen&&closeJourneyScreen();$(".burger").unbind(),$(".burger").bind("click",function(){closeWhatEver(),setTimeout(enterHomeScreen,300)})})}function closeWhatEver(){closeDestinationScreen(),$(".screen.home .top").css("transform","translateY(0)").css("opacity",1),$(".screen.home .bottom").css("transform","translateY(0)").css("opacity",1),$(".screen").removeClass("active"),$(".screen").css("opacity",0),$(".ticket_information").css("display","none").css("opacity",0),$(".last-choices").css("display","block").css("opacity",1),setTimeout(function(){$(".screen").css("display","none")})}function closeJourneyScreen(){$(".burger img").attr("src","img/bg-burger.svg"),$(".travel").removeClass("travel"),$(".journey").css("opacity",0),setTimeout(function(){$(".journey").css("display","none")},300)}function stepAnimate(e){$(".opacityZero",$(e)).each(function(e,t){setTimeout(function(e){$(e).animate({opacity:1},300)},270*e+500,t)})}function stepAnimateFast(e){$(".opacityZero",$(e)).each(function(e,t){setTimeout(function(e){$(e).css("opacity",1)},270*e,t)})}function enterPlanning(){lastActiveScreen="planning",$(".planning.screen").css("opacity",0),$(".planning.screen").css("display","block"),$(".screen.planning").animate({opacity:1},300),stepAnimate(".planning.screen")}function enterSchedule(){setTimeout(schedule.sizeUp,1e3),$(".screen.planning").animate({opacity:0},300),setTimeout(function(){$(".screen.schedule .faded").removeClass("faded"),$(".screen.planning").css("display","none"),$(".screen.schedule").css("display","block").animate({opacity:1},300),$(".screen.schedule .schedule_container").removeClass("step1 step2 step3 step4 step5"),$(".screen.schedule .schedule_container").addClass("step1")},300)}function closeSchedule(){$(".screen.schedule").animate({opacity:0},300),setTimeout(function(){$(".screen.schedule .schedule_container").removeClass("step1 step2 step3 step4"),$(".screen.schedule").css("display","none")},300)}var lastActiveScreen="home";$(function(){function e(){stepAnimate(".search_station"),$(".search_1 .background").css("transition-duration","0s").css("transition-timing-function","ease").css("transform","translateY(-20px)"),$(".search_1 .people").css("transition-duration","0s").css("transition-timing-function","ease").css("transform","translateY(5px)"),setTimeout(function(){$(".search_1 .background").css("transition-duration","2s"),$(".search_1 .people").css("transition-duration","2s")},100),$(".station_info").css("display","none"),$(".search_1, .search_1 .gfx").css("display","block"),setTimeout(function(){$(".search_1").css("opacity",1)},100),setTimeout(function(){$(".screen.search_station").css("opacity",0).css("display","block").animate({opacity:1},300),$(".search_1 .gfx").css("opacity",1),$(".search_1").css("transform","translateY(0px)")},200),setTimeout(function(){$(".search_station .results").css("transform","translateY(0px)")},350)}function t(){$(".home .info").each(function(){var e=$(this);$("span",e).length>1&&($("span:first-child",e).css("transition-duration","0.5s").css("transform","translateY(-42px)"),$("span:last-child",e).css("transition-duration","0.5s").css("transform","translateY(-42px)"),setTimeout(function(){$("span:last-child",e).prependTo(e),$("span:first-child",e).css("transition-duration","0s").css("transform","translateY(0px)"),$("span:last-child",e).css("transition-duration","0s").css("transform","translateY(0px)")},500))}),setTimeout(t,7e3)}$(".controls").css("opacity",1),$(".burger").bind("touchstart mousedown",function(){var e=(new Date).getTime();$(this).attr("data-started",e)}),$(".burger").bind("click",function(){(new Date).getTime();closeWhatEver(),setTimeout(enterHomeScreen,300)}),e(),$(".home.screen div.changes").bind("touchstart",function(){closeHomeScreen(),setTimeout(function(){enterJourneyScreen()},700)}),$(".home.screen .get_tickets button").bind("click",function(){closeHomeScreen(),setTimeout(function(){enterPlanning()},1200)}),setTimeout(t,7e3)}),first=!0;
$(function(){function a(a){$(".schedule .card").bind("touchend",n),t=a.originalEvent.changedTouches[0].clientY,console.log("touch start",t)}function n(a){var n=a.originalEvent.changedTouches[0].clientY;Math.abs(t-n)>20&&(0>t-n?$(this).parent().removeClass("open"):$(this).parent().addClass("open"))}function e(){$($card).fadeOut(),$(".journey .message_2").fadeIn(),$(".journey .card img").attr("src","img/gfx_hand.svg");var a=clock_slider.activeBucket(),n=$(".bottomslider span.time").eq(a).html(),e=n.split(":"),t=parseInt(e[0]),s=parseInt(e[1]);s+=22,s>=60&&(s-=60,t+=1),$(".info").animate({opacity:0},0);var r='<span class="delay">Running behind</span>',i='<span class="platform">Platform 12</span><span class="delay">Exp '+pad(t,2)+":"+pad(s,2)+"</span>";$(".info.depart").html(r),$(".info.arrive").html(i),$(".info").animate({opacity:1},200)}var t=0;$(".journey .card").bind("touchstart",function(a){$card=$(a.target),$card.hasClass("message_1")?e():$(this).parent().hasClass("open")?$(this).parent().removeClass("open"):$(this).parent().addClass("open")}),$(".schedule .card").bind("touchstart",a)});
function parentHasClass(e,t){return e.className.indexOf(t)<0?e!=document.body?parentHasClass(e.parentNode,t):!1:!0}function pad(e,t,n){return n=n||"0",e+="",e.length>=t?e:new Array(t-e.length+1).join(n)+e}var currentTime,clock_slider=function(){function e(e,t,n,a){var r,s;l=e,$bucket=$(".options time",$(".clock_slider").eq(0)).eq(l);var i=$bucket.attr("data-message"),o=$bucket.attr("datetime")+" ",o=o.trim().replace(" ","T"),o=new Date(o),u=new Date;o.setHours(o.getHours()-1),$(".journey .plan li").each(function(e,t){var n=new Date(o.getTime()+6e4*parseInt($(this).attr("data-distance"))),a=pad(n.getHours(),2)+":"+pad(n.getMinutes(),2);4>e&&u>o?$(this).addClass("passed"):$(this).removeClass("passed"),$("strong",$(this)).html(a)}),u>o?$(".current_status").css("display","block"):$(".current_status").css("display","none");var u=new Date;c>e?(r='<span class="journey_link">Running on time</span>',s='<span class="platform">Platform 4: Train to Lymington Town</span><span class="delay">45min</span>'):e==c?(r='<span class="platform">Platform 15: Train to Lymington Town</span><span class="delay">1h 45min</span>',s='<span class="delay">1h 45min</span>'):(r='<span class="delay">Exp on time</span>',s='<span class="delay">1h 45min</span>'),t?(t>.7&&(t=.7),$(".options",n).css("transition","all "+t+"s ease-out")):$(".options",n).css("transition","all 0s cubic-bezier(.6,.0,.4,1)");var p=0-e*$(".clock_slider .options time").width();$(".options",n).css("transform","translateX("+(p+(h/2-$("time.bucket").width()/2))+"px)"),$(".info").animate({opacity:0},200),setTimeout(function(e){e?($(".info.depart").html(r),$(".info.arrive").html(s)):($(".info.depart").html(r),$(".info.arrive").html(s)),$(".info").animate({opacity:1},200)},350,i)}function t(e){var t=$(e.target.parentNode.parentNode.parentNode.parentNode);scrollBucket=t,$(".clock_slider").removeClass("active"),t.addClass("active"),m=scrollBucket.scrollTop,d=0;(new Date).getTime()-i;$(".options",t).bind("touchend",a),$(".options",t).bind("touchmove",n);var r=$(".options",t).css("transform").toString().replace("matrix(","").replace(")","").split(",");u.touchOffsetX=parseInt(r[4].trim()),u.x=e.originalEvent.touches[0].clientX,i=(new Date).getTime()}function n(e){var t=$(e.target.parentNode.parentNode.parentNode.parentNode);clearTimeout(o);var n=$(".options",t).css("transform").toString().replace("matrix(","").replace(")","").split(",");p.x=e.originalEvent.touches[0].clientX,p.touchOffsetX=parseInt(n[4].trim()),d=u.x-p.x;var a=((new Date).getTime()-i,-1*(u.x-p.x-u.touchOffsetX));$(".options",t).css("transition-duration","0s").css("transform","translateX("+a+"px)")}function a(t){var r=$(t.target.parentNode.parentNode.parentNode.parentNode);clearTimeout(o),$(".options",r).css("transition-duration","0.4s").unbind("touchmove",n).unbind("touchend",a);var s=(new Date).getTime()-i,c=u.x-p.x,m=Math.round(c/$(".options time",r).width());m=l+m,0>m&&(m=0);var h=Math.abs(s/d);.2>h&&(h=.2),e(m,h)}function r(e){var t=new Date,n=t.getHours(),a=t.getMinutes();m_rounded=5*Math.ceil(a/5),60==m_rounded&&(m_rounded=0,n+=1),m_rounded+=5;var r=(pad(n,2)+":"+pad(m_rounded,2),0);return $(".options time span",$(e)).each(function(e,t){return thisHour=parseInt($(this).html().substring(0,2)),thisMinute=parseInt($(this).html().substring(3,5)),thisHour==n&&thisMinute>=m_rounded||thisHour>n?(r=e,!1):void 0}),r}function s(e){function t(e){try{var t=Math.abs(h/2-(e.getBoundingClientRect().left+e.getBoundingClientRect().width/2))}catch(n){}return t}try{var n=document.querySelector(e),a=document.elementFromPoint(h/2,n.getBoundingClientRect().top+5).parentNode;if("undefined"!=typeof a&&"TIME"==a.tagName){var r=new Array;r.push(a),r.push(a.parentNode.previousSibling.firstChild),r.push(a.parentNode.nextSibling.firstChild);for(object in r)"undefined"!=r[object]&&(centerMeasure=-1*t(r[object]),centerMeasure!=n.centerMeasure&&(spanTime=r[object].firstChild,r[object].centerMeasure=centerMeasure,centerScale=Math.abs(centerMeasure.map(-100,0,1,1.6)),centerOpacity=centerMeasure.map(-180,0,.3,1),spanTime.getAttribute("data-centerscale")!=centerScale&&(centerScale<1&&(centerScale=1),spanTime.setAttribute("data-centerscale",centerScale),$(spanTime).css("transform","scale("+centerScale+","+centerScale+")").css("opacity",centerOpacity))))}}catch(s){}}var i,o,c,l=0,u=new Object,p=new Object,d=0,m=0,h=$(window).width();return Number.prototype.map=function(e,t,n,a){return(this-e)*(a-n)/(t-e)+n},{draw:function(){s(".topslider"),s(".bottomslider"),setTimeout(clock_slider.draw,10)},Init:function(n,a){var s=r(n);c=s,$(".options",$(".clock_slider")).bind("touchstart",t),e(s,!1,$(".clock_slider").eq(0)),e(s,!1,$(".clock_slider").eq(1)),$(".clock_slider").each(function(){$(this)[0].fromTop=$(this).offset().top}),clock_slider.draw()},activeBucket:function(){return l}}}();
var keyboardTimeout,searchTimeout;$(function(){function t(t){clearTimeout(keyboardTimeout);var n=$("input.station").val();""==n&&(n="a"),$("#fontTest").html("<span>"+n+"_</span>"),$("#fontTest").delay(20).textfill({maxFontPixels:80}),$("input.station").css("font-size",$("#fontTest span").css("font-size")),e(n)}function e(t){$("ul.list").html('<li><span class="searching"></span></li>'),clearTimeout(searchTimeout),searchTimeout=setTimeout(function(){$("ul.list").css("opacity",0).html('<li style="opacity:0" class="clickaction">Milford on Sea</li><li style="opacity:0" class="remove" class="clickaction">Milton, Cambs.</li>'),$("ul.list").animate({opacity:1},300),$("ul.list li").each(function(t,e){setTimeout(function(t){$(t).animate({opacity:1},300)},200*t+200,e)}).bind("click",function(){closeDestinationScreen(),setTimeout(function(){enterLocating()},1600)})},1e3),keyboardTimeout=setTimeout(n,1500)}function n(){$("input.station").blur()}function i(t,e){if($(e).val().length>0){var n=new Date,i=new Date($(e).val()),o=i.getTimezoneOffset(),s="",l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if("outbound"==$(e).attr("id")){var u=new Date($("#return").val());document.getElementById("return").min=$(e).val(),i>u?(document.getElementById("return").value="",$("#return").next().val("")):0==$("#return").next().val().length&&$("#return").attr("value",$(e).val())}i.setMinutes(i.getMinutes()+o),s=i.getDate()==n.getDate()&&i.getMonth()==n.getMonth()&&i.getYear()==n.getYear()?"Today":l[i.getMonth()]+" "+i.getDate(),$(t).val(s+" "+a(i.getHours(),2)+":"+a(i.getMinutes(),2))}}function a(t,e){return Array(Math.max(e-String(t).length+1,0)).join(0)+t}var o=document.createElement("div");o.id="fontTest",o.style.width="calc(100% - 60px)",o.style.height="100px",o.style.whiteSpace="nowrap",o.innerHTML="<span></span>",document.body.appendChild(o),$(o).css("-webkit-transform","translateY(-3000px)"),$(o).textfill({maxFontPixels:80}),$("input.station").bind("keyup",t),$("#return").bind("focus",function(){$(".extra").addClass("open"),console.log("first "+window.innerHeight),setTimeout(function(){$(".extra").css("top",$(window).scrollTop()),console.log("second "+window.outerHeight,$(window).scrollTop())},300)}),$("#return").bind("blur",function(){$(".extra").removeClass("open")}),$("input[type=datetime-local]").bind("change",function(){i($(this).next()[0],this)}).bind("blur",function(){console.log("hey"),$(this).next().focus().blur()}),$(".planning radiogroup input[type=radio]").bind("touchstart click",function(){switch($(this).prop("checked",!0),$("input[type=radio]:checked",$(this).parent()).attr("value")){case"single":$(".dates").removeClass("double");break;case"return":"Open"==$(".return input[type=text]").val()&&$(".return input[type=text]").val(""),i($(".return input[type=text]"),$(".return input[type=datetime-local]")),$(".dates").addClass("double");break;case"open-return":$(".dates").addClass("double"),$(".return input[type=text]").val("Open")}})});
!function(t,e,n){"use strict";function o(t,e,n,o,i){return Math.abs(t-n)<i&&Math.abs(e-o)<i}if(e.navigator.userAgent.match(/(iPhone|iPad|iPod)/)){var i={TOUCH_MOVE_THRESHHOLD:10,PRESSED_CLASS:"pressed",GHOST_CLICK_TIMEOUT:500,GHOST_CLICK_THRESHOLD:10},a=[];n.addEventListener("click",function(t){for(var e=0;e<a.length;e++)if(o(a[e][0],a[e][1],t.clientX,t.clientY,i.GHOST_CLICK_THRESHOLD))return t.preventDefault(),void t.stopPropagation()},!0),t(n).on("touchstart",".no_delay_button",function(e){var a=t(this);a.css("webkitTapHighlightColor","rgba(0,0,0,0)"),a.addClass(i.PRESSED_CLASS);var c=e.originalEvent.touches[0],s=[c.clientX,c.clientY];this.__eventLocation=s,this.__onTouchMove=function(t){var e=t.originalEvent.touches[0];o(e.clientX,e.clientY,s[0],s[1],i.TOUCH_MOVE_THRESHHOLD)?a.addClass(i.PRESSED_CLASS):a.removeClass(i.PRESSED_CLASS)},t(n.body).on("touchmove",this.__onTouchMove)}),t(n).on("touchcancel",".no_delay_button",function(){var e=t(this);e.removeClass(i.PRESSED_CLASS),t(n.body).off("touchmove",this.__onTouchMove)}),t(n).on("touchend",".no_delay_button",function(c){var s=t(this);if(s.hasClass(i.PRESSED_CLASS)){s.removeClass(i.PRESSED_CLASS);var u=this.__eventLocation;if(u){var _=c.originalEvent.changedTouches[0];if(!o(_.clientX,_.clientY,u[0],u[1],i.TOUCH_MOVE_THRESHHOLD))return;setTimeout(function(){var t=n.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,e,0,0,0,0,0,!1,!1,!1,!1,0,null),s.get(0).dispatchEvent(t)},1),c.preventDefault();var r=[_.clientX,_.clientY];a.push(r),e.setTimeout(function(){var t=a.indexOf(r);t>=0&&a.splice(t,1)},i.GHOST_CLICK_TIMEOUT)}}t(n.body).off("touchmove",this.__onTouchMove)})}}(jQuery,window,document);
var locationHandler=function(){function n(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(o)}function o(n){t=n,console.log(t)}var t;return{Init:function(){$(".planning button").bind("click",enterSchedule)},getLocation:function(){n()}}}();$(function(){});
var schedule=function(){function e(e){i=$(window).innerHeight();var s=0;console.log("resizing",t),$(".schedule_container").hasClass("step1")?(s=$(".outbound header").outerHeight(),t=parseInt($(".schedule_container .results").css("top"))+5,$(".outbound ul").css("height",i-(t+s))):$(".schedule_container").hasClass("step2")?(s=$(".returning header").outerHeight(),t=parseInt($(".schedule_container .results").css("top"))+95,$(".returning ul").css("height",i-(t+s))):$(".schedule_container").hasClass("step3")?(s=$(".ticket_options header").outerHeight(),t=parseInt($(".schedule_container .results").css("top"))+182,$(".ticket_options ul").css("height",i-(t+s))):$(".schedule_container").hasClass("step4")&&(s=0,t=parseInt($(".schedule_container .results").css("top"))+520,$(".schedule_container header").css("max-height",i)),$(".outbound ul, .returning ul, .ticket_options ul").css("height",i-(t+s))}var t=$(".schedule .results .outbound header").outerHeight()+$(".schedule_container > header").outerHeight(),i=0;return{Init:function(){$(window).bind("resize",e),$("li .changes").bind("click",function(e){return enterJourneyScreen(),e.preventDefault(),e.stopPropagation(),!1}),$(".outbound li").bind("click",function(){$(this).siblings().addClass("faded"),$(".itinerary .outbound datetime").first().html($("datetime",$(this)).first().html()),$(".itinerary .outbound datetime").last().html($("datetime",$(this)).last().html()),$(".schedule_container").removeClass("step1 step2 step3 step4"),$(".schedule_container").addClass("step2"),e()}),$(".returning li").bind("click",function(){$(this).siblings().addClass("faded"),$(".schedule_container").removeClass("step1 step2 step3 step4"),$(".schedule_container").addClass("step3"),$(".itinerary .returning datetime").first().html($("datetime",$(this)).first().html()),$(".itinerary .returning datetime").last().html($("datetime",$(this)).last().html()),e()}),$(".ticket_options li").bind("click",function(){if($(this).siblings().addClass("faded"),$(".schedule_container").removeClass("step2").removeClass("step3").removeClass("step4"),$(".schedule_container").addClass("step4"),$(this).hasClass("upgrade"))var t=$(".name",$(this).prev()).html()+" First";else var t=$(".name",$(this)).html();var i=$(".price",$(this)).html();$(".itinerary .ticket").html(t),$(".itinerary .price").html(i),e(),stepAnimateFast(".schedule_container")}),$(".schedule .stations").bind("click",function(e){$(".schedule_container").removeClass("step2").removeClass("step3").removeClass("step4"),$(".outbound li, .returning li, .ticket_options li").removeClass("faded"),$(".schedule_container .opacityZero").css("opacity",0),closeSchedule(),setTimeout(function(){enterPlanning()},1200),e.preventDefault()}),$(".itinerary .outbound_train, .itinerary datetime.outbound, .itinerary div.outbound").bind("click",function(){$(".schedule_container").removeClass("step1 step2 step3 step4"),$(".schedule_container").addClass("step1"),$(".outbound li, .returning li, .ticket_options li").removeClass("faded"),$(".schedule_container .opacityZero").css("opacity",0),e()}),$(".itinerary .returning_train, .itinerary datetime.returning, .itinerary div.returning").bind("click",function(){$(".schedule_container").removeClass("step1 step2 step3 step4"),$(".schedule_container").addClass("step2"),$(".schedule_container .opacityZero").css("opacity",0),$(".outbound li, .returning li, .ticket_options li").removeClass("faded"),setTimeout(function(){},300),e()}),$("h3.ticket").bind("click",function(){$(".schedule_container").removeClass("step1 step2 step3 step4"),$(".schedule_container").addClass("step3"),$(".schedule_container .opacityZero").css("opacity",0),$(".ticket_options li").removeClass("faded"),setTimeout(function(){},300),e()}),$(".last-choices button").bind("click",function(){$(".last-choices").css("opacity",0),setTimeout(function(){$(".last-choices").css("display","none"),$(".ticket_information").css("display","block"),$(".outbound_train, .itinerary datetime.outbound, .itinerary div.outbound, .returning_train, h3.ticket, .stations, .itinerary .returning_train, .itinerary datetime.returning, .itinerary div.returning",$(".schedule")).addClass("final").unbind("click"),setTimeout(function(){$(".ticket_information").css("opacity",1),$(".cards").addClass("active")},20)},200)})},sizeUp:function(){e()}}}();$(function(){schedule.Init(),$("div, header, ul").bind("scroll",function(e){console.log("scrolling",e.target)})});
var travellers=function(){function e(e){$(".stage").css("width","auto");var a=(e.target,-1),c="adults";e.preventDefault(),category=e.target.parentNode.className,$(".travellers").hasClass("activated")||($(".travellers").addClass("activated"),TweenLite.to($(".planning"),1,{scrollTo:{y:$(".travellers").offset().top,x:0},ease:Power2.easeInOut})),"+"==e.target.innerHTML?(a=1,"adults"==category?(n%2?($(".travellers .stage").append('<img src="'+d[l]+'" class="adult">'),setTimeout(function(){$(".travellers .stage .adult:last").addClass("added"),setTimeout(function(e){e.addClass("inplace")},900,$(".travellers .stage .adult:last"))},200)):($(".travellers .stage").prepend('<img src="'+d[l]+'" class="adult">'),setTimeout(function(){$(".travellers .stage .adult:first").addClass("added"),setTimeout(function(e){e.addClass("inplace")},900,$(".travellers .stage .adult:first"))},200)),l++):(n%2?($(".travellers .stage").append('<img src="'+i[r]+'" class="child">'),setTimeout(function(){$(".travellers .stage .child:last").addClass("added"),setTimeout(function(e){e.addClass("inplace")},900,$(".travellers .stage .child:last"))},200)):($(".travellers .stage").prepend('<img src="'+i[r]+'" class="child">'),setTimeout(function(){$(".travellers .stage .child:first").addClass("added"),setTimeout(function(e){e.addClass("inplace")},900,$(".travellers .stage .child:first"))},200)),r++)):(a=-1,"adults"==category?(n%2?(setTimeout(function(e){e.remove()},850,$(".travellers .stage .adult.added").filter(":last")),$(".travellers .stage .adult.added").filter(":last").removeClass("added")):(setTimeout(function(e){e.remove()},850,$(".travellers .stage .adult.added").filter(":first")),$(".travellers .stage .adult.added").filter(":first").removeClass("added")),l--):(n%2?(setTimeout(function(e){e.remove()},850,$(".travellers .stage .child.added").filter(":last")),$(".travellers .stage .child.added").filter(":last").removeClass("added")):(setTimeout(function(e){e.remove()},850,$(".travellers .stage .child.added").filter(":first")),$(".travellers .stage .child.added").filter(":first").removeClass("added")),r--)),0>l&&(l=0),0>r&&(r=0),l>=d.length&&(l=0),r>=i.length&&(r=0),"adults"==category?s+=a:t+=a,0>s&&(s=0),0>t&&(t=0),n=s+t,$("input#adults").val(s),$("input#children").val(t),c=1==s?"adult":"adults",childrenLabel=1==t?"child":"children",$(".travellers_info").html(s+" "+c+", "+t+" "+childrenLabel),$(".schedule_container .passengers").html(s+" "+c+", "+t+" "+childrenLabel)}function a(){$(".railcards .choices").css("height",$(".railcards .choices")[0].scrollHeight)}var t=0,s=0,l=0,r=0,d=["img/gfx-passenger-male-2.svg","img/gfx-passenger-female-1.svg","img/gfx-passenger-male-1.svg","img/gfx-passenger-male-3.svg"],i=["img/gfx-passenger-child-1.svg"],n=1;return{Init:function(){$(".travellers a").bind("touchstart click",e),$(".swap").bind("click",function(){var e=$("input#to").val();$("input#to").val($("input#from").val()),$("input#from").val(e)}),$(".railcards .add").bind("click",a)}}}();$(function(){travellers.Init()});
//# sourceMappingURL=site.js.map
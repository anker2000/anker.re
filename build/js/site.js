function addProject(e,a){function t(){r.screenWidth=screenWidthFromDistance(camera.position.z),console.log(r.screenWidth)}var s=new THREE.Group,r={};$(window).bind("resize",t),t();var o=new THREE.JSONLoader,n=new THREE.MeshBasicMaterial({color:16777215}),l=$(e).find("video")[0],m=new THREE.VideoTexture(l);m.minFilter=THREE.LinearFilter,m.magFilter=THREE.LinearFilter,m.format=THREE.RGBFormat,m.wrapS=THREE.ClampToEdgeWrapping,m.wrapT=THREE.ClampToEdgeWrapping,n.map=m;var d=new THREE.MeshPhongMaterial({color:16777215});d.specular.r=1,d.specular.g=1,d.specular.b=1,d.transparent=!0,d.opacity=.1,d.shininess=10;var c=hexToRgb($(e).data("device-light")),p=hexToRgb($(e).data("device-dark"));if(console.log(c.r,p),$(e).hasClass("mobile")){var E=new THREE.Group,w=new THREE.PlaneGeometry(.55,.983,1),h=new THREE.Mesh(w,n);h.receiveShadow=!1,h.position.z=.0292,h.position.y=.05,h.receiveShadow=!1,h.position.z=.0292,h.position.y=.05,E.add(h);var u=new THREE.Mesh(w,d);u.receiveShadow=!0,u.position.z=.0293,u.position.y=.05,u.transparent=!0,o.load("models/phone.json",function(e,a){var t=new THREE.MultiMaterial(a),s=new THREE.Mesh(e,t);s.position.y=-.6,s.castShadow=!0,s.traverse(function(e){for(E.position.y=-5,E.position.z=-1,i=0;i<s.material.materials.length;i++){s.material.materials[i].side=2,s.material.materials[i].specular.r=p.r/255,s.material.materials[i].specular.g=p.g/255,s.material.materials[i].specular.b=p.b/255,s.material.materials[i].emissive.r=c.r/255,s.material.materials[i].emissive.g=c.g/255,s.material.materials[i].emissive.b=c.b/255}E.add(s)}),phoneObject=s,E.position.z=0,E.position.y=-1,E.scale.set(30,30,30),E.castShadow=!0,TweenMax.to(E.rotation,1.5,{y:de2ra(0),ease:Power4.easeOut});TweenMax.to(E.position,3.5,{y:0,yoyo:!0,repeat:-1,ease:Power2.easeInOut,onComplete:function(){}})}),s.add(E)}else if($(e).hasClass("desktop")){var T=new THREE.Group,v=new THREE.Object3D;o.load("models/screen.json",function(e,a){var t=new THREE.MultiMaterial(a),s=new THREE.Mesh(e,t);s.position.y=0,s.position.x=-.5,s.position.z=0,s.castShadow=!0,s.traverse(function(e){for(i=0;i<s.material.materials.length;i++){s.material.materials[i].side=2,s.material.materials[i].specular.r=1,s.material.materials[i].specular.g=.7,s.material.materials[i].specular.b=0,s.material.materials[i].emissive.r=1,s.material.materials[i].emissive.g=.8,s.material.materials[i].emissive.b=0,s.material.materials[i].shininess=8}v.add(s)})});var g=new THREE.PlaneGeometry(8.7,5.8,1),R=new THREE.Mesh(g,n);R.position.z=-3.16,R.position.y=3.3,R.rotation.x=de2ra(1),v.add(R);var H=new THREE.Mesh(g,d);H.receiveShadow=!0,H.position.z=-3.16,H.position.y=3.3,H.rotation.x=de2ra(1);var M=new THREE.Object3D,y=new THREE.BoxBufferGeometry(200,200,200),b=new THREE.MeshBasicMaterial({color:16777215});mesh=new THREE.Mesh(y,b),M.add(mesh),v.position.z=3,M.add(v),M.position.z=-2.8,M.rotation.x=de2ra(90);TweenMax.to(M.rotation,1,{x:0,ease:Power4.easeInOut}),TweenMax.to(n,.3,{opacity:1,delay:.5});T.add(M),o.load("models/keyboard.json",function(e,a){var t=new THREE.MultiMaterial(a),s=new THREE.Mesh(e,t);for(s.position.x=-.5,s.castShadow=!0,i=0;i<s.material.materials.length;i++){s.material.materials[i].side=2,s.material.materials[i].specular.r=1,s.material.materials[i].specular.g=.7,s.material.materials[i].specular.b=0,s.material.materials[i].emissive.r=1,s.material.materials[i].emissive.g=.8,s.material.materials[i].emissive.b=0,s.material.materials[i].shininess=1.5}T.add(s)}),o.load("models/keys.json",function(e,a){var t=new THREE.MultiMaterial(a),s=new THREE.Mesh(e,t);for(s.position.y=.005,s.position.x=-.5,s.position.z=0,s.castShadow=!0,i=0;i<s.material.materials.length;i++){s.material.materials[i].side=2,s.material.materials[i].specular.r=1,s.material.materials[i].specular.g=.7,s.material.materials[i].specular.b=0,s.material.materials[i].emissive.r=1,s.material.materials[i].emissive.g=.8,s.material.materials[i].emissive.b=0,s.material.materials[i].shininess=21}T.add(s)}),T.position.y=-10,T.position.z=4,T.scale.set(4,4,4),s.add(T),s.position.z=5;TweenMax.to(T.position,3.5,{y:-9,yoyo:!0,repeat:-1,ease:Power2.easeInOut,onComplete:function(){}})}return s.updatePosition=function(){this.position.x=this.count*screenWidthFromDistance(60)},s.start=function(){console.log("new section",e,$(e).attr("data-bg-light"),$(e).attr("data-bg-dark")),$(".devices").css("background","radial-gradient(ellipse at center, "+$(e).data("bg-light")+" 0%, "+$(e).data("bg-dark")+" 100%)")},a.add(s),setTimeout(function(e){e.position.x=e.count*screenWidthFromDistance(60)},100,s),s}
function init(){setEnvironment(),setLights(),$("section").each(function(e,n){sections.push(addProject(n,stage)),sections[e].count=e}),animate()}function setLights(){var e=1024,n=new THREE.PlaneGeometry(250,250,1),t=new THREE.ShadowMaterial;t.opacity=.07;var i=new THREE.Mesh(n,t);i.receiveShadow=!0,i.rotation.x=55,i.position.y=-22,i.transparent=!0,scene.add(i);var o=new THREE.SpotLight(16777215);o.castShadow=!1,o.position.set(20,55,20),o.target.position.set(0,0,-10),o.intensity=.45,o.penumbra=1.5,o.decay=2,o.angle=de2ra(15),scene.add(o),scene.add(o.target);var r=new THREE.SpotLight(16777215);r.castShadow=!0,r.position.set(0,50,-10),r.shadow.mapSize.height=e,r.shadow.mapSize.width=e,r.intensity=.15,r.exponent=.05,r.angle=de2ra(75),scene.add(r),scene.add(r.target)}function scrollHandler(){scrollPercentage=$(".projects").scrollTop()/($(".projects")[0].scrollHeight-$(window).innerHeight()),activeSection=Math.floor(scrollPercentage*sections.length),activeSection==sections.length&&(activeSection-=1),activeSection!=prevActiveSection&&(console.log("starting section ",activeSection),sections[activeSection].start()),prevActiveSection=activeSection,stage.position.x=0-scrollPercentage*(screenWidthFromDistance(60)*(sections.length-1))}function setEnvironment(){var e=document.createElement("div");e.setAttribute("class","content"),document.getElementsByClassName("devices")[0].appendChild(e),camera=new THREE.PerspectiveCamera(setFOV(),window.innerWidth/window.innerHeight,1,2e3),camera.position.z=60,scene=new THREE.Scene,stage=new THREE.Group,scene.add(stage),$(".projects").bind("scroll",scrollHandler);var n=!0;window.devicePixelRatio>1&&(n=!1),renderer=new THREE.WebGLRenderer({alpha:!0,antialias:n}),renderer.setClearColor(16711680,0),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),renderer.shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap,e.appendChild(renderer.domElement);var t=renderer.domElement;t.style.position="absolute",window.addEventListener("resize",onWindowResize,!1),animate()}function onWindowResize(){for(windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight),overlay.width=window.innerWidth,overlay.height=window.innerHeight,camera.fov=setFOV(),scrollHandler(),i=0;i<sections.length;i++)sections[i].updatePosition()}function onDocumentMouseMove(e){mouseX=windowHalfX-e.clientX,mouseY=windowHalfY-e.clientY,prevMouseX=mouseX,TweenMax.to(mousePosition,1,{x:mouseX,y:mouseY})}function animate(){requestAnimationFrame(animate),render()}function render(){camera.position.x=.003*(mousePosition.x-camera.position.x),camera.position.y=.003*(-mousePosition.y-camera.position.y),renderer.render(scene,camera)}function de2ra(e){return e*(Math.PI/180)}function screenWidthFromDistance(e){var n=window.innerWidth/window.innerHeight,t=2*e*Math.tan(.5*camera.fov*(Math.PI/180)),i=t*n;return i}function setFOV(){var e=map_range(window.innerWidth,375,1440,95,60);return e<60&&(e=60),e>90&&(e=90),e}function hexToRgb(e,n){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),i=function(){return void 0==this.alpha?"rgb("+this.r+", "+this.g+", "+this.b+")":(this.alpha>1?this.alpha=1:this.alpha<0&&(this.alpha=0),"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")")};return void 0==n?t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16),toString:i}:null:(n>1?n=1:0>n&&(n=0),t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16),alpha:n,toString:i}:null)}function rgbToHex(e,n,t){function i(e){var n=e.toString(16);return 1==n.length?"0"+n:n}if(void 0==n||void 0==t){if("string"==typeof e){var o=/^rgb[a]?\(([\d]+)[ \n]*,[ \n]*([\d]+)[ \n]*,[ \n]*([\d]+)[ \n]*,?[ \n]*([.\d]+)?[ \n]*\)$/i.exec(e);return rgbToHex(parseInt(o[1]),parseInt(o[2]),parseInt(o[3]))}return void 0==e.r||void 0==e.g||void 0==e.b?null:rgbToHex(e.r,e.g,e.b)}var r=e;return"#"+i(r)+i(n)+i(t)}$(function(){init()});var camera,scene,stage,renderer,mouseX=0,prevMouseX=0,mouseY=0,mouseDown=!1,mouseDirection,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,mouseDownCoord=new Object,sections=[],activeSection=0,prevActiveSection=null,background={light:{r:0,g:0,b:0},dark:{r:0,g:0,b:0}},mousePosition={x:0,y:0};document.addEventListener("mousemove",onDocumentMouseMove,!1),$(".controls a").click(function(e){e.stopPropagation()});
document.write('<script src="http://'+(location.host||"localhost").split(":")[0]+':35729/livereload.js?snipver=1"></script>');
function map_range(n,r,a,e,t){return e+(t-e)*(n-r)/(a-r)}
//# sourceMappingURL=site.js.map

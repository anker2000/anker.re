function addProject(e,a){function t(){s.screenWidth=screenWidthFromDistance(camera.position.z),console.log(s.screenWidth)}var r=new THREE.Group,s={};$(window).bind("resize",t),t();var o=new THREE.JSONLoader,n=new THREE.JSONLoader,l=new THREE.MeshBasicMaterial({color:16777215}),m=$(e).find("video")[0],d=new THREE.VideoTexture(m);d.minFilter=THREE.LinearFilter,d.magFilter=THREE.LinearFilter,d.format=THREE.RGBFormat,d.wrapS=THREE.ClampToEdgeWrapping,d.wrapT=THREE.ClampToEdgeWrapping,l.map=d;var p=new THREE.MeshBasicMaterial({color:14606046}),c=new THREE.MeshPhongMaterial({color:16777215});c.specular.r=1,c.specular.g=1,c.specular.b=1,c.transparent=!0,c.opacity=.1,c.shininess=10;var E=hexToRgb($(e).data("device-light")),w=hexToRgb($(e).data("device-dark"));if(console.log(E.r,w),$(e).hasClass("mobile")){var h=new THREE.Group,u=new THREE.PlaneGeometry(.55,.983,1),T=new THREE.Mesh(u,p);T.receiveShadow=!1,T.position.z=.0292,T.position.y=.05,T.receiveShadow=!1,T.position.z=.0292,T.position.y=.05,h.add(T);var v=new THREE.Mesh(u,c);v.receiveShadow=!0,v.position.z=.0293,v.position.y=.05,v.transparent=!0,o.load("models/phone.json",function(e,a){var t=new THREE.MultiMaterial(a),r=new THREE.Mesh(e,t);r.position.y=-.6,r.castShadow=!0,r.receiveShadow=!0,r.traverse(function(e){for(h.position.y=-5,h.position.z=-1,i=0;i<r.material.materials.length;i++){r.material.materials[i].side=2,r.material.materials[i].specular.r=w.r/255,r.material.materials[i].specular.g=w.g/255,r.material.materials[i].specular.b=w.b/255,r.material.materials[i].emissive.r=E.r/255,r.material.materials[i].emissive.g=E.g/255,r.material.materials[i].emissive.b=E.b/255}h.add(r)}),phoneObject=r,h.position.z=0,h.position.y=-1,h.scale.set(30,30,30),h.castShadow=!0,h.rotation.x=de2ra(-65),h.rotation.z=de2ra(20),TweenMax.to(h.rotation,1.5,{y:de2ra(0),ease:Power4.easeOut});TweenMax.to(h.position,3.5,{y:0,yoyo:!0,repeat:-1,ease:Power2.easeInOut,onComplete:function(){}})}),r.add(h);var g=new THREE.Group,R=new THREE.Mesh(u,l);R.receiveShadow=!1,R.position.z=.0292,R.position.y=.05,R.receiveShadow=!1,R.position.z=.0292,R.position.y=.05,g.add(R),n.load("models/phone.json",function(e,a){var t=new THREE.MultiMaterial(a),r=new THREE.Mesh(e,t);r.position.y=-.6,r.castShadow=!0,r.receiveShadow=!0,r.traverse(function(e){for(g.position.y=-5,g.position.z=-1,i=0;i<r.material.materials.length;i++){r.material.materials[i].side=2,r.material.materials[i].specular.r=w.r/255,r.material.materials[i].specular.g=w.g/255,r.material.materials[i].specular.b=w.b/255,r.material.materials[i].emissive.r=E.r/255,r.material.materials[i].emissive.g=E.g/255,r.material.materials[i].emissive.b=E.b/255}g.add(r)}),phoneObject=r,g.position.z=0,g.position.y=14,g.scale.set(30,30,30),g.castShadow=!0,g.rotation.x=de2ra(-35),g.rotation.z=de2ra(-20),TweenMax.to(g.rotation,1.5,{y:de2ra(0),ease:Power4.easeOut});TweenMax.to(g.position,3.5,{y:13,yoyo:!0,repeat:-1,ease:Power2.easeInOut,onComplete:function(){}})}),r.add(g)}else if($(e).hasClass("desktop")){var H=new THREE.Group,y=new THREE.Object3D;o.load("models/screen.json",function(e,a){var t=new THREE.MultiMaterial(a),r=new THREE.Mesh(e,t);r.position.y=0,r.position.x=-.5,r.position.z=0,r.castShadow=!0,r.traverse(function(e){for(i=0;i<r.material.materials.length;i++){r.material.materials[i].side=2,r.material.materials[i].specular.r=w.r/255,r.material.materials[i].specular.g=w.g/255,r.material.materials[i].specular.b=w.b/255,r.material.materials[i].emissive.r=E.r/255,r.material.materials[i].emissive.g=E.g/255,r.material.materials[i].emissive.b=E.b/255,r.material.materials[i].shininess=8}y.add(r)})});var M=new THREE.PlaneGeometry(8.7,5.8,1),b=new THREE.Mesh(M,l);b.position.z=-3.16,b.position.y=3.3,b.rotation.x=de2ra(1),y.add(b);var f=new THREE.Mesh(M,c);f.receiveShadow=!0,f.position.z=-3.16,f.position.y=3.3,f.rotation.x=de2ra(1);var x=new THREE.Object3D,z=new THREE.BoxBufferGeometry(200,200,200),S=new THREE.MeshBasicMaterial({color:16777215});mesh=new THREE.Mesh(z,S),x.add(mesh),y.position.z=3,x.add(y),x.position.z=-2.8,x.rotation.x=de2ra(90);TweenMax.to(x.rotation,1,{x:0,ease:Power4.easeInOut}),TweenMax.to(l,.3,{opacity:1,delay:.5});H.add(x),o.load("models/keyboard.json",function(e,a){var t=new THREE.MultiMaterial(a),r=new THREE.Mesh(e,t);for(r.position.x=-.5,r.castShadow=!0,i=0;i<r.material.materials.length;i++){r.material.materials[i].side=2,r.material.materials[i].specular.r=w.r/255,r.material.materials[i].specular.g=w.g/255,r.material.materials[i].specular.b=w.b/255,r.material.materials[i].emissive.r=E.r/255,r.material.materials[i].emissive.g=E.g/255,r.material.materials[i].emissive.b=E.b/255,r.material.materials[i].shininess=1.5}H.add(r)}),o.load("models/keys.json",function(e,a){var t=new THREE.MultiMaterial(a),r=new THREE.Mesh(e,t);for(r.position.y=.005,r.position.x=-.5,r.position.z=0,r.castShadow=!0,i=0;i<r.material.materials.length;i++){r.material.materials[i].side=2,r.material.materials[i].specular.r=w.r/255,r.material.materials[i].specular.g=w.g/255,r.material.materials[i].specular.b=w.b/255,r.material.materials[i].emissive.r=E.r/255,r.material.materials[i].emissive.g=E.g/255,r.material.materials[i].emissive.b=E.b/255,r.material.materials[i].shininess=21}H.add(r)}),H.position.y=-10,H.position.z=4,H.scale.set(4,4,4),r.add(H),r.position.z=5;TweenMax.to(H.position,3.5,{y:-9,yoyo:!0,repeat:-1,ease:Power2.easeInOut,onComplete:function(){}})}return r.updatePosition=function(){this.position.x=this.count*screenWidthFromDistance(60)},r.start=function(){console.log("new section",e,$(e).attr("data-bg-light"),$(e).attr("data-bg-dark")),$("body").css("background",$(e).data("bg-dark"))},a.add(r),setTimeout(function(e){e.position.x=e.count*screenWidthFromDistance(60)},100,r),r}
function init(){setEnvironment(),setLights(),$("section").each(function(e,n){sections.push(addProject(n,stage)),sections[e].count=e}),scrollHandler(),animate()}function setLights(){var e=1024,n=new THREE.PlaneGeometry(250,250,1),t=new THREE.ShadowMaterial;t.opacity=.07;var i=new THREE.Mesh(n,t);i.receiveShadow=!0,i.rotation.x=55,i.position.y=-22,i.transparent=!0,scene.add(i);var o=new THREE.SpotLight(16777215);o.castShadow=!1,o.position.set(20,55,20),o.target.position.set(0,0,-10),o.intensity=.45,o.penumbra=1.5,o.decay=2,o.angle=de2ra(15),scene.add(o),scene.add(o.target);var r=new THREE.SpotLight(16777215);r.castShadow=!0,r.position.set(0,50,-10),r.shadow.mapSize.height=e,r.shadow.mapSize.width=e,r.intensity=.15,r.exponent=.05,r.angle=de2ra(75),scene.add(r),scene.add(r.target)}function scrollHandler(){scrollPercentage=$(".projects").scrollTop()/($(".projects")[0].scrollHeight-$(window).innerHeight()),activeSection=Math.floor(scrollPercentage*sections.length),activeSection==sections.length&&(activeSection-=1),activeSection!=prevActiveSection&&(console.log("starting section ",activeSection),sections[activeSection].start()),prevActiveSection=activeSection,stage.position.x=0-scrollPercentage*(screenWidthFromDistance(60)*(sections.length-1))}function setEnvironment(){var e=document.createElement("div");e.setAttribute("class","content"),document.getElementsByClassName("devices")[0].appendChild(e),camera=new THREE.PerspectiveCamera(setFOV(),window.innerWidth/window.innerHeight,1,2e3),camera.position.z=60,scene=new THREE.Scene,stage=new THREE.Group,scene.add(stage),$(".projects").bind("scroll",scrollHandler);var n=!0;window.devicePixelRatio>1&&(n=!1),renderer=new THREE.WebGLRenderer({alpha:!0,antialias:n}),renderer.setClearColor(16711680,0),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),renderer.shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap,e.appendChild(renderer.domElement);var t=renderer.domElement;t.style.position="absolute",window.addEventListener("resize",onWindowResize,!1),animate()}function onWindowResize(){for(windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight),overlay.width=window.innerWidth,overlay.height=window.innerHeight,camera.fov=setFOV(),scrollHandler(),i=0;i<sections.length;i++)sections[i].updatePosition()}function onDocumentMouseMove(e){mouseX=windowHalfX-e.clientX,mouseY=windowHalfY-e.clientY,prevMouseX=mouseX,TweenMax.to(mousePosition,1,{x:mouseX,y:mouseY})}function animate(){requestAnimationFrame(animate),render()}function render(){camera.position.x=.003*(mousePosition.x-camera.position.x),camera.position.y=.003*(-mousePosition.y-camera.position.y),renderer.render(scene,camera)}function de2ra(e){return e*(Math.PI/180)}function screenWidthFromDistance(e){var n=window.innerWidth/window.innerHeight,t=2*e*Math.tan(.5*camera.fov*(Math.PI/180)),i=t*n;return i}function setFOV(){var e=map_range(window.innerWidth,375,1440,95,60);return e<60&&(e=60),e>90&&(e=90),e}function hexToRgb(e,n){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),i=function(){return void 0==this.alpha?"rgb("+this.r+", "+this.g+", "+this.b+")":(this.alpha>1?this.alpha=1:this.alpha<0&&(this.alpha=0),"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")")};return void 0==n?t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16),toString:i}:null:(n>1?n=1:0>n&&(n=0),t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16),alpha:n,toString:i}:null)}function rgbToHex(e,n,t){function i(e){var n=e.toString(16);return 1==n.length?"0"+n:n}if(void 0==n||void 0==t){if("string"==typeof e){var o=/^rgb[a]?\(([\d]+)[ \n]*,[ \n]*([\d]+)[ \n]*,[ \n]*([\d]+)[ \n]*,?[ \n]*([.\d]+)?[ \n]*\)$/i.exec(e);return rgbToHex(parseInt(o[1]),parseInt(o[2]),parseInt(o[3]))}return void 0==e.r||void 0==e.g||void 0==e.b?null:rgbToHex(e.r,e.g,e.b)}var r=e;return"#"+i(r)+i(n)+i(t)}$(function(){init()});var camera,scene,stage,renderer,mouseX=0,prevMouseX=0,mouseY=0,mouseDown=!1,mouseDirection,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,mouseDownCoord=new Object,sections=[],activeSection=0,prevActiveSection=null,background={light:{r:0,g:0,b:0},dark:{r:0,g:0,b:0}},mousePosition={x:0,y:0};document.addEventListener("mousemove",onDocumentMouseMove,!1),$(".controls a").click(function(e){e.stopPropagation()});
document.write('<script src="http://'+(location.host||"localhost").split(":")[0]+':35729/livereload.js?snipver=1"></script>');
function map_range(n,r,a,e,t){return e+(t-e)*(n-r)/(a-r)}
//# sourceMappingURL=site.js.map

{"version":3,"sources":["add_device.js","add_project.js","interface.js","livereload.js","scrollsnap-polyfill.js","tools.js"],"names":["addPhone","rotation","position","screenMaterial","glassMaterial","reflectionCube","loader","color_dark","color_light","deferred","$","Deferred","phoneGroup","THREE","Group","screenGeometry","PlaneGeometry","screen","Mesh","receiveShadow","z","y","add","MeshStandardMaterial","side","DoubleSide","color","emissive","metalness","roughness","envMap","glass","load","geometry","materials","material","MultiMaterial","object","castShadow","traverse","child","i","length","r","g","b","shininess","x","scale","set","resolve","promise","addLaptop","macbookGroup","macbookScreenGroup","Object3D","texture","TextureLoader","wrapS","RepeatWrapping","wrapT","repeat","map","roughnessMap","macbookPivot","console","log","desktopGeometry","desktopScreen","de2ra","desktopGlass","tempgeometry","BoxBufferGeometry","tempmaterial","MeshBasicMaterial","mesh","specular","TweenMax","to","yoyo","ease","Power2","easeInOut","onComplete","begin","Power4","end","addProject","section","stage","resizeHandler","area","screenWidth","screenWidthFromDistance","camera","sectionObject","window","bind","JSONLoader","video","find","CubeTextureLoader","format","RGBFormat","videoTexture","VideoTexture","minFilter","LinearFilter","magFilter","ClampToEdgeWrapping","screenMaterial2","MeshPhongMaterial","transparent","opacity","reflectivity","combine","MixOperation","hexToRgb","data","name","html","hasClass","phonesGroup","done","delay","updatePosition","this","count","start","play","children","css","mainLight","rgbPercentage","intensity","colorIntensity","groundMaterial","map_range","setTimeout","init","setEnvironment","setLights","each","elm","sections","push","scrollHandler","animate","shadowMapSize","groundGeometry","ShadowMaterial","ground","scene","AmbientLight","spotLight1","SpotLight","shadow","mapSize","height","width","penumbra","decay","angle","target","spotLight2","exponent","scrollPercentage","scrollTop","scrollHeight","innerHeight","activeSection","Math","floor","prevActiveSection","scrollTarget","easeOut","container","document","createElement","setAttribute","getElementsByClassName","appendChild","PerspectiveCamera","setFOV","innerWidth","Scene","myAntialias","devicePixelRatio","renderer","WebGLRenderer","alpha","antialias","setClearColor","setPixelRatio","setSize","shadowMap","enabled","type","PCFSoftShadowMap","domElement","element","style","addEventListener","onWindowResize","windowHalfX","windowHalfY","aspect","updateProjectionMatrix","fov","onDocumentMouseMove","event","mouseX","clientX","mouseY","clientY","prevMouseX","mousePosition","requestAnimationFrame","render","degree","PI","distance","frustumHeight","tan","frustumWidth","mouseDown","mouseDirection","mouseDownCoord","Object","background","light","dark","click","e","stopPropagation","write","location","host","split","w","doc","undefined","doMatched","rules","rule","elements","querySelectorAll","getSelectors","declaration","getDeclaration","forEach","call","obj","setUpElement","undoUnmatched","item","tearDownElement","snapLengthUnit","parseSnapCoordValue","attachToScrollParent","tag","tagName","toLowerCase","handler","parseSnapPointValue","snapElements","removeEventListener","attach","parentNode","getNextSnapPoint","scrollObj","direction","snapLength","getYSnapLength","getXSnapLength","top","left","scrollLeft","currentPoint","initialPoint","scrollStart","nextPoint","roundByDirection","constrainByDistance","scrollTo","stayInBounds","getScrollHeight","getScrollWidth","getNextElementSnapPoint","l","primaryDirection","min","snapDest","snapCoords","currentIteration","currentIteratedObj","offsetTop","offsetLeft","getWidth","getHeight","ceil","currentScrollValue","abs","SNAP_CONSTRAINT","CONSTRAINT","round","MIN_PX_CONSTRAINT","FIRST_CONSTRAINT","max","destined","result","regex","parsed","value","unit","exec","parsable","documentElement","clientHeight","clientWidth","scrollWidth","offsetHeight","offsetWidth","getScrollObj","querySelector","getDuration","procDist","duration","SCROLL_TIME","isNaN","SCROLL_TIMEOUT","lastObj","lastScrollObj","timeOutId","evt","animationFrame","cancelAnimationFrame","clearTimeout","handlerDelayed","snapPoint","smoothScroll","easeInCubic","t","elapsed","callback","clock","Date","now","mozRequestAnimationFrame","webkitRequestAnimationFrame","fn","step","Polyfill","declarations","low1","high1","low2","high2","n","a","parseInt","toString","rgbToHex"],"mappings":"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","file":"site.js","sourcesContent":["function addPhone(rotation, position, screenMaterial, glassMaterial, reflectionCube, loader, color_dark, color_light) {\n\n\tvar deferred = new $.Deferred();\n\tvar phoneGroup = new THREE.Group();\n\tvar screenGeometry = new THREE.PlaneGeometry( 0.55, 1, 1 );\n\tvar screen = new THREE.Mesh( screenGeometry, screenMaterial );\n\tscreen.receiveShadow = false;\n\tscreen.position.z = 0.022;\n\tscreen.position.y = 0.05;\n\tphoneGroup.add( screen );\n\n\tvar glassMaterial = new THREE.MeshStandardMaterial({ side: THREE.DoubleSide, color:0x222222, emissive:0x0, metalness:0.7, roughness:0.2, envMap:reflectionCube });\n\tvar glass = new THREE.Mesh( screenGeometry, glassMaterial );\n\tglass.receiveShadow = false;\n\tglass.position.z = 0.022;\n\tglass.position.y = 0.05;\n\tphoneGroup.add(glass);\n\n\tloader.load(\n\t\t'models/iphones7.json',\n\t\tfunction ( geometry, materials ) {\n\t\t\tvar material = new THREE.MultiMaterial( materials );\n\t\t\tvar object = new THREE.Mesh( geometry, material );\t\t\t\t\n\t\t\tobject.position.y=-0.6;\n\t\t\tobject.castShadow=true;\n\t\t\tobject.receiveShadow = true;\n\t\t\tphoneGroup.add( object );\n\t\t\tobject.traverse( function ( child ) {\n\t\t\t\t// child.geometry.computeFaceNormals();\n\t\t        phoneGroup.position.y=-5;\n\t\t        phoneGroup.position.z=-1;\n\t\t       for (i=0;i<object.material.materials.length;i++) {\n\t\t        \tvar tC = .75;\n\t\t\t\t\tobject.material.materials[i].emissive.r = (color_dark.r/255);\n\t\t\t\t\tobject.material.materials[i].emissive.g = (color_dark.g/255);\n\t\t\t\t\tobject.material.materials[i].emissive.b = (color_dark.b/255);\n\t\t\t\t\tobject.material.materials[i].color.r = (color_light.r/255);\n\t\t\t\t\tobject.material.materials[i].color.g = (color_light.g/255);\n\t\t\t\t\tobject.material.materials[i].color.b = (color_light.b/255);\n\t\t\t\t\tobject.material.materials[i].shininess = 10;\n\t\t        } \n\t    \t});\n\t    \tloader.load(\n\t\t\t\t'models/iphone-back.json',\n\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\tvar material = new THREE.MultiMaterial( materials );\n\t\t\t\t\tvar object = new THREE.Mesh( geometry, material );\t\t\t\t\n\t\t\t\t\tobject.position.y=-0.6;\n\t\t\t\t\tobject.castShadow=true;\n\t\t\t\t\tobject.receiveShadow = true;\n\t\t\t\t\tphoneGroup.add( object );\n\t\t\t\t\tobject.traverse( function ( child ) {\n\t\t\t\t\t\t// child.geometry.computeFaceNormals();\n\t\t\t\t        phoneGroup.position.y=-5;\n\t\t\t\t        phoneGroup.position.z=-1;\n\n\t\t\t\t       for (i=0;i<object.material.materials.length;i++) {\n\t\t\t\t        \tvar tC = .75;\n\t\t\t\t\t\t\tobject.material.materials[i].emissive.r = (color_dark.r/255);\n\t\t\t\t\t\t\tobject.material.materials[i].emissive.g = (color_dark.g/255);\n\t\t\t\t\t\t\tobject.material.materials[i].emissive.b = (color_dark.b/255);\n\t\t\t\t\t\t\tobject.material.materials[i].color.r = (color_light.r/255);\n\t\t\t\t\t\t\tobject.material.materials[i].color.g = (color_light.g/255);\n\t\t\t\t\t\t\tobject.material.materials[i].color.b = (color_light.b/255);\n\t\t\t\t\t\t\t// object.material.materials[i].shininess = 12;\n\t\t\t\t        } \n\t\t\t\t\t\tphoneGroup.position.z=position.z;\n\t\t\t\t\t\tphoneGroup.position.y=position.y;\n\t\t\t\t\t\tphoneGroup.position.x=position.x;\n\t\t\t\t\t\tphoneGroup.scale.set( 30, 30, 30 );\n\t\t\t\t\t\tphoneGroup.castShadow = true;\n\t\t\t\t\t\tphoneGroup.rotation.x=rotation.x;\n\t\t\t\t\t\tphoneGroup.rotation.y=rotation.y;\n\t\t\t\t\t\tphoneGroup.rotation.z=rotation.z;\n\t\t\t\t\t\tdeferred.resolve(phoneGroup);\n\t\t\t    \t})\t\t\t\t    \t\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t);\n\treturn deferred.promise();\n}\n\nfunction addLaptop(rotation, position, screenMaterial, glassMaterial, reflectionCube, loader, color_dark, color_light) {\n\tvar deferred = new $.Deferred();\n\tvar macbookGroup = new THREE.Group();\n\tvar macbookScreenGroup = new THREE.Object3D();\n\n\tvar texture = new THREE.TextureLoader().load( \"models/macbook-texture.png\" );\n\ttexture.wrapS = THREE.RepeatWrapping;\n\ttexture.wrapT = THREE.RepeatWrapping;\n\ttexture.repeat.set( 12, 12 );\n\n\t\n    var material = new THREE.MeshStandardMaterial({ side: THREE.DoubleSide, color:0xffffff, metalness:0.5, roughness:1, map:texture, roughnessMap:texture});\n\n\tvar macbookPivot = new THREE.Object3D();\n\t\n\n\tloader.load(\n\t\t// resource URL\n\t\t'models/screen-back.json',\n\t\t// Function when resource is loaded\n\t\tfunction ( geometry, materials ) {\n\t\t\t// var material = new THREE.MultiMaterial( materials );\n\t\t\t\n\t\t\tvar object = new THREE.Mesh( geometry, material );\n\t\t\t// scene.add( object );\n\t\t\t\n\t\t\tobject.position.y=0;\n\t\t\tobject.position.x=-0.5;\n\t\t\tobject.position.z=0;\n\t\t\t// object.rotation.y=de2ra(180);\n\n\t\t\tobject.castShadow=true;\n\t\t\tobject.traverse( function ( child ) {\n\t\t        // console.log(\"screen\",object);\n\t\t        var color_dark = {\n\t\t        \tr:40,\n\t\t        \tg:40,\n\t\t        \tb:40\n\t\t        }\n\t\t        var color_light = color_dark;\n\t\t\t\tmacbookScreenGroup.add( object );\n\t\t    });\n\t\t    console.log(\"loaded screen back 1\");\n\t\t    loader.load(\n\t\t\t\t// resource URL\n\t\t\t\t'models/screen-front.json',\n\t\t\t\t// Function when resource is loaded\n\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\t\n\t\t\t\t\tvar material = new THREE.MeshStandardMaterial({ side: THREE.DoubleSide, color:0x222222, emissive:0x0, metalness:0.7, roughness:0.2, envMap:reflectionCube });\n\t\t\t\t\tvar object = new THREE.Mesh( geometry, material );\t\t\t\t\n\t\t\t\t\tobject.position.y=0;\n\t\t\t\t\tobject.position.x=-0.5;\n\t\t\t\t\tobject.position.z=0;\n\t\t\t\t\t// object.rotation.y=de2ra(180);\n\t\t\t\t\tvar color_dark = {\n\t\t\t\t\t\tr:0,\n\t\t\t\t\t\tg:0,\n\t\t\t\t\t\tb:0\n\t\t\t\t\t}\n\t\t\t\t\tvar color_light = color_dark;\n\t\t\t\t\tobject.castShadow=true;\n\t\t\t\t\tmacbookScreenGroup.add( object );\n\t\t\t\t\tvar desktopGeometry = new THREE.PlaneGeometry( 8.7, 5.8, 1 );\n\n\t\t\t\t\tvar desktopScreen = new THREE.Mesh( desktopGeometry, screenMaterial );\n\t\t\t\t\tdesktopScreen.position.z = -3.16;\n\t\t\t\t\tdesktopScreen.position.y = 3.3;\n\t\t\t\t\tdesktopScreen.rotation.x = de2ra(1);\n\n\t\t\t\t\tmacbookScreenGroup.add(desktopScreen);\n\n\t\t\t\t\tvar desktopGlass = new THREE.Mesh(desktopGeometry, glassMaterial);\n\t\t\t\t\tdesktopGlass.receiveShadow = true;\n\t\t\t\t\tdesktopGlass.position.z = -3.16;\n\t\t\t\t\tdesktopGlass.position.y = 3.3;\n\t\t\t\t\tdesktopGlass.rotation.x = de2ra(1);\n\t\t\t\t\tmacbookScreenGroup.add(desktopGlass);\n\n\t\t\t\t\t\n\t\t\t\t\tvar tempgeometry = new THREE.BoxBufferGeometry( 200, 200, 200 );\n\t\t\t\t\tvar tempmaterial = new THREE.MeshBasicMaterial( { color: 0xffffff } );\t\n\t\t\t\t\tmesh = new THREE.Mesh( tempgeometry, tempmaterial );\n\t\t\t\t\t\n\t\t\t\t\tmacbookScreenGroup.position.z=3.1;\n\t\t\t\t\tmacbookPivot.add(macbookScreenGroup);\n\t\t\t\t\tmacbookPivot.position.z=-3;\n\t\t\t\t\tmacbookPivot.position.y=0;\n\t\t\t\t\tmacbookPivot.rotation.x=de2ra(90);\n\t\t\t\t\t\n\t\t\t\t\tmacbookGroup.add(macbookPivot);\n\n\t\t\t\t\tconsole.log(\"loaded screen front 2\");\n\t\t\t\t\tloader.load(\n\t\t\t\t\t\t'models/keyboard.json',\n\t\t\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\t\t\tvar object = new THREE.Mesh( geometry, material );\n\t\t\t\t\t\t\tobject.position.x=-0.5;\n\t\t\t\t\t\t\tobject.castShadow=true;\n\t\t\t\t\t\t\tconsole.log(\"material\",material)\n\t\t\t\t\t\t\tmacbookGroup.add( object );\n\t\t\t\t\t\t\tconsole.log(\"loaded keyboard 3\");\n\t\t\t\t\t\t\tloader.load(\n\t\t\t\t\t\t\t\t// resource URL\n\t\t\t\t\t\t\t\t'models/keys.json',\n\t\t\t\t\t\t\t\t// Function when resource is loaded\n\t\t\t\t\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\t\t\t\t\tvar material = new THREE.MultiMaterial( materials );\n\t\t\t\t\t\t\t\t\tvar object = new THREE.Mesh( geometry, material );\n\t\t\t\t\t\t\t\t\t// scene.add( object );\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tobject.position.y=0.005;\n\t\t\t\t\t\t\t\t\t// object.position.y=0.06;\n\t\t\t\t\t\t\t\t\tobject.position.x=-0.5;\n\t\t\t\t\t\t\t\t\tobject.position.z=0;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tobject.castShadow=true;\n\t\t\t\t\t\t\t\t\tvar color_dark = {\n\t\t\t\t\t\t\t\t\t\tr: 0,\n\t\t\t\t\t\t\t\t\t\tg: 0,\n\t\t\t\t\t\t\t\t\t\tb: 0\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tvar color_light = color_dark;\n\t\t\t\t\t\t\t        for (i=0;i<object.material.materials.length;i++) {\n\t\t\t\t\t\t\t        \tvar tC = .75;\n\t\t\t\t\t\t\t        \tobject.material.materials[i].side=THREE.DoubleSide;\n\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].specular.r = color_dark.r/255;\n\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].specular.g = color_dark.g/255;\n\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].specular.b = color_dark.b/255;\n\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].emissive.r = color_light.r/255;\n\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].emissive.g = color_light.g/255;\n\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].emissive.b = color_light.b/255;\n\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].shininess=21;\t\n\t\t\t\t\t\t\t        }\n\t\t\t\t\t\t\t\t\tmacbookGroup.add( object );\n\t\t\t\t\t\t\t\t\tconsole.log(\"loaded keys 4\");\n\t\t\t\t\t\t\t    \tloader.load(\n\t\t\t\t\t\t\t\t\t\t// resource URL\n\t\t\t\t\t\t\t\t\t\t'models/keys-top.json',\n\t\t\t\t\t\t\t\t\t\t// Function when resource is loaded\n\t\t\t\t\t\t\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\t\t\t\t\t\t\tvar material = new THREE.MultiMaterial( materials );\n\t\t\t\t\t\t\t\t\t\t\tvar object = new THREE.Mesh( geometry, material );\n\t\t\t\t\t\t\t\t\t\t\t// scene.add( object );\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tobject.position.y=0.005;\n\t\t\t\t\t\t\t\t\t\t\t// object.position.y=0.06;\n\t\t\t\t\t\t\t\t\t\t\tobject.position.x=-0.5;\n\t\t\t\t\t\t\t\t\t\t\tobject.position.z=0;\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tobject.castShadow=true;\n\t\t\t\t\t\t\t\t\t\t\tvar color_dark = {\n\t\t\t\t\t\t\t\t\t\t\t\tr: 15,\n\t\t\t\t\t\t\t\t\t\t\t\tg: 15,\n\t\t\t\t\t\t\t\t\t\t\t\tb: 15\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tvar color_light = {\n\t\t\t\t\t\t\t\t\t\t\t\tr:25,\n\t\t\t\t\t\t\t\t\t\t\t\tg:25,\n\t\t\t\t\t\t\t\t\t\t\t\tb:25\n\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t        for (i=0;i<object.material.materials.length;i++) {\n\t\t\t\t\t\t\t\t\t        \tvar tC = .75;\n\t\t\t\t\t\t\t\t\t        \tobject.material.materials[i].side=THREE.DoubleSide;\n\t\t\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].specular.r = color_dark.r/255;\n\t\t\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].specular.g = color_dark.g/255;\n\t\t\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].specular.b = color_dark.b/255;\n\t\t\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].emissive.r = color_light.r/255;\n\t\t\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].emissive.g = color_light.g/255;\n\t\t\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].emissive.b = color_light.b/255;\n\t\t\t\t\t\t\t\t\t\t\t\tobject.material.materials[i].shininess=21;\t\n\t\t\t\t\t\t\t\t\t        }\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.scale.set(7.5,7.5,7.5);\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.add( object );\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(position);\n\t\t\t\t\t\t\t\t\t\t\t// macbookGroup.position = position;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.position.z=position.z;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.position.y=position.y;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.position.x=position.x;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.rotation.x = rotation.x;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.rotation.y = rotation.y;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.rotation.z = rotation.z;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.screen = macbookPivot;\n\t\t\t\t\t\t\t\t\t\t\t// screenMaterial.opacity=0;\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"screenMaterial\",screenMaterial);\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tvar tween1 = TweenMax.to(macbookGroup.position, 3.5,{ y:macbookGroup.position.y-1, yoyo:true, repeat:-1, ease:Power2.easeInOut, onComplete:function() {}});\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"loaded keys top 5\");\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.begin = function() {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"macbook open\");\n\t\t\t\t\t\t\t\t\t\t\t\tvar openLid = TweenMax.to(macbookGroup.screen.rotation, 1, { x:-de2ra(20), ease:Power4.easeInOut});\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.end = function() {\n\t\t\t\t\t\t\t\t\t\t\t\tvar openLid = TweenMax.to(macbookGroup.screen.rotation, 1, { x:de2ra(90), ease:Power4.easeInOut});\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t    \tdeferred.resolve(macbookGroup);\n\t\t\t\t\t\t\t\t\t    }\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t    }\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t);\n\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t// scene.add(macbookGroup);\n\t\n\treturn deferred.promise();\n}","function addProject(section, stage) {\n\tvar sectionObject = new THREE.Group();\n\tvar area = {};\n\tfunction resizeHandler() {\n\t\tarea.screenWidth=screenWidthFromDistance(camera.position.z);\n\t\tconsole.log(area.screenWidth);\n\t}\n\t$(window).bind(\"resize\",resizeHandler);\n\tresizeHandler();\n\t\n\tvar loader = new THREE.JSONLoader();\n\tvar screenMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });\t\n\tvar video = $(section).find(\"video\")[0];\n\n\tvar reflectionCube = new THREE.CubeTextureLoader().load([\"models/environment2.jpg\",\"models/environment2.jpg\",\"models/environment2.jpg\",\"models/environment2.jpg\",\"models/environment2.jpg\",\"models/environment2.jpg\"] );\n\treflectionCube.format = THREE.RGBFormat;\n\n\tvar videoTexture = new THREE.VideoTexture( video );\n\tvideoTexture.minFilter = THREE.LinearFilter;\n\tvideoTexture.magFilter = THREE.LinearFilter;\n\tvideoTexture.format = THREE.RGBFormat;\n\tvideoTexture.wrapS = THREE.ClampToEdgeWrapping;\n\tvideoTexture.wrapT = THREE.ClampToEdgeWrapping;\n\tscreenMaterial.map = videoTexture;\n\t// screenMaterial.emissiveMap = videoTexture;\n\t// screenMaterial.emissiveIntensity = 2;\n\t// screenMaterial.reflectivity = 0;\n\n\n\tvar screenMaterial2 = new THREE.MeshBasicMaterial({ color: 0x333333 });\t\n\tvar glassMaterial = new THREE.MeshPhongMaterial({ color: 0xffffff  });\n\tglassMaterial.specular.r=1;\n\tglassMaterial.specular.g=1;\n\tglassMaterial.specular.b=1;\n\tglassMaterial.transparent = true;\n\tglassMaterial.opacity = 0.05;\n\tglassMaterial.shininess = 20;\n\tglassMaterial.envMap = reflectionCube;\n\tglassMaterial.reflectivity = 5;\n\tglassMaterial.combine = THREE.MixOperation;\n\tvar emDarken = 1;\n\tvar color_light = hexToRgb($(section).data(\"device-light\"));\n\tvar color_dark = hexToRgb($(section).data(\"device-dark\"));\n\tsectionObject.video = video;\n\tsectionObject.name=$(section).find(\"h2\").html()\n\tif ($(section).hasClass(\"mobile\")) {\t\t\n\t\tvar phonesGroup = new THREE.Group();\n\t\taddPhone({ x:de2ra(60), y:de2ra(-140), z:de2ra(30) },{ y:10, x:-10, z:-10 }, screenMaterial2, glassMaterial, reflectionCube, loader, color_dark, color_light).done(function(phoneGroup) {\n\t\t\t// TweenMax.to(phoneGroup.rotation, 1.5, {y:de2ra(0),  ease:Power4.easeOut});\n\t\t\tvar tween = TweenMax.to(phoneGroup.position, 3.5,{ y:phoneGroup.position.y-1, yoyo:true, repeat:-1, delay:0.5, ease:Power2.easeInOut, onComplete:function() {}});\t\n\t\t\tphonesGroup.add(phoneGroup);\n\t\t});\n\n\t\taddPhone({ x:de2ra(50), y:de2ra(35), z:de2ra(-80) },{ x:15, y:7,\tz:-10 }, screenMaterial, glassMaterial, reflectionCube, loader, color_dark, color_light).done(function(phoneGroup) {\n\t\t\t// TweenMax.to(phoneGroup.rotation, 1.5, {y:de2ra(0),  ease:Power4.easeOut});\n\t\t\tvar tween = TweenMax.to(phoneGroup.position, 3.5,{ y:phoneGroup.position.y-1, yoyo:true, repeat:-1, delay:0.5, ease:Power2.easeInOut, onComplete:function() {}});\t\n\t\t\tphonesGroup.add(phoneGroup);\n\t\t});\n\n\n\t\taddPhone({ x:de2ra(120), y:de2ra(0), z:de2ra(-60) },{ x:45, y:-5, z:-10 }, screenMaterial2, glassMaterial, reflectionCube, loader, color_dark, color_light).done(function(phoneGroup) {\n\t\t\t// TweenMax.to(phoneGroup.rotation, 1.5, {y:de2ra(0),  ease:Power4.easeOut});\n\t\t\tvar tween = TweenMax.to(phoneGroup.position, 3.5,{ y:phoneGroup.position.y-1, yoyo:true, repeat:-1, delay:0.5, ease:Power2.easeInOut, onComplete:function() {}});\t\t\n\t\t\tphonesGroup.add(phoneGroup);\n\t\t});\n\t\tphonesGroup.position.y=16;\n\t\tphonesGroup.rotation.z=de2ra(-15);\n\t\tphonesGroup.begin = function() {\n\n\t\t}\n\t\tphonesGroup.end = function() {\n\n\t\t}\n\n\t\tsectionObject.add(phonesGroup);\n\n\t} else if ($(section).hasClass(\"desktop\")) {\n\t\taddLaptop({x:de2ra(35), y:de2ra(-65), z:de2ra(40)}, { x:10, y:-20, z:-20}, screenMaterial, glassMaterial, reflectionCube, loader, color_dark, color_light).done(function(macbookGroup) {\n\t\t\tconsole.log(\"received macbook\", macbookGroup);\n\t\t\tsectionObject.add(macbookGroup);\n\t\t});\n\t}\n\tsectionObject.updatePosition = function() {\n\t\tthis.position.x = this.count*screenWidthFromDistance(200);\n\t}\n\tsectionObject.start = function() {\n\t\tsectionObject.video.play();\n\t\tconsole.log(\"section\", sectionObject);\n\t\tsectionObject.children[0].begin();\n\t\t$(\"body\").css(\"background\",$(section).data(\"bg-dark\"));\n\t\t$(\".current_project *\").css(\"color\",$(section).data(\"text-color\"));\n\t\tmainLight.color = rgbPercentage(hexToRgb($(section).data(\"bg-dark\")));\n\t\tvar intensity = colorIntensity(hexToRgb($(section).data(\"bg-light\")));\n\t\tgroundMaterial.opacity = map_range(intensity, 0, 1, 0.3, 0.05);\n\t}\n\tsectionObject.end = function() {\n\t\tif (typeof sectionObject.children[0] == \"object\") {\n\t\t\tsectionObject.children[0].end();\n\t\t\tconsole.log(sectionObject);\n\t\t\t// sectionObject.video.stop();\n\t\t}\n\t}\n\tstage.add( sectionObject );\n\t\n\tsetTimeout(function(sectionObject) {\n\t\tsectionObject.position.x = sectionObject.count*screenWidthFromDistance(200);\n\t},100,sectionObject);\n\treturn sectionObject;\n}\n","// var multiSearch = function() {\n// \tvar defaultSearchPlatform = \"spotify\";\n// \tvar select;\n\n\t\n// \treturn {\n// \t\tInit: function() {\n\t\t\t\n// \t\t}\n// \t}\n// }();\n\n// $(function() {\n// \tmultiSearch.Init();\n// })\n\n$(function() {\n\tinit();\n\tsetTimeout(function() {\n\t\t$(\"video\").each(function() {\n\t\t\t// this.pause();\n\t\t});\n\t},2000);\n});\n\n// if ( ! Detector.webgl ) Detector.addGetWebGLMessage();\n\nvar camera, scene, stage, renderer;\nvar mouseX = 0, prevMouseX = 0, mouseY = 0, mouseDown = false, mouseDirection;\nvar windowHalfX = window.innerWidth / 2;\nvar windowHalfY = window.innerHeight / 2;\nvar mouseDownCoord = new Object();\nvar sections = [], activeSection = 0, prevActiveSection = null, background = { light: { r:0, g:0, b:0 }, dark: { r:0, g:0, b:0 } };\nfunction init() {\n\n\tsetEnvironment();\n\tsetLights();\n\t\n\t$(\"section\").each(function(i,elm) {\n\t\tsections.push(addProject(elm,stage));\n\t\tsections[i].count=i;\n\t});\n\t$(\"section:first-child\").find(\"video\")[0].play();\n\tscrollHandler();\n\tanimate();\n}\nvar mainLight;\nvar groundMaterial;\n\nfunction setLights() {\n\tvar shadowMapSize = 512;\n\tvar groundGeometry = new THREE.PlaneGeometry( 1650, 1650, 1 );\n\tgroundMaterial = new THREE.ShadowMaterial();\n\tgroundMaterial.opacity = 0.1;\n\tvar ground = new THREE.Mesh(groundGeometry, groundMaterial);\n\tground.receiveShadow = true;\n\tground.rotation.x=55;\n\tground.position.y=-50;\n\tground.transparent = true;\n\tscene.add(ground);\n\n\tmainLight = new THREE.AmbientLight( { color:0x000000,intensity:0.02 } ); // soft white light\n\tmainLight.intensity = 0.37;\n\tscene.add( mainLight );\n\n\t\n\n\n\n\tvar spotLight1 = new THREE.SpotLight( 0xffffff); \n\tspotLight1.shadow.mapSize.height = shadowMapSize;\n\tspotLight1.shadow.mapSize.width = shadowMapSize;\n\tspotLight1.castShadow = false;\n\tspotLight1.position.set( 0, 55, 0 );\n\tspotLight1.intensity = .2;\n\tspotLight1.penumbra = 1;\n\tspotLight1.decay = 2;\n\tspotLight1.angle = .45;\n\tscene.add( spotLight1 );\n\tscene.add(spotLight1.target);\n\n\tvar spotLight2 = new THREE.SpotLight( 0xFFFFFF); \n\tspotLight2.castShadow = true;\n\tspotLight2.position.set( 0, 150, 20 ); \n\tspotLight2.shadow.mapSize.height = shadowMapSize;\n\tspotLight2.shadow.mapSize.width = shadowMapSize;\n\tspotLight2.intensity = .1;\n\tspotLight2.exponent = .05;\n\tspotLight2.penumbra = 1;\n\tspotLight2.decay = 2;\n\tspotLight2.angle = de2ra(80);\n\tspotLight2.target.position = {\n\t\tx:0,\n\t\ty:0,\n\t\tz:-40\n\t}\n\tconsole.log(spotLight2);\n\tscene.add( spotLight2 );\n\tscene.add(spotLight2.target);\n\n\n\t// var shadowGeometry = new THREE.CubeGeometry( 35, 15, 1 );\n\t// var transpMaterial = new THREE.ShadowMaterial();\n\t// transpMaterial.opacity = 0.1;\n\t// var plane = new THREE.Mesh( shadowGeometry, transpMaterial );\n\t// plane.receiveShadow = true;\n\t// plane.position.z = -2.7;\n\t// scene.add( plane );\n}\n\nfunction scrollHandler() {\n\tscrollPercentage = $(\".projects\").scrollTop() / ($(\".projects\")[0].scrollHeight-$(window).innerHeight());\n\tactiveSection = Math.floor(scrollPercentage * sections.length);\n\tif (activeSection == sections.length) activeSection -=1;\n\tif (activeSection != prevActiveSection) {\n\t\tsections[activeSection].start();\n\t\tfor (i=0;i<sections.length;i++) {\n\t\t\tif (i==activeSection) {\n\t\t\t\tconsole.log(\"starting section \",activeSection)\n\t\t\t\tsections[activeSection].start();\n\t\t\t} else {\n\t\t\t\tsections[i].end();\n\t\t\t}\n\t\t}\n\t}\n\tprevActiveSection = activeSection;\n\tvar scrollTarget = 0-scrollPercentage*(screenWidthFromDistance(200)*(sections.length-1));\n\t// stage.position.x = scrollTarget;\n\tTweenMax.to(stage.position, 0.75, {ease: Power4.easeOut, x: scrollTarget});\n}\nfunction setEnvironment() {\n\tvar container = document.createElement( 'div' );\n\tcontainer.setAttribute(\"class\",\"content\");\n\tdocument.getElementsByClassName('devices')[0].appendChild( container );\n\n\tcamera = new THREE.PerspectiveCamera( setFOV(), window.innerWidth / window.innerHeight, 1, 5000 );\n\tcamera.position.z = 120;\n\tconsole.log(camera)\n\n\tscene = new THREE.Scene();\n\tstage = new THREE.Group();\n\tscene.add(stage);\n\t$(\".projects\").bind(\"scroll\",scrollHandler);\n\t\n\tvar myAntialias=true;\n\tif (window.devicePixelRatio>1) {\n\t\tmyAntialias=false;\n\t}\n\trenderer = new THREE.WebGLRenderer( {alpha: true, antialias: myAntialias });\n\trenderer.setClearColor( 0xff0000, 0 );\n\trenderer.setPixelRatio( window.devicePixelRatio );\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\trenderer.shadowMap.enabled\t= true;\n\trenderer.shadowMap.type = THREE.PCFSoftShadowMap;\n\tcontainer.appendChild( renderer.domElement );\n\n\tvar element = renderer.domElement;\n\telement.style.position='absolute';\n\twindow.addEventListener( 'resize', onWindowResize, false );\n\tanimate();\n}\n\nfunction onWindowResize() {\n\twindowHalfX = window.innerWidth / 2;\n\twindowHalfY = window.innerHeight / 2;\n\n\tcamera.aspect = window.innerWidth / window.innerHeight;\n\tcamera.updateProjectionMatrix();\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\t// overlay.width=window.innerWidth;\n\t// overlay.height=window.innerHeight;\n\tcamera.fov = setFOV();\n\tscrollHandler();\n\tfor (i=0;i<sections.length;i++) {\n\t\tsections[i].updatePosition();\n\t}\n}\n\nvar mousePosition = { x:0, y:0 };\ndocument.addEventListener( 'mousemove', onDocumentMouseMove, false ); \nfunction onDocumentMouseMove( event ) {\n\tmouseX = windowHalfX - event.clientX;\n\tmouseY = windowHalfY - event.clientY;\n\tprevMouseX=mouseX;\n\tTweenMax.to(mousePosition, 1, {x: mouseX, y:mouseY});\n}\n\n\n\n\nfunction animate() {\n\trequestAnimationFrame( animate );\n\trender();\n}\n\nfunction render() {\n\t// var time = Date.now();\n\n\tcamera.position.x = ( mousePosition.x - camera.position.x ) * 0.003;\n\tcamera.position.y = (( - mousePosition.y - camera.position.y ) * 0.003);\n\trenderer.render( scene, camera );\n}\n\t\n\t\nfunction de2ra(degree) { \n\treturn degree*(Math.PI/180);\n}\nfunction screenWidthFromDistance(distance) {\n\tvar aspect = window.innerWidth / window.innerHeight;\n\tvar frustumHeight = 1.75 * distance * Math.tan(camera.fov * 0.5 * (Math.PI/180));\n\tvar frustumWidth = frustumHeight * aspect;\n\treturn frustumWidth;\n}\nfunction setFOV() {\n\t// var fov = map_range(window.innerWidth, 0, 100, 60, 305);\n\tfov = 40;\n\n\treturn fov;\t\n}\n\n$(\".controls a\").click(function(e) {\n\te.stopPropagation();\n});\n\n","\n\tdocument.write('<script src=\"http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1\"></' + 'script>');\n\t// console.log(\"in debug mode\");\n","(function(w, doc, undefined) {\n  // Enable strict mode\n  'use strict';\n\n  /*\n   * alias\n   * w: window global object\n   * doc: document\n   * undefined: undefined\n   */\n\n    /**\n     * constraint to jumping to the next snap-point.\n     * when scrolling further than SNAP_CONSTRAINT snap-points,\n     * but the current distance is less than 1-0.18 (read: 18 percent),\n     * the snap-will go back to the closer snap-point.\n     */\n  var CONSTRAINT = 1-0.18,\n      /*\n       * if scrolling for one snap-point only,\n       * the scroll distance must be at least 5% of the scroll-width.\n       */\n      FIRST_CONSTRAINT = 1-0.05,\n\n      /*\n       * minimum scroll distance in pixel\n       */\n      MIN_PX_CONSTRAINT = 5,\n\n      /**\n       * when scrolling for more than SNAP_CONSTRAINT snap points,\n       * a constraint is applied for scrolling to snap points in the distance.\n       * @type {Number}\n       */\n      SNAP_CONSTRAINT = 2,\n\n      /**\n       * time in ms after which scrolling is considered finished.\n       * the scroll timeouts are timed with this.\n       * whenever a new scroll event is triggered, the previous timeout is deleted.\n       * @type {Number}\n       */\n      SCROLL_TIMEOUT = 45,\n\n      /**\n       * time for the smooth scrolling\n       * @type {Number}\n       */\n      SCROLL_TIME = 768;\n\n  /**\n   * Feature detect scroll-snap-type, if it exists then do nothing (return)\n   */\n  if ('scrollSnapType' in doc.documentElement.style ||\n      'webkitScrollSnapType' in doc.documentElement.style ||\n      'msScrollSnapType' in doc.documentElement.style) {\n    // just return void to stop executing the polyfill.\n    return;\n  }\n\n  /**\n   * doMatched is a callback for Polyfill to fill in the desired behaviour.\n   * @param  {array} rules rules found for the polyfill\n   */\n  function doMatched(rules) {\n    // iterate over rules\n    rules.each(function(rule) {\n\n      var elements = doc.querySelectorAll(rule.getSelectors()),\n          declaration = rule.getDeclaration();\n\n      // iterate over elements\n      [].forEach.call(elements, function(obj) {\n        // set up the behaviour\n        setUpElement(obj, declaration);\n      });\n    });\n  }\n\n  /**\n   * unDomatched is a callback for polyfill to undo any polyfilled behaviour\n   * @param  {Object} rules\n   */\n  function undoUnmatched(rules) {\n    // iterate over rules\n    rules.each(function(rule) {\n      var elements = doc.querySelectorAll(rule.getSelectors());\n\n      // iterate over elements\n      [].forEach.call(elements, function(item) {\n        // tear down the behaviour\n        tearDownElement(item);\n      });\n    });\n  }\n\n  /**\n   * set up an element for scroll-snap behaviour\n   * @param {Object} obj         HTML element\n   * @param {Object} declaration CSS declarations\n   */\n  function setUpElement(obj, declaration) {\n    // if this is a scroll-snap element in a scroll snap container, attach to the container only.\n    if (typeof declaration['scroll-snap-coordinate'] !== 'undefined') {\n      // save declaration\n      obj.snapLengthUnit = parseSnapCoordValue(declaration);\n\n      return attachToScrollParent(obj);\n    }\n\n    // if the scroll snap attributes are applied on the body/html tag, use the doc for scroll events.\n    var tag = obj.tagName;\n    if (tag.toLowerCase() == \"body\" ||\n        tag.toLowerCase() == \"html\") {\n      obj = doc;\n    }\n\n    // add the event listener\n    obj.addEventListener('scroll', handler, false);\n\n    // save declaration\n    if (typeof declaration['scroll-snap-destination'] !== 'undefined') {\n      obj.snapLengthUnit = parseSnapCoordValue(declaration);\n    } else {\n      obj.snapLengthUnit = parseSnapPointValue(declaration);\n    }\n\n    // init possible elements\n    obj.snapElements = [];\n  }\n\n  /**\n   * tear down an element. remove all added behaviour.\n   * @param  {Object} obj DomElement\n   */\n  function tearDownElement(obj) {\n    // if the scroll snap attributes are applied on the body/html tag, use the doc for scroll events.\n    var tag = obj.tagName;\n\n    if (tag.toLowerCase() == \"body\" ||\n        tag.toLowerCase() == \"html\") {\n      obj = doc;\n    }\n\n    obj.removeEventListener('scroll', handler, false);\n\n    obj.snapLengthUnit = null;\n    obj.snapElements = [];\n  }\n\n  /**\n   * attach a child-element onto a scroll-container\n   * @param  {Object} obj\n   */\n  function attachToScrollParent(obj) {\n    var attach = obj;\n    // iterate over parent elements\n    for ( ; obj && obj !== document; obj = obj.parentNode ) {\n      if (typeof obj.snapElements !== 'undefined') {\n        obj.snapElements.push(attach);\n      }\n    }\n  }\n\n  /**\n   * the last created timeOutId for scroll event timeouts.\n   * @type int\n   */\n  var timeOutId = null;\n\n  /**\n   * starting point for current scroll\n   * @type length\n   */\n  var scrollStart = null;\n\n  /**\n   * the last object receiving a scroll event\n   */\n  var lastObj, lastScrollObj;\n\n  /**\n   * scroll handler\n   * this is the callback for scroll events.\n   */\n  var handler = function(evt) {\n\n    // use evt.target as target-element\n    lastObj = evt.target;\n    lastScrollObj = getScrollObj(lastObj);\n\n    // if currently animating, stop it. this prevents flickering.\n    if (animationFrame) {\n      // cross browser\n      if (!cancelAnimationFrame(animationFrame)) {\n        clearTimeout(animationFrame);\n      }\n    }\n\n    // if a previous timeout exists, clear it.\n    if (timeOutId) {\n      // we only want to call a timeout once after scrolling..\n      clearTimeout(timeOutId);\n    } else {\n      // save new scroll start\n      scrollStart = {y: lastScrollObj.scrollTop,\n                     x: lastScrollObj.scrollLeft};\n    }\n\n    /* set a timeout for every scroll event.\n     * if we have new scroll events in that time, the previous timeouts are cleared.\n     * thus we can be sure that the timeout will be called 50ms after the last scroll event.\n     * this means a huge improvement in speed, as we just assign a timeout in the scroll event, which will be called only once (after scrolling is finished)\n     */\n    timeOutId = setTimeout(handlerDelayed, SCROLL_TIMEOUT);\n  };\n\n  /**\n   * a delayed handler for scrolling.\n   * this will be called by setTimeout once, after scrolling is finished.\n   */\n  var handlerDelayed = function() {\n    // if we don't move a thing, we can ignore the timeout: if we did, there'd be another timeout added for scrollStart+1.\n    if(scrollStart.y == lastScrollObj.scrollTop && scrollStart.x == lastScrollObj.scrollLeft) {\n      // ignore timeout\n      return;\n    }\n\n    // detect direction of scroll. negative is up, positive is down.\n    var direction = {y: (scrollStart.y - lastScrollObj.scrollTop > 0) ? -1 : 1,\n                     x: (scrollStart.x - lastScrollObj.scrollLeft > 0) ? -1 : 1},\n        snapPoint;\n\n    if (typeof lastScrollObj.snapElements !== 'undefined' && lastScrollObj.snapElements.length > 0) {\n      snapPoint = getNextElementSnapPoint(lastScrollObj, lastObj, direction);\n    } else {\n      // get the next snap-point to snap-to\n      snapPoint = getNextSnapPoint(lastScrollObj, lastObj, direction);\n    }\n\n    // before doing the move, unbind the event handler (otherwise it calls itself kinda)\n    lastObj.removeEventListener('scroll', handler, false);\n\n    // smoothly move to the snap point\n    smoothScroll(lastScrollObj, snapPoint, function() {\n      // after moving to the snap point, rebind the scroll event handler\n      lastObj.addEventListener('scroll', handler, false);\n    });\n\n    // we just jumped to the snapPoint, so this will be our next scrollStart\n    if (!isNaN(snapPoint.x || !isNaN(snapPoint.y))) {\n      scrollStart = snapPoint;\n    }\n  };\n\n  /**\n   * calculator for next snap-point\n   * @param  {Object} obj       HTML element\n   * @param  {integer} direction signed integer indicating the scroll direction\n   * @return {Object}\n   */\n  function getNextSnapPoint(scrollObj, obj, direction) {\n    // get snap length\n    var snapLength = {y: getYSnapLength(obj, obj.snapLengthUnit.y),\n                      x: getXSnapLength(obj, obj.snapLengthUnit.x)},\n        top = scrollObj.scrollTop,\n        left = scrollObj.scrollLeft;\n\n    // calc current and initial snappoint\n    var currentPoint = {y: top / snapLength.y,\n                        x: left / snapLength.x},\n        initialPoint = {y: scrollStart.y / snapLength.y,\n                        x: scrollStart.x / snapLength.x},\n        nextPoint = {y: 0, x: 0};\n\n    // set target and bounds by direction\n    nextPoint.y = roundByDirection(direction.y, currentPoint.y);\n    nextPoint.x = roundByDirection(direction.x, currentPoint.x);\n\n    // constrain by distance\n    nextPoint.y = constrainByDistance(initialPoint.y, currentPoint.y, nextPoint.y, scrollStart.y, top);\n    nextPoint.x = constrainByDistance(initialPoint.x, currentPoint.x, nextPoint.x, scrollStart.x, left);\n\n    // calculate where to scroll\n    var scrollTo = {y: nextPoint.y * snapLength.y,\n                    x: nextPoint.x * snapLength.x};\n\n    // stay in bounds (minimum: 0, maxmimum: absolute height)\n    scrollTo.y = stayInBounds(0, getScrollHeight(scrollObj), scrollTo.y);\n    scrollTo.x = stayInBounds(0, getScrollWidth(scrollObj), scrollTo.x);\n\n    return scrollTo;\n  }\n\n\n  var currentIteratedObj = null,\n      currentIteration = 0;\n\n  function getNextElementSnapPoint(scrollObj, obj, direction) {\n    var l = obj.snapElements.length,\n        top = scrollObj.scrollTop,\n        left = scrollObj.scrollLeft,\n        // decide upon an iteration direction (favor -1, as 1 is default and will be applied when there is no direction on an axis)\n        primaryDirection = Math.min(direction.y, direction.x),\n        // get scrollable snap destination as offset\n        snapDest = {y: getYSnapLength(obj, obj.snapLengthUnit.y),\n                    x: getXSnapLength(obj, obj.snapLengthUnit.x)},\n        snapCoords = {y: 0, x: 0};\n\n\n    for(var i = currentIteration + primaryDirection; i<l && i >= 0; i = i+primaryDirection) {\n      currentIteratedObj = obj.snapElements[i];\n\n      // get objects snap coords by adding obj.top + obj.snaplength.y\n      snapCoords = {y: (currentIteratedObj.offsetTop - scrollObj.offsetTop) + getYSnapLength(currentIteratedObj, currentIteratedObj.snapLengthUnit.y),\n                    // & obj.left + obj.snaplength.x\n                    x: (currentIteratedObj.offsetLeft - scrollObj.offsetLeft) + getXSnapLength(currentIteratedObj, currentIteratedObj.snapLengthUnit.x)};\n\n      currentIteratedObj.snapCoords = snapCoords;\n      // check if object snappoint is \"close\" enough to scrollable snappoint\n\n      // not scrolled past element snap coords\n      if ((left <= snapCoords.x && left + getWidth(scrollObj) >= snapCoords.x &&\n           top <= snapCoords.y && top + getHeight(scrollObj) >= snapCoords.y)) {\n        // ok, we found a snap point.\n        currentIteration = i;\n        // stay in bounds (minimum: 0, maxmimum: absolute height)\n        return {y: stayInBounds(0, getScrollHeight(scrollObj), snapCoords.y - snapDest.y),\n                x: stayInBounds(0, getScrollWidth(scrollObj), snapCoords.x - snapDest.x)};\n      }\n    }\n    // no snap found, use first or last?\n    if (primaryDirection == 1 && i === l-1) {\n      currentIteration = l-1;\n      // the for loop stopped at the last element\n      return {y: stayInBounds(0, getScrollHeight(scrollObj), snapCoords.y - snapDest.y),\n              x: stayInBounds(0, getScrollWidth(scrollObj), snapCoords.x - snapDest.x)};\n    } else if (primaryDirection == -1 && i === 0) {\n      currentIteration = 0;\n      // the for loop stopped at the first element\n      return {y: stayInBounds(0, getScrollHeight(scrollObj), snapCoords.y - snapDest.y),\n              x: stayInBounds(0, getScrollWidth(scrollObj), snapCoords.x - snapDest.x)};\n    }\n    // stay in the same place\n    return {y: stayInBounds(0, getScrollHeight(scrollObj), obj.snapElements[currentIteration].snapCoords.y - snapDest.y),\n            x: stayInBounds(0, getScrollWidth(scrollObj), obj.snapElements[currentIteration].snapCoords.x - snapDest.x)};\n  }\n\n  /**\n   * ceil or floor a number based on direction\n   * @param  {Number} direction\n   * @param  {Number} currentPoint\n   * @return {Number}\n   */\n  function roundByDirection(direction, currentPoint) {\n    if (direction === -1) {\n      // when we go up, we floor the number to jump to the next snap-point in scroll direction\n      return Math.floor(currentPoint);\n    }\n    // go down, we ceil the number to jump to the next in view.\n    return Math.ceil(currentPoint);\n  }\n\n  /**\n   * constrain jumping\n   * @param  {Number} initialPoint\n   * @param  {Number} currentPoint\n   * @param  {Number} nextPoint\n   * @return {Number}\n   */\n  function constrainByDistance(initialPoint, currentPoint, nextPoint, scrollStart, currentScrollValue) {\n    if ((Math.abs(initialPoint - currentPoint) >= SNAP_CONSTRAINT) &&\n         Math.abs(nextPoint - currentPoint) > CONSTRAINT) {\n\n      // constrain jumping to a point too high/low when scrolling for more than SNAP_CONSTRAINT points.\n      // (if the point is 85% further than we are, don't jump..)\n      return Math.round(currentPoint);\n\n    }\n    if ((Math.abs(scrollStart-currentScrollValue) < MIN_PX_CONSTRAINT) &&\n        (Math.abs(initialPoint - currentPoint) < SNAP_CONSTRAINT) &&\n        (Math.abs(nextPoint - currentPoint) > FIRST_CONSTRAINT)) {\n      // constrain jumping to a point too high/low when scrolling just for a few pixels (less than 10 pixels) and (5% of scrollable length)\n      return Math.round(currentPoint);\n    }\n    return nextPoint;\n  }\n\n  /**\n   * keep scrolling in bounds\n   * @param  {Number} min\n   * @param  {Number} max\n   * @param  {Number} destined\n   * @return {Number}\n   */\n  function stayInBounds(min, max, destined) {\n    return Math.max(Math.min(destined, max), min);\n  }\n\n  /**\n   * parse snap point value from declaration.\n   * this uses regexp..\n   * @param  {Object} declaration\n   * @return {Object} returns an Object with the value and unit of the snap-point-y declaration\n   */\n  function parseSnapPointValue(declaration) {\n    // regex to parse lengths\n    var regex = /repeat\\((\\d+)(px|vh|vw|%)\\)/g,\n        // defaults\n        parsed = {y: {value: 0, unit: 'px'},\n                  x: {value: 0, unit: 'px'}},\n        result;\n\n    // parse y value and unit\n    if (declaration['scroll-snap-points-y'] !== 'undefined') {\n      result = regex.exec(declaration['scroll-snap-points-y']);\n      // if regexp fails, value is null\n      if (result !== null) {\n        parsed.y = {value: result[1], unit: result[2]};\n      }\n    }\n\n    // parse x value and unit\n    if (declaration['scroll-snap-points-x'] !== 'undefined') {\n      result = regex.exec(declaration['scroll-snap-points-x']);\n      // if regexp fails, value is null\n      if (result !== null) {\n        parsed.x = {value: result[1], unit: result[2]};\n      }\n    }\n    return parsed;\n  }\n\n  /**\n   * parse snap destination/coordinate values.\n   * @param  {Object} declaration\n   * @return {Object}\n   */\n  function parseSnapCoordValue(declaration) {\n    // regex to parse lengths\n    var regex = /(\\d+)(px|%) (\\d+)(px|%)/g,\n        // defaults\n        parsed = {y: {value: 0, unit: 'px'},\n                  x: {value: 0, unit: 'px'}},\n        parsable,\n        result;\n\n    if(typeof declaration['scroll-snap-coordinate'] !== 'undefined') {\n      parsable = 'scroll-snap-coordinate';\n    } else if (typeof declaration['scroll-snap-destination'] !== 'undefined') {\n      parsable = 'scroll-snap-destination';\n    }\n\n    // parse value and unit\n    if (parsable !== null) {\n      result = regex.exec(declaration[parsable]);\n      // if regexp fails, value is null\n      if (result !== null) {\n        parsed.y = {value: result[1], unit: result[2]};\n        parsed.x = {value: result[3], unit: result[4]};\n      }\n    }\n    return parsed;\n  }\n\n  /**\n   * calc length of one snap on y-axis\n   * @param  {Object} declaration the parsed declaration\n   * @return {Number}\n   */\n  function getYSnapLength(obj, declaration) {\n    if (declaration.unit == 'vh') {\n      // when using vh, one snap is the length of vh / 100 * value\n      return Math.max(doc.documentElement.clientHeight, w.innerHeight || 1) / 100 * declaration.value;\n    } else if (declaration.unit == '%') {\n      // when using %, one snap is the length of element height / 100 * value\n      return getHeight(obj) / 100 * declaration.value;\n    } else {\n      // when using px, one snap is the length of element height / value\n      return getHeight(obj) / declaration.value;\n    }\n\n    return 0;\n  }\n\n  /**\n   * calc length of one snap on x-axis\n   * @param  {Object} declaration the parsed declaration\n   * @return {Number}\n   */\n  function getXSnapLength(obj, declaration) {\n    if (declaration.unit == 'vw') {\n      // when using vw, one snap is the length of vw / 100 * value\n      return Math.max(doc.documentElement.clientWidth, w.innerWidth || 1) / 100 * declaration.value;\n    } else if (declaration.unit == '%') {\n      // when using %, one snap is the length of element width / 100 * value\n      return getWidth(obj) / 100 * declaration.value;\n    } else {\n      // when using px, one snap is the length of element width / value\n      return getWidth(obj) / declaration.value;\n    }\n\n    return 0;\n  }\n\n  /**\n   * get an elements scrollable height\n   * @param  {Object} obj\n   * @return {Number}\n   */\n  function getScrollHeight(obj) {\n    return obj.scrollHeight;\n  }\n\n  /**\n   * get an elements scrollable width\n   * @param  {Object} obj\n   * @return {Number}\n   */\n  function getScrollWidth(obj) {\n    return obj.scrollWidth;\n  }\n\n  /**\n   * get an elements height\n   * @param  {Object} obj\n   * @return {Number}\n   */\n  function getHeight(obj) {\n    return obj.offsetHeight;\n  }\n\n  /**\n   * get an elements width\n   * @param  {Object} obj\n   * @return {Number}\n   */\n  function getWidth(obj) {\n    return obj.offsetWidth;\n  }\n\n  /**\n   * return the element scrolling values are applied to.\n   * when receiving window.onscroll events, the actual scrolling is on the body.\n   * @param  {Object} obj\n   * @return {Object}\n   */\n  function getScrollObj(obj) {\n    // if the scroll container is body, the scrolling is invoked on window/doc.\n    if (obj == doc || obj == w) {\n      // firefox scrolls on doc.documentElement\n      if (doc.documentElement.scrollTop > 0 || doc.documentElement.scrollLeft > 0) {\n        return doc.documentElement;\n      }\n      // chrome scrolls on body\n      return doc.querySelector('body');\n    }\n\n    return obj;\n  }\n\n  /**\n   * calc the duration of the animation proportional to the distance travelled\n   * @param  {Number} start\n   * @param  {Number} end\n   * @return {Number}       scroll time in ms\n   */\n  function getDuration(start, end) {\n    var distance = Math.abs(start - end),\n        procDist = 100 / Math.max(doc.documentElement.clientHeight, w.innerHeight || 1) * distance,\n        duration = 100 / SCROLL_TIME * procDist;\n\n    if (isNaN(duration)) {\n      return 0;\n    }\n\n    return Math.max(SCROLL_TIME / 1.5, Math.min(duration, SCROLL_TIME));\n  }\n\n  /**\n   * ease in out function thanks to:\n   * http://blog.greweb.fr/2012/02/bezier-curve-based-easing-functions-from-concept-to-implementation/\n   * @param  {Number} t timing\n   * @return {Number}   easing factor\n   */\n  var easeInCubic = function(t) {\n    return t*t*t;\n  };\n\n\n  /**\n   * calculate the scroll position we should be in\n   * @param  {Number} start    the start point of the scroll\n   * @param  {Number} end      the end point of the scroll\n   * @param  {Number} elapsed  the time elapsed from the beginning of the scroll\n   * @param  {Number} duration the total duration of the scroll (default 500ms)\n   * @return {Number}          the next position\n   */\n  var position = function(start, end, elapsed, duration) {\n      if (elapsed > duration) {\n        return end;\n      }\n      return start + (end - start) * easeInCubic(elapsed / duration);\n  };\n\n  // a current animation frame\n  var animationFrame = null;\n\n  /**\n   * smoothScroll function by Alice Lietieur.\n   * @see https://github.com/alicelieutier/smoothScroll\n   * we use requestAnimationFrame to be called by the browser before every repaint\n   * @param  {Object}   obj      the scroll context\n   * @param  {Number}  end      where to scroll to\n   * @param  {Number}   duration scroll duration\n   * @param  {Function} callback called when the scrolling is finished\n   */\n  var smoothScroll = function(obj, end, callback) {\n    var start = {y: obj.scrollTop, x: obj.scrollLeft},\n\n        clock = Date.now(),\n\n        // get animation frame or a fallback\n        requestAnimationFrame = w.requestAnimationFrame ||\n                                w.mozRequestAnimationFrame ||\n                                w.webkitRequestAnimationFrame ||\n                                function(fn){w.setTimeout(fn, 15);},\n        duration = Math.max(getDuration(start.y, end.y), getDuration(start.x, end.x));\n\n      // setup the stepping function\n      var step = function() {\n\n        // calculate timings\n        var elapsed = Date.now() - clock;\n\n        // change position on y-axis if result is a number.\n        if (!isNaN(end.y)) {\n          obj.scrollTop = position(start.y, end.y, elapsed, duration);\n        }\n\n        // change position on x-axis if result is a number.\n        if (!isNaN(end.x)) {\n          obj.scrollLeft = position(start.x, end.x, elapsed, duration);\n        }\n\n        // check if we are over due\n        if (elapsed > duration) {\n          // is there a callback?\n          if (typeof callback === 'function') {\n            // stop execution and run the callback\n            return callback(end);\n          }\n\n          // stop execution\n          return;\n        }\n\n        // use a new animation frame\n        animationFrame = requestAnimationFrame(step);\n      };\n\n      // start the first step\n      step();\n  };\n\n  /**\n   * Polyfill object\n   * @type Polyfill\n   * @see https://github.com/philipwalton/polyfill\n   */\n  var pf = new Polyfill({\n    declarations:[\"scroll-snap-type:*\", \"scroll-snap-point-y:*\", \"scroll-snap-coordinate:*\", \"scroll-snap-destination:*\"]\n  })\n  .doMatched(doMatched)\n  .undoUnmatched(undoUnmatched);\n\n}(window, document));","function map_range(value, low1, high1, low2, high2) {\n    return low2 + (high2 - low2) * (value - low1) / (high1 - low1);\n}\nfunction hexToRgb(r,t){var n=/^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(r),a=function(){return void 0==this.alpha?\"rgb(\"+this.r+\", \"+this.g+\", \"+this.b+\")\":(this.alpha>1?this.alpha=1:this.alpha<0&&(this.alpha=0),\"rgba(\"+this.r+\", \"+this.g+\", \"+this.b+\", \"+this.alpha+\")\")};return void 0==t?n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16),toString:a}:null:(t>1?t=1:0>t&&(t=0),n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16),alpha:t,toString:a}:null)}\nfunction rgbToHex(r,t,n){function a(r){var t=r.toString(16);return 1==t.length?\"0\"+t:t}if(void 0==t||void 0==n){if(\"string\"==typeof r){var i=/^rgb[a]?\\(([\\d]+)[ \\n]*,[ \\n]*([\\d]+)[ \\n]*,[ \\n]*([\\d]+)[ \\n]*,?[ \\n]*([.\\d]+)?[ \\n]*\\)$/i.exec(r);return rgbToHex(parseInt(i[1]),parseInt(i[2]),parseInt(i[3]))}return void 0==r.r||void 0==r.g||void 0==r.b?null:rgbToHex(r.r,r.g,r.b)}var e=r;return\"#\"+a(e)+a(t)+a(n)}\nfunction rgbPercentage(obj) {\n\tobj.r = obj.r/255;\n\tobj.b = obj.b/255;\n\tobj.g = obj.g/255;\n\treturn obj;\n}\nfunction colorIntensity(obj) {\n\tconsole.log(\"intensity\",obj)\n\treturn (obj.r/255+obj.g/255+obj.b/255)/3;\n}"]}
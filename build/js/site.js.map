{"version":3,"sources":["_tools.js","addText.js","add_device.js","add_project.js","bezier-easing.js","customMaterial.js","interface.js","jquery.panelSnap.js","jquery.scalem.js","livereload.js","navigate.js","route_links.js","set_lights.js"],"names":["map_range","value","low1","high1","low2","high2","hexToRgb","r","t","n","exec","a","this","alpha","g","b","parseInt","toString","rgbToHex","length","i","e","rgbPercentage","obj","colorIntensity","fps","startTime","frameNumber","average","framesCounted","secondsCounted","getFPS","d","Date","getTime","currentTime","result","Math","floor","reset","animateText","setLetterPosition","headline","$","each","elm","abs","proximity","tOpacity","TweenMax","to","parentNode","opacity","onComplete","y","ease","Power4","easeOut","register","container","document","createElement","className","body","appendChild","name","innerHTML","scalem","maxSize","snapWrapper","bind","ref","setTimeout","animateHeadline","animatesIn","console","log","render","sections","scrollHandler","loadPhone","loader","deferred","Deferred","phoneModel","returnPhone","clone","resolve","screenGeometry","THREE","PlaneGeometry","material","MeshBasicMaterial","color","phoneGroup","Mesh","receiveShadow","position","z","glass","glassMaterial","add","load","geometry","materials","MeshPhongMaterial","object","castShadow","traverse","child","computeVertexNormals","scale","set","promise","addPhone","rotation","screenMaterial","color_dark","color_light","done","x","children","emissive","shininess","loadLaptop","macbookModel","returnMac","macbookPivot","Object3D","macbookGroup","macbookScreenGroup","metalMaterial","side","DoubleSide","MeshStandardMaterial","metalness","roughness","desktopGeometry","desktopScreen","de2ra","desktopGlass","bodyMaterial","screen","addLaptop","specular","transparent","reflectivity","combine","MixOperation","addProject","section","stage","count","resizeHandler","area","screenWidth","screenWidthFromDistance","camera","sectionObject","Group","globalDistance","visible","window","JSONLoader","video","find","vl","pause","screenMaterialArray","Array","materialArray","im","tagName","push","customMaterial","data","html","tween","loaded","hasClass","deviceType","phonesGroup","startRotationPoint","yoyo","repeat","delay","Power2","easeInOut","begin","end","kickstart","updateRotation","getProximity","lidAngle","play","type","targetRotation","updatePosition","start","addClass","kickOffSite","css","mainLight","intensity","groundMaterial","removeClass","checkLoad","A","aA1","aA2","B","C","calcBezier","aT","getSlope","binarySubdivide","aX","aA","aB","mX1","mX2","currentX","currentT","SUBDIVISION_PRECISION","SUBDIVISION_MAX_ITERATIONS","newtonRaphsonIterate","aGuessT","NEWTON_ITERATIONS","currentSlope","NEWTON_MIN_SLOPE","kSplineTableSize","kSampleStepSize","float32ArraySupported","Float32Array","BezierEasing","mY1","mY2","getTForX","intervalStart","currentSample","lastSample","sampleValues","dist","guessForT","initialSlope","Error","element","texture","TextureLoader","src","VideoTexture","minFilter","LinearFilter","magFilter","format","RGBFormat","wrapS","ClampToEdgeWrapping","wrapT","anisotropy","map","startSection","$activeSection","activeSection","init","options","$menu","menuSelector","panelSelector","namespace","onSnapStart","onSnapFinish","onActivate","directionThreshold","slideSpeed","easing","offset","navigation","keys","nextKey","prevKey","buttons","$nextButton","$prevButton","wrapAround","panelSnap","setEnvironment","setLights","animate","goToCaseStudy","goToFrontPage","sectionNo","localScroll","scrollTop","scrollHeight","scrollPercentage","height","progression","prevActiveSection","no","resume","scrollTarget","pixelRatio","devicePixelRatio","setAttribute","getElementsByClassName","PerspectiveCamera","setFOV","innerWidth","innerHeight","myTarget","Vector3","lookAt","scene","Scene","myAntialias","renderer","WebGLRenderer","antialias","setClearColor","setPixelRatio","setSize","shadowMap","enabled","PCFSoftShadowMap","domElement","style","addEventListener","onWindowResize","windowHalfX","windowHalfY","aspect","updateProjectionMatrix","fov","onDocumentMouseMove","event","clientX","storedMouse","clientY","mouseX","mouseY","prevMouseX","mousePosition","Power1","windowInFocus","frameCount","pixelRatioSwitchCount","degree","PI","distance","frustumHeight","tan","frustumWidth","width","mouseDown","mouseDirection","mouseDownCoord","Object","background","light","dark","ticker","requestAnimationFrame","hasData","setInterval","focus","blur","click","stopPropagation","create","F","prototype","pluginName","storageName","pluginObject","isMouseDown","isSnapping","scrollOffset","self","$container","$eventContainer","$snapContainer","is","scrollingElement","documentElement","ua","navigator","userAgent","indexOf","extend","fn","$target","getPanel","activatePanel","bindProxied","scrollStop","mouseWheel","mouseUp","resize","captureMenuClick","keyDown","captureNextClick","capturePrevClick","$element","method","selector","on","proxy","call","destroy","off","removeData","panelsInViewPort","getPanelsInViewport","eq","panelNumber","scrollDifference","overThreshold","maxOffset","scrollInterval","snapToPanel","viewport","top","bottom","panels","filter","_","el","bounds","$el","outerHeight","stop","nav","which","preventDefault","snapTo","panel","currentTarget","jquery","trigger","activeItemSelector","attribute","itemSelector","$itemToActivate","$panels","index","attr","target","wrap","enable","disable","toggle","args","slice","arguments","pluginInstance","apply","error","jQuery","special","scrollstart","setup","scrolling","$this","timer","isTouching","thisObject","clearTimeout","scrollstop","resizestart","resizing","resizestop","handler","orgEvent","delta","deltaX","deltaY","fix","wheelDelta","detail","undefined","axis","HORIZONTAL_AXIS","wheelDeltaY","wheelDeltaX","unshift","dispatch","handle","types","fixHooks","mouseHooks","mousewheel","onmousewheel","teardown","removeEventListener","unmousewheel","unbind","oOptions","oSettings","ratio","reference","styles","updateStyles","o","nTargetWidth","nTextWidth","$o","$oP","parent","$o2","display","white-space","$ref","getAttribute","aStyles","split","nRatio","max","parseFloat","nMaxSize","nRefWidth","isNaN","appendTo","remove","round","o2","fontSize","nScale","oStyles","imax","location","host","write","$headline","Ease","href","shadowMapSize","groundGeometry","ShadowMaterial","ground","AmbientLight","spotLight2","SpotLight","shadow","mapSize","exponent","penumbra","decay","angle"],"mappings":"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","file":"site.js","sourcesContent":["function map_range(value, low1, high1, low2, high2) {\n    return low2 + (high2 - low2) * (value - low1) / (high1 - low1);\n}\nfunction hexToRgb(r,t){var n=/^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(r),a=function(){return void 0==this.alpha?\"rgb(\"+this.r+\", \"+this.g+\", \"+this.b+\")\":(this.alpha>1?this.alpha=1:this.alpha<0&&(this.alpha=0),\"rgba(\"+this.r+\", \"+this.g+\", \"+this.b+\", \"+this.alpha+\")\")};return void 0==t?n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16),toString:a}:null:(t>1?t=1:0>t&&(t=0),n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16),alpha:t,toString:a}:null)}\nfunction rgbToHex(r,t,n){function a(r){var t=r.toString(16);return 1==t.length?\"0\"+t:t}if(void 0==t||void 0==n){if(\"string\"==typeof r){var i=/^rgb[a]?\\(([\\d]+)[ \\n]*,[ \\n]*([\\d]+)[ \\n]*,[ \\n]*([\\d]+)[ \\n]*,?[ \\n]*([.\\d]+)?[ \\n]*\\)$/i.exec(r);return rgbToHex(parseInt(i[1]),parseInt(i[2]),parseInt(i[3]))}return void 0==r.r||void 0==r.g||void 0==r.b?null:rgbToHex(r.r,r.g,r.b)}var e=r;return\"#\"+a(e)+a(t)+a(n)}\nfunction rgbPercentage(obj) {\n\tobj.r = obj.r/255;\n\tobj.b = obj.b/255;\n\tobj.g = obj.g/255;\n\treturn obj;\n}\nfunction colorIntensity(obj) {\n\treturn (obj.r/255+obj.g/255+obj.b/255)/3;\n}\nvar fps = {\t\n\tstartTime : 0,\t\n\tframeNumber : 0,\n\taverage : 60,\n\tframesCounted : 60,\n\tsecondsCounted : 1,\n\tgetFPS : function(){\n\t\tthis.frameNumber++;\t\t\n\t\tvar d = new Date().getTime(), currentTime = ( d - this.startTime ) / 1000, result = Math.floor( ( this.frameNumber / currentTime ) );\n\t\t\n\t\tif( currentTime > 1 ){\n\t\t\tthis.framesCounted+=result\n\t\t\tthis.secondsCounted++;\n\t\t\tthis.startTime = new Date().getTime();\n\t\t\tthis.frameNumber = 0;\n\t\t\tthis.average = this.framesCounted/this.secondsCounted\n\t\t\t// $(\"span.fps\").html(this.average);\n\t\t}\n\t\t\n\t\treturn result;\n\t},\n\treset : function() {\n\t\tthis.framesCounted=0;\n\t\tthis.secondsCounted=0;\n\t}\n};\n","var animateText = function() {\n\tvar _this = this;\n\t\n\tfunction setLetterPosition(obj) {\n\t\tvar headline = $(obj.headline);\n\t\theadline.each(function(i,elm) {\n\t\t\t if (Math.abs(obj.proximity<.15)) {\n\t\t\t\tvar tOpacity=map_range(Math.abs(obj.proximity), 0, .15, 1, 0)\n\t\t\t\tif (tOpacity<0) tOpacity=0;\n\t\t\t\tTweenMax.to(elm.parentNode, .5, { opacity:tOpacity, onComplete:function() {}})\n\t\t\t} else {\n\t\t\t\tvar tOpacity=0;\n\t\t\t\tTweenMax.to(elm.parentNode, .5, { opacity:tOpacity, onComplete:function() {}})\n\t\t\t}\n\t\t\t\n\t\t\tTweenMax.to(elm, 5, { y:Math.abs(obj.proximity)*30, ease:Power4.easeOut, onComplete:function() {}})\n\t\t\t\n\t\t\t\n\t\t});\n\t}\n\n\n\treturn {\n\t\tregister: function(obj) {\n\t\t\t// _this.elm = obj.elm;\n\t\t\tobj.proximity=.25;\n\t\t\tvar container = document.createElement(\"div\");\n\t\t\tcontainer.className = \"current_project\";\n\t\t\tdocument.body.appendChild(container);\n\n\t\t\t// var cta = document.createElement(\"a\");\n\t\t\t// cta.className=\"cta\";\n\t\t\t// cta.innerHTML = \"See more\";\n\t\t\t// $(\"footer\")[0].appendChild(cta);\n\t\t\t\n\t\t\tvar name = document.createElement(\"h2\");\n\t\t\t// var nameHTML=\"\";\n\t\t\t// for (i=0;i<obj.name.length;i++) {\n\t\t\t// \tnameHTML+=\"<span>\"+obj.name[i]+\"</span>\";\n\t\t\t// }\n\t\t\tname.innerHTML='<a href=\"#\">'+obj.name+'</a>';\n\t\t\tcontainer.appendChild(name);\n\n\t\t\tobj.headline = name;\n\n\n\n\n\t\t\t$(\".current_project h2\").scalem({maxSize:175});\n\n\t\t\tsnapWrapper.bind(\"scroll\",function() {\n\t\t\t\tsetLetterPosition(obj);\n\t\t\t});\n\t\t\t\n\t\t\tcontainer.ref= obj.ref;\n\t\t\tsetLetterPosition(obj);\n\t\t\tsetTimeout(setLetterPosition,1000,obj);\n\t\t},\n\t\tanimateHeadline: function(obj, animatesIn) {\n\t\t\tvar headline = obj.headline;\n\t\t\t// console.log(\"headline\",$(headline));\n\t\t\tif (animatesIn) {\n\t\t\t\tconsole.log(headline);\n\t\t\t\t// animateIn(headline);\n\t\t\t} else {\n\t\t\t\t// animateOut(headline);\n\t\t\t}\n\t\t},\n\t\trender: function() {\n\t\t\tfor (i=0;i<sections.length;i++) {\n\t\t\t\tscrollHandler(sections[i]);\n\t\t\t}\n\t\t}\n\t}\n}();\n","var phoneModel = null;\nvar macbookModel = null;\n\nvar glassMaterial = new THREE.MeshPhongMaterial({ color: 0xffffff  });\nglassMaterial.specular.r=1;\nglassMaterial.specular.g=1;\nglassMaterial.specular.b=1;\nglassMaterial.transparent = true;\nglassMaterial.opacity = 0.05;\nglassMaterial.shininess = 20;\n// glassMaterial.envMap = reflectionCube;\nglassMaterial.reflectivity = 5;\nglassMaterial.combine = THREE.MixOperation;\n\nvar metalMaterial = new THREE.MeshStandardMaterial({ side: THREE.DoubleSide, color:0xffffff, metalness:0.5, roughness:1});\nfunction loadPhone(loader) {\n\tvar deferred = new $.Deferred();\n\tif (phoneModel!=null) {\n\t\tconsole.log(\"cloning\");\n\t\tvar returnPhone = phoneModel.clone();\n\t\tdeferred.resolve(returnPhone);\n\t} else {\n\t\t\n\t\tvar screenGeometry = new THREE.PlaneGeometry( 0.55, 1, 1 );\n\t\tvar material = new THREE.MeshBasicMaterial({ color: 0xffffff });\n\t\t\n\n\t\tvar phoneGroup = new THREE.Mesh( screenGeometry, material );\n\t\tphoneGroup.receiveShadow = false;\n\t\tphoneGroup.position.z = 0.022;\n\t\tphoneGroup.position.y = 0.05;\n\n\t\t// var glassMaterial = new THREE.MeshStandardMaterial({ side: THREE.DoubleSide, color:0x222222, emissive:0x0, metalness:0.7, roughness:0.2, envMap:reflectionCube });\n\t\tvar glass = new THREE.Mesh( screenGeometry, glassMaterial );\n\t\tglass.receiveShadow = false;\n\t\tglass.position.z = 0.0225;\n\t\tglass.position.y = 0.05;\n\t\tphoneGroup.add(glass);\n\n\t\tloader.load(\n\t\t\t'models/iphones7.json',\n\t\t\tfunction ( geometry, materials ) {\n\t\t\t\tvar material = new THREE.MeshPhongMaterial(materials[0])\n\t\t\t\tvar object = new THREE.Mesh( geometry, material );\t\t\t\t\n\t\t\t\tobject.position.y=-0.6;\n\t\t\t\tobject.castShadow=true;\n\t\t\t\tobject.receiveShadow = false;\n\t\t\t\tphoneGroup.add( object );\n\t\t\t\tobject.name=\"iphoneFront\";\n\t\t\t\tobject.traverse( function ( child ) {\n\t\t\t\t\t// child.geometry.computeFaceNormals();\n\t\t\t        phoneGroup.position.y=-5;\n\t\t\t        phoneGroup.position.z=-1;\t\t      \n\t\t\t\t\t\t\n\t\t    \t});\n\t\t    \tloader.load(\n\t\t\t\t\t'models/iphone-back.json',\n\t\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\t\tvar material = new THREE.MeshPhongMaterial(materials[0])\n\t\t\t\t\t\tvar object = new THREE.Mesh( geometry, material );\t\t\t\t\n\t\t\t\t\t\tobject.position.y=-0.6;\n\t\t\t\t\t\tobject.castShadow=true;\n\t\t\t\t\t\tobject.receiveShadow = false;\n\t\t\t\t\t\tobject.name=\"iphoneBack\"\n\t\t\t\t\t\tphoneGroup.add( object );\n\t\t\t\t\t\tobject.traverse( function ( child ) {\n\t\t\t\t\t\t\t// child.geometry.computeFaceNormals();\n\t\t\t\t\t\t\tchild.geometry.computeVertexNormals();\n\t\t\t\t\t        phoneGroup.position.y=-5;\n\t\t\t\t\t        phoneGroup.position.z=-1;\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tphoneGroup.scale.set( 30, 30, 30 );\n\t\t\t\t\t\t\tphoneGroup.castShadow = true;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tphoneModel = phoneGroup;\n\t\t\t\t\t\t\tdeferred.resolve(phoneGroup);\n\t\t\t\t    \t})\t\t\t\t    \t\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t}\n\treturn deferred.promise();\n}\n\nfunction addPhone(rotation, position, screenMaterial, loader, color_dark, color_light) {\n\tvar deferred = new $.Deferred();\n\tloadPhone(loader).done(function(phoneGroup) {\n\t\tphoneGroup.position.z=position.z;\n\t\tphoneGroup.position.y=position.y;\n\t\tphoneGroup.position.x=position.x;\n\t\tphoneGroup.rotation.x=rotation.x;\n\t\tphoneGroup.rotation.y=rotation.y;\n\t\tphoneGroup.rotation.z=rotation.z;\n\t\tphoneGroup.children[0].material = screenMaterial;\n\t\tphoneGroup.children[1].material.emissive.r = (color_dark.r/255);\n\t\tphoneGroup.children[1].material.emissive.g = (color_dark.g/255);\n\t\tphoneGroup.children[1].material.emissive.b = (color_dark.b/255);\n\t\tphoneGroup.children[1].material.color.r = (color_light.r/255);\n\t\tphoneGroup.children[1].material.color.g = (color_light.g/255);\n\t\tphoneGroup.children[1].material.color.b = (color_light.b/255);\n\t\tphoneGroup.children[2].material.emissive.r = (color_dark.r/255);\n\t\tphoneGroup.children[2].material.emissive.g = (color_dark.g/255);\n\t\tphoneGroup.children[2].material.emissive.b = (color_dark.b/255);\n\t\tphoneGroup.children[2].material.color.r = (color_light.r/255);\n\t\tphoneGroup.children[2].material.color.g = (color_light.g/255);\n\t\tphoneGroup.children[2].material.color.b = (color_light.b/255);\n\t\tphoneGroup.children[2].material.shininess = 10;\n\n\t\tdeferred.resolve(phoneGroup);\n\t});\n\treturn deferred.promise();\n}\n\nfunction loadLaptop(screenMaterial, loader, color_dark, color_light) {\n\tvar deferred = new $.Deferred();\n\tif (macbookModel!=null) {\n\t\tconsole.log(\"cloning\");\n\t\tvar returnMac = macbookModel.clone();\n\t\tdeferred.resolve(returnMac);\n\t} else {\n\t    \n\t\tvar macbookPivot = new THREE.Object3D();\n\t\tvar macbookGroup = new THREE.Mesh();\n\t\tvar macbookScreenGroup = new THREE.Mesh();\n\t\tmacbookScreenGroup.name = \"screenGroup\";\n\n\t\tloader.load(\n\t\t\t// resource URL\n\t\t\t'models/screen-back.json',\n\t\t\t// Function when resource is loaded\n\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t// var material = new THREE.MultiMaterial( materials );\n\t\t\t\tvar material = new THREE.MeshPhongMaterial(materials[0])\n\t\t\t\tvar object = new THREE.Mesh( geometry, metalMaterial );\n\t\t\t\t// scene.add( object );\n\t\t\t\t\n\t\t\t\tobject.position.y=0;\n\t\t\t\tobject.position.x=-0.5;\n\t\t\t\tobject.position.z=0;\n\t\t\t\tobject.name = \"screenBack\";\n\t\t\t\tobject.receiveShadow = false;\n\t\t\t\tobject.castShadow=true;\n\t\t\t\tmaterial.shininess = 0.2;\n\t\t\t\tobject.traverse( function ( child ) {\n\t\t\t        // console.log(\"screen\",object);\n\t\t\t        if ( child instanceof THREE.Mesh ) {\n\t\t\t            child.geometry.computeVertexNormals();\n\t\t\t        }\n\t\t\t        object.material.side=THREE.DoubleSide;\n\t\t\t    });\n\t\t\t    macbookScreenGroup.add(object);\n\t\t\t    // console.log(\"loaded screen back 1\");\n\t\t\t    loader.load(\n\t\t\t\t\t'models/screen-front.json',\n\t\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\t\tvar material = new THREE.MeshStandardMaterial({ side: THREE.DoubleSide, color:0x0f0f0f, emissive:0x0, metalness:0.7, roughness:0.2 });\n\t\t\t\t\t\tvar object = new THREE.Mesh( geometry, material );\t\t\t\t\n\t\t\t\t\t\tobject.position.y=0;\n\t\t\t\t\t\tobject.position.x=-0.5;\n\t\t\t\t\t\tobject.position.z=0;\n\t\t\t\t\t\t// object.rotation.y=de2ra(180);\n\t\t\t\t\t\tvar color_dark = {\n\t\t\t\t\t\t\tr:0,\n\t\t\t\t\t\t\tg:0,\n\t\t\t\t\t\t\tb:0\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar color_light = color_dark;\n\t\t\t\t\t\tobject.castShadow=false;\n\t\t\t\t\t\tobject.receiveShadow = false;\n\t\t\t\t\t\tmacbookScreenGroup.add( object );\n\t\t\t\t\t\tvar desktopGeometry = new THREE.PlaneGeometry( 8.7, 5.8, 1 );\n\n\t\t\t\t\t\tvar desktopScreen = new THREE.Mesh( desktopGeometry, material );\n\t\t\t\t\t\tdesktopScreen.name=\"screenFront\"\n\t\t\t\t\t\tdesktopScreen.position.z = -3.16;\n\t\t\t\t\t\tdesktopScreen.position.y = 3.3;\n\t\t\t\t\t\tdesktopScreen.rotation.x = de2ra(1);\n\n\t\t\t\t\t\tmacbookScreenGroup.add(desktopScreen);\n\n\t\t\t\t\t\tvar desktopGlass = new THREE.Mesh(desktopGeometry, glassMaterial);\n\t\t\t\t\t\tdesktopGlass.receiveShadow = true;\n\t\t\t\t\t\tdesktopGlass.position.z = -3.16;\n\t\t\t\t\t\tdesktopGlass.position.y = 3.3;\n\t\t\t\t\t\tdesktopGlass.rotation.x = de2ra(1);\n\t\t\t\t\t\tmacbookScreenGroup.add(desktopGlass);\n\t\t\t\t\t\t\n\t\t\t\t\t\tmacbookScreenGroup.position.z=3.1;\n\t\t\t\t\t\tmacbookPivot.add(macbookScreenGroup);\n\t\t\t\t\t\tmacbookPivot.position.z=-3;\n\t\t\t\t\t\tmacbookPivot.position.y=0;\n\t\t\t\t\t\tmacbookPivot.rotation.x=de2ra(90);\n\t\t\t\t\t\t\n\t\t\t\t\t\tmacbookGroup.add(macbookPivot);\n\n\t\t\t\t\t\t// console.log(\"loaded screen front 2\");\n\t\t\t\t\t\tloader.load(\n\t\t\t\t\t\t\t'models/keyboard.json',\n\t\t\t\t\t\t\tfunction ( geometry, materials ) {\n\n\t\t\t\t\t\t\t\tvar bodyMaterial = new THREE.MeshStandardMaterial({ side: THREE.DoubleSide, color:0xbdbdbd, metalness:0.2, roughness:1});\n\t\t\t\t\t\t\t\tvar object = new THREE.Mesh( geometry, bodyMaterial );\n\t\t\t\t\t\t\t\tobject.position.x=-0.5;\n\t\t\t\t\t\t\t\tobject.castShadow=false;\n\t\t\t\t\t\t\t\tobject.receiveShadow = true;\n\t\t\t\t\t\t\t\tobject.material.shininess = 10;\n\t\t\t\t\t\t\t\tmacbookGroup.add( object );\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// console.log(\"loaded keyboard 3\");\n\t\t\t\t\t\t\t\tloader.load(\n\t\t\t\t\t\t\t\t\t// resource URL\n\t\t\t\t\t\t\t\t\t'models/keys.json',\n\t\t\t\t\t\t\t\t\t// Function when resource is loaded\n\t\t\t\t\t\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\t\t\t\t\t\tvar material = new THREE.MeshPhongMaterial(materials[0])\n\t\t\t\t\t\t\t\t\t\tvar object = new THREE.Mesh( geometry, material );\n\t\t\t\t\t\t\t\t\t\t// scene.add( object );\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tobject.position.y=0.005;\n\t\t\t\t\t\t\t\t\t\t// object.position.y=0.06;\n\t\t\t\t\t\t\t\t\t\tobject.position.x=-0.5;\n\t\t\t\t\t\t\t\t\t\tobject.position.z=0;\n\t\t\t\t\t\t\t\t\t\tobject.receiveShadow = true;\n\t\t\t\t\t\t\t\t\t\tobject.castShadow=true;\n\n\t\t\t\t\t\t\t\t\t\tmacbookGroup.add( object );\n\t\t\t\t\t\t\t\t\t\t// console.log(\"loaded keys 4\");\n\t\t\t\t\t\t\t\t    \tloader.load(\n\t\t\t\t\t\t\t\t\t\t\t// resource URL\n\t\t\t\t\t\t\t\t\t\t\t'models/keys-top.json',\n\t\t\t\t\t\t\t\t\t\t\t// Function when resource is loaded\n\t\t\t\t\t\t\t\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\t\t\t\t\t\t\t\tvar material = new THREE.MeshPhongMaterial(materials[0])\n\t\t\t\t\t\t\t\t\t\t\t\tvar object = new THREE.Mesh( geometry, material );\n\t\t\t\t\t\t\t\t\t\t\t\tobject.name=\"keysTop\";\n\t\t\t\t\t\t\t\t\t\t\t\tobject.position.y=0.005;\n\t\t\t\t\t\t\t\t\t\t\t\tobject.position.x=-0.5;\n\t\t\t\t\t\t\t\t\t\t\t\tobject.position.z=0;\n\t\t\t\t\t\t\t\t\t\t\t\tobject.receiveShadow = false;\n\t\t\t\t\t\t\t\t\t\t\t\tobject.castShadow=false;\n\t\t\t\t\t\t\t\t\t        \tobject.material.side=THREE.DoubleSide;\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tobject.material.shininess=0;\t\n\t\t\t\t\t\t\t\t\t        \n\t\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.scale.set(6.25,6.25,6.25);\n\t\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.add( object );\n\t\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.screen = macbookPivot;\n\t\t\t\t\t\t\t\t\t\t\t\tmacbookModel = macbookGroup;\n\t\t\t\t\t\t\t\t\t\t    \tdeferred.resolve(macbookGroup);\n\t\t\t\t\t\t\t\t\t\t    }\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t    }\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t}\n\t\n\treturn deferred.promise();\n}\nfunction addLaptop(rotation, position, screenMaterial, loader, color_dark, color_light) {\n\tvar deferred = new $.Deferred();\n\tloadLaptop( screenMaterial, loader).done(function(macbookGroup) {\n\t\tmacbookGroup.position.z=position.z;\n\t\tmacbookGroup.position.y=position.y;\n\t\tmacbookGroup.position.x=position.x;\n\t\tmacbookGroup.rotation.x = rotation.x;\n\t\tmacbookGroup.rotation.y = rotation.y;\n\t\tmacbookGroup.rotation.z = rotation.z;\n\n\t\tmacbookGroup.children[0].children[0].children[2].material = screenMaterial;\n\n\t\tdeferred.resolve(macbookGroup);\n\t});\n\treturn deferred.promise();\n}","function addProject(section, stage, count) {\n\tvar sectionObject = new THREE.Group();\n\tsectionObject.count=count;\n\tsectionObject.position.y = sectionObject.count * -1*screenWidthFromDistance(globalDistance);\n\tif (count>0) sectionObject.visible = false;\n\tvar area = {};\n\tfunction resizeHandler() {\n\t\tarea.screenWidth=screenWidthFromDistance(camera.position.z);\n\t}\n\t$(window).bind(\"resize\",resizeHandler);\n\tresizeHandler();\n\t\n\tvar loader = new THREE.JSONLoader();\n\tvar screenMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });\t\n\tvar video = $(section).find(\"video\");\n\tfor (var vl=0;vl<video.length;vl++) {\n\t\tvideo[vl].pause();\n\t\tsectionObject.video = video[vl];\n\t}\n\n\tvar screenMaterialArray = new Array();\n\n\tvar materialArray = $(section)[0].children;\n\tfor (im = 0; im < materialArray.length; im++) {\n\t\t\n\t\tif (materialArray[im].tagName==\"IMG\" || materialArray[im].tagName==\"VIDEO\") {\t\t\t\n\t\t\tscreenMaterialArray.push(customMaterial(materialArray[im]));\n\t\t}\t\t\n\t}\n\tvar glassMaterial = new THREE.MeshPhongMaterial({ color: 0xffffff  });\n\tglassMaterial.specular.r=1;\n\tglassMaterial.specular.g=1;\n\tglassMaterial.specular.b=1;\n\tglassMaterial.transparent = true;\n\tglassMaterial.opacity = 0.05;\n\tglassMaterial.shininess = 20;\n\t// glassMaterial.envMap = reflectionCube;\n\tglassMaterial.reflectivity = 5;\n\tglassMaterial.combine = THREE.MixOperation;\n\t\n\tvar emDarken = 1;\n\tvar color_light = hexToRgb($(section).data(\"device-light\"));\n\tvar color_dark = hexToRgb($(section).data(\"device-dark\"));\n\n\t\n\tsectionObject.elm = section;\n\n\tsectionObject.name=$(section).find(\"h2\").html()\n\tsectionObject.tween = [];\n\tsectionObject.loaded=0;\n\tsectionObject.ref = section;\n\tif ($(section).hasClass(\"mobile\")) {\n\t\tsectionObject.deviceType=\"mobile\";\n\t\tvar phonesGroup = new THREE.Group();\n\t\taddPhone({ x:de2ra(60), y:de2ra(-140), z:de2ra(30) }, { x:-10, y:4, z:-8 }, screenMaterialArray[1], loader, color_dark, color_light).done(function(phoneGroup) {\n\t\t\t// TweenMax.to(phoneGroup.rotation, 1.5, {y:de2ra(0),  ease:Power4.easeOut});\n\t\t\tphoneGroup.startRotationPoint = 60;\n\t\t\tphonesGroup.add(phoneGroup);\n\t\t\tsectionObject.loaded+=.333333;\n\t\t\tsectionObject.tween.push(TweenMax.to(phoneGroup.position, 3.5,{ y:phoneGroup.position.y-1, yoyo:true, repeat:-1, delay:0, ease:Power2.easeInOut, onComplete:function() {}}));\n\t\t\t// console.log(\"phone added\");\n\t\t\taddPhone({ x:de2ra(50), y:de2ra(35), z:de2ra(-80) }, { x:15, y:1, z:-8 }, screenMaterialArray[0], loader, color_dark, color_light).done(function(phoneGroup) {\n\t\t\t\t// TweenMax.to(phoneGroup.rotation, 1.5, {y:de2ra(0),  ease:Power4.easeOut});\n\t\t\t\tsectionObject.tween.push(TweenMax.to(phoneGroup.position, 3.5,{ y:phoneGroup.position.y-1, yoyo:true, repeat:-1, delay:0.5, ease:Power2.easeInOut, onComplete:function() {}}));\t\n\t\t\t\tphoneGroup.startRotationPoint = 50;\n\t\t\t\tphonesGroup.add(phoneGroup);\n\t\t\t\tsectionObject.loaded+=.333333;\n\t\t\t\t// console.log(\"phone added\");\n\t\t\t\taddPhone({ x:de2ra(120), y:de2ra(0), z:de2ra(-60) },{ x:45, y:-11, z:-8 }, screenMaterialArray[2], loader, color_dark, color_light).done(function(phoneGroup) {\n\t\t\t\t\t// TweenMax.to(phoneGroup.rotation, 1.5, {y:de2ra(0),  ease:Power4.easeOut});\n\t\t\t\t\tsectionObject.tween.push(TweenMax.to(phoneGroup.position, 3.5,{ y:phoneGroup.position.y-1, yoyo:true, repeat:-1, delay:1.5, ease:Power2.easeInOut, onComplete:function() {}}));\n\t\t\t\t\tphoneGroup.startRotationPoint = 120;\n\t\t\t\t\tphonesGroup.add(phoneGroup);\n\t\t\t\t\tsectionObject.loaded+=.333333;\n\t\t\t\t\t// console.log(\"phone added\");\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\t\n\n\t\tphonesGroup.position.y=5;\n\t\tphonesGroup.position.z=15;\n\t\t// phonesGroup.rotation.z=de2ra(-15);\n\t\tphonesGroup.position.x=-12\n\t\tphonesGroup.begin = function() {\n\n\t\t}\n\t\tphonesGroup.end = function() {\n\n\t\t}\n\t\tphonesGroup.startRotationPoint = 12\n\t\tsectionObject.add(phonesGroup);\n\n\t} else if ($(section).hasClass(\"desktop\")) {\n\t\tsectionObject.deviceType=\"desktop\";\n\t\t// console.log(\"print out\",screenMaterialArray[0],screenMaterialArray[1])\n\t\taddLaptop({x:de2ra(60), y:de2ra(0), z:de2ra(0)}, { x:0, y:-48.5, z:10}, screenMaterialArray[0], loader, color_dark, color_light).done(function(macbookGroup) {\n\t\t\t// console.log(\"received macbook\", macbookGroup);\n\t\t\tsectionObject.loaded+=1.5;\n\t\t\tsectionObject.macbookGroup = macbookGroup;\n\t\t\tmacbookGroup.startRotationPoint = 0;\n\t\t\tmacbookGroup.opacity = 0;\n\t\t\tmacbookGroup.begin = function() {\n\t\t\t\t// console.log(\"macbook open\");\n\t\t\t\t// var openLid = TweenMax.to(macbookGroup.screen.rotation, 1.3, { x:-de2ra(20), delay:1.25, ease:Power4.easeOut});\n\t\t\t}\n\t\t\tmacbookGroup.end = function() {\n\t\t\t\t// var openLid = TweenMax.to(macbookGroup.screen.rotation, 1, { x:de2ra(90), ease:Power4.easeOut});\n\t\t\t}\n\t\t\t\n\t\t\t// sectionObject.tween.push(TweenMax.to(macbookGroup.position, 3.5,{ y:macbookGroup.position.y-1, yoyo:true, repeat:-1, ease:Power2.easeInOut, onComplete:function() {}}));\n\t\t\tif (sectionObject.loaded==1) {\n\t\t\t\tscrollHandler();\n\t\t\t}\n\t\t\tif (sectionObject.kickstart) {\n\t\t\t\tmacbookGroup.begin()\n\t\t\t}\n\t\t\tsectionObject.add(macbookGroup);\n\t\t});\n\t\taddPhone({ x:de2ra(-15), y:de2ra(10), z:de2ra(15) },{ x:-50, y:-25, z:0 }, screenMaterialArray[1], loader, color_dark, color_light).done(function(phoneGroup) {\n\t\t\t// TweenMax.to(phoneGroup.rotation, 1.5, {y:de2ra(0),  ease:Power4.easeOut});\n\t\t\tvar phonesGroup = new THREE.Group();\n\t\t\t\n\t\t\t// phonesGroup.rotation.z=de2ra(-15);\n\t\t\tphoneGroup.scale.x = 16;\n\t\t\tphoneGroup.scale.y = 16;\n\t\t\tphoneGroup.scale.z = 16;\n\t\t\tphonesGroup.begin = function() {\n\n\t\t\t}\n\t\t\tphonesGroup.end = function() {\n\n\t\t\t}\n\t\t\tphonesGroup.startRotationPoint = 0;\n\t\t\tphoneGroup.startRotationPoint = -30;\n\t\t\tphonesGroup.add(phoneGroup);\n\t\t\t\n\t\t\t// sectionObject.tween.push(TweenMax.to(phoneGroup.position, 3.5,{ y:phoneGroup.position.y-1, yoyo:true, repeat:-1, delay:0.5, ease:Power2.easeInOut, onComplete:function() {}}));\n\t\t\tsectionObject.loaded=1;\n\t\t\tsectionObject.loaded+=.5;\n\n\t\t\tscrollHandler();\n\n\t\t\tsectionObject.add(phonesGroup);\n\n\t\t});\n\t}\n\tsectionObject.updateRotation = function() {\n\t\tif (typeof sectionObject.macbookGroup!=\"undefined\") {\n\t\t\tif (sectionObject.deviceType==\"desktop\" && Math.abs(getProximity(this.count))<1) {\n\t\t\t\tvar lidAngle = map_range(Math.abs(getProximity(this.count)),-0.15,0,90,20);\n\t\t\t\tif (lidAngle<-90) lidAngle = -90;\n\t\t\t\tTweenMax.to(sectionObject.macbookGroup.screen.rotation, 1, { x:-de2ra(lidAngle), ease:Power4.easeOut})\n\t\t\t}\n\t\t}\n\t\tif (Math.abs(this.proximity)<0.1) {\n\t\t\tif (this.video) this.video.play();\n\t\t\tfor (t=0;t<this.tween.length;t++) {\n\t\t\t\tthis.tween[t].play();\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.video) this.video.pause();\n\t\t\tfor (t=0;t<this.tween.length;t++) {\n\t\t\t\tthis.tween[t].pause();\n\t\t\t}\n\t\t}\n\t\ttry {\n\t\t\tif (this.children[0].children[0].type==\"Group\" && this.children[0].children.length>2) { //phones\n\t\t\t\tvar targetRotation =  this.children[0].startRotationPoint+(this.proximity*100);\n\t\t\t\tfor (r=0;r<this.children[0].children.length; r++) {\n\t\t\t\t\tthis.children[0].children[r].rotation.x=de2ra(this.children[0].children[r].startRotationPoint+(this.proximity*200));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar targetRotation =  this.children[0].startRotationPoint+(this.proximity*100);\n\t\t\t\tthis.children[0].children[1].rotation.x=de2ra(this.children[0].children[1].startRotationPoint+(this.proximity*-200));\n\t\t\t}\n\t\t\tthis.children[0].rotation.y=de2ra(targetRotation);\n\t\t\t\n\t\t} catch(e) {\n\n\t\t}\n\n\t}\n\tsectionObject.updatePosition = function() {\n\t\t// this.position.x = this.count*screenWidthFromDistance(200);\n\t\tthis.position.y = sectionObject.count * -1*screenWidthFromDistance(globalDistance);\n\t}\n\tsectionObject.start = function(object) {\n\n\t\tif (typeof this.loaded == \"undefined\" || typeof sectionObject.headline == \"undefined\") {\n\t\t\tsetTimeout(function() {\n\t\t\t\tsectionObject.start()\n\t\t\t},50);\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\t\n\t\t$(sectionObject.headline.parentNode).addClass(\"active\");\n\t\tkickOffSite();\n\t\t\n\t\t$(\"body\").css(\"background\",$(section).data(\"bg-dark\")).css(\"color\",$(section).data(\"text-color\"));\n\n\t\t$(\"nav .toggle span\").css(\"background-color\",$(section).data(\"text-color\"));\n\t\tmainLight.color = rgbPercentage(hexToRgb($(section).data(\"bg-dark\")));\n\t\tvar intensity = colorIntensity(hexToRgb($(section).data(\"bg-light\")));\n\t\tTweenMax.to(groundMaterial, 1,{ opacity:map_range(intensity, 0, 1, 0.3, 0.04), onComplete:function() {}})\n\n\n\t\tfor (var a=0;a<sectionObject.children.length;a++) {\n\t\t\t// console.log(\"sectionobject child\",a);\n\t\t\tif (typeof sectionObject.children[a].begin != \"undefined\") {\n\t\t\t\tsectionObject.children[a].begin();\n\t\t\t}\n\t\t}\n\t\tsectionObject.kickstart=true;\n\t}\n\tsectionObject.end = function() {\n\n\t\tfor (var a=0;a<sectionObject.children.length;a++) {\n\t\t\t// console.log(\"sectionobject child\",a);\n\t\t\tif (typeof sectionObject.children[a].end != \"undefined\") {\n\t\t\t\tsectionObject.children[a].end();\n\t\t\t}\n\t\t}\n\t\tif (typeof sectionObject.headline ==\"object\") {\n\t\t\t$(sectionObject.headline.parentNode).removeClass(\"active\");\n\t\t}\n\t}\n\tstage.add( sectionObject );\n\t\n\tsectionObject.checkLoad = function() {\n\t\tif (sectionObject.loaded>0.98) {\n\t\t\tanimateText.register(sectionObject);\n\t\t\tscrollHandler();\n\t\t} else {\n\t\t\tsetTimeout(sectionObject.checkLoad,100);\n\t\t}\n\t}\n\tsectionObject.checkLoad();\n\tsetTimeout(function(sectionObject) {\n\t\t// sectionObject.position.y = sectionObject.count*screenWidthFromDistance(200);\n\t\tsectionObject.position.y = sectionObject.count * -1*screenWidthFromDistance(globalDistance);\n\t},100,sectionObject);\n\treturn sectionObject;\n}\n","/**\n * https://github.com/gre/bezier-easing\n * BezierEasing - use bezier curve for transition easing function\n * by Gaëtan Renaudeau 2014 - 2015 – MIT License\n */\n\n// These values are established by empiricism with tests (tradeoff: performance VS precision)\nvar NEWTON_ITERATIONS = 4;\nvar NEWTON_MIN_SLOPE = 0.001;\nvar SUBDIVISION_PRECISION = 0.0000001;\nvar SUBDIVISION_MAX_ITERATIONS = 10;\n\nvar kSplineTableSize = 11;\nvar kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n\nvar float32ArraySupported = typeof Float32Array === 'function';\n\nfunction A (aA1, aA2) { return 1.0 - 3.0 * aA2 + 3.0 * aA1; }\nfunction B (aA1, aA2) { return 3.0 * aA2 - 6.0 * aA1; }\nfunction C (aA1)      { return 3.0 * aA1; }\n\n// Returns x(t) given t, x1, and x2, or y(t) given t, y1, and y2.\nfunction calcBezier (aT, aA1, aA2) { return ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT; }\n\n// Returns dx/dt given t, x1, and x2, or dy/dt given t, y1, and y2.\nfunction getSlope (aT, aA1, aA2) { return 3.0 * A(aA1, aA2) * aT * aT + 2.0 * B(aA1, aA2) * aT + C(aA1); }\n\nfunction binarySubdivide (aX, aA, aB, mX1, mX2) {\n  var currentX, currentT, i = 0;\n  do {\n    currentT = aA + (aB - aA) / 2.0;\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\n    if (currentX > 0.0) {\n      aB = currentT;\n    } else {\n      aA = currentT;\n    }\n  } while (Math.abs(currentX) > SUBDIVISION_PRECISION && ++i < SUBDIVISION_MAX_ITERATIONS);\n  return currentT;\n}\n\nfunction newtonRaphsonIterate (aX, aGuessT, mX1, mX2) {\n for (var i = 0; i < NEWTON_ITERATIONS; ++i) {\n   var currentSlope = getSlope(aGuessT, mX1, mX2);\n   if (currentSlope === 0.0) {\n     return aGuessT;\n   }\n   var currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n   aGuessT -= currentX / currentSlope;\n }\n return aGuessT;\n}\nBezierEasing = function (mX1, mY1, mX2, mY2) {\n  if (!(0 <= mX1 && mX1 <= 1 && 0 <= mX2 && mX2 <= 1)) {\n    throw new Error('bezier x values must be in [0, 1] range');\n  }\n\n  // Precompute samples table\n  var sampleValues = float32ArraySupported ? new Float32Array(kSplineTableSize) : new Array(kSplineTableSize);\n  if (mX1 !== mY1 || mX2 !== mY2) {\n    for (var i = 0; i < kSplineTableSize; ++i) {\n      sampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n    }\n  }\n\n  function getTForX (aX) {\n    var intervalStart = 0.0;\n    var currentSample = 1;\n    var lastSample = kSplineTableSize - 1;\n\n    for (; currentSample !== lastSample && sampleValues[currentSample] <= aX; ++currentSample) {\n      intervalStart += kSampleStepSize;\n    }\n    --currentSample;\n\n    // Interpolate to provide an initial guess for t\n    var dist = (aX - sampleValues[currentSample]) / (sampleValues[currentSample + 1] - sampleValues[currentSample]);\n    var guessForT = intervalStart + dist * kSampleStepSize;\n\n    var initialSlope = getSlope(guessForT, mX1, mX2);\n    if (initialSlope >= NEWTON_MIN_SLOPE) {\n      return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n    } else if (initialSlope === 0.0) {\n      return guessForT;\n    } else {\n      return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n    }\n  }\n\n  return function bezierEasing (x) {\n    if (mX1 === mY1 && mX2 === mY2) {\n      return x; // linear\n    }\n    // Because JavaScript number are imprecise, we should guarantee the extremes are right.\n    if (x === 0) {\n      return 0;\n    }\n    if (x === 1) {\n      return 1;\n    }\n    return calcBezier(getTForX(x), mY1, mY2);\n  };\n};","function customMaterial(element) {\n\tvar screenMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });\n\tif (element.tagName==\"IMG\") {\n\t\tvar texture = new THREE.TextureLoader().load( element.src);\n\t} else if (element.tagName==\"VIDEO\") {\n\t\tvar texture = new THREE.VideoTexture( element );\n\t}\n\ttexture.minFilter = THREE.LinearFilter;\n\ttexture.magFilter = THREE.LinearFilter;\n\ttexture.format = THREE.RGBFormat;\n\ttexture.wrapS = THREE.ClampToEdgeWrapping;\n\ttexture.wrapT = THREE.ClampToEdgeWrapping;\n\ttexture.anisotropy = 0.5;\n\tscreenMaterial.map = texture;\n\treturn screenMaterial;\n}","$(function() {\n\tinit();\n});\n\nvar globalDistance = 200;\nif ($(window).height()>$(window).width()) globalDistance = 300;\n\nvar snapWrapper = $(\".projects\");\nvar camera, scene, stage, renderer;\nvar mouseX = 0, prevMouseX = 0, mouseY = 0, mouseDown = false, mouseDirection;\nvar windowHalfX = window.innerWidth / 2;\nvar windowHalfY = window.innerHeight / 2;\nvar mouseDownCoord = new Object();\nvar sections = [], progression = 0, activeSection = 0, prevActiveSection = null, background = { light: { r:0, g:0, b:0 }, dark: { r:0, g:0, b:0 } };\nfunction startSection() {\n\t$activeSection = $(\".projects > section:nth-child(\"+(activeSection+1)+\")\"); \n  \t$(\"a.cta\").removeClass(\"off\");\n  \t$(\"a.back\").removeClass(\"off\");\n\t$(\"a.cta, a.back\").css(\"color\",$activeSection.data(\"text-color\"));\n  \t$(\"a.cta .arrow, a.back .arrow\").css(\"background-color\",$activeSection.data(\"text-color\"));\n}\nfunction init() {\n\tvar options = {\n\t  $menu: false,\n\t  menuSelector: 'a',\n\t  panelSelector: '> section',\n\t  namespace: '.panelSnap',\n\t  onSnapStart: function(){ \n\t  \tif (!$(\"body\").hasClass(\"article\")) $(\"a.cta\").addClass(\"off\") \n\t  },\n\t  onSnapFinish: function(){  \n\t  \t// console.log(\"snap finish\"); \n\t  \tif (!$(\"body\").hasClass(\"article\")) startSection();\n\t  },\n\t  onActivate: function(){ \n\t  \t// console.log(\"snap activate\");\n\t  },\n\t  directionThreshold: 10,\n\t  slideSpeed: 400,\n\t  delay: 0,\n\t  easing: 'swing',\n\t  offset: 0,\n\t  navigation: {\n\t    keys: {\n\t      nextKey: false,\n\t      prevKey: false,\n\t    },\n\t    buttons: {\n\t      $nextButton: false,\n\t      $prevButton: false,\n\t    },\n\t    wrapAround: false\n\t  }\n\t};\n\n\tsnapWrapper.panelSnap(options);\n\tsnapWrapper.bind(\"scroll\",scrollHandler);\n\n\tsetEnvironment();\n\tsetLights();\n\tscrollHandler();\n\tanimate();\n\t$(\".projects section\").each(function(i,elm) {\n\t\tsections.push(addProject(elm,stage,i));\n\t});\n\t$(\"a.cta\").bind(\"click\",goToCaseStudy);\n\t$(\"a.back\").bind(\"click\",goToFrontPage);\n}\n\nfunction getProximity(sectionNo) {\n\t\n\tvar localScroll = snapWrapper.scrollTop() / snapWrapper[0].scrollHeight;\n\t\n\treturn (sectionNo) - (localScroll * sections.length);\n}\nfunction scrollHandler() {\n\tif (!$(\"body\").hasClass(\"article\")) {\n\t\tscrollPercentage = snapWrapper.scrollTop() / (snapWrapper[0].scrollHeight-$(\"section\",snapWrapper).height());\t\n\t\tprogression = scrollPercentage * sections.length;\n\n\t\tactiveSection = Math.floor(progression);\n\n\t\tif (activeSection == sections.length) activeSection -=1;\n\t\tif (activeSection != prevActiveSection) {\n\t\t\tfor (i=0;i<sections.length;i++) {\n\t\t\t\tif (i==activeSection) {\n\t\t\t\t\tsections[activeSection].start();\n\t\t\t\t\tfor (no=0;no<sections[i].tween.length;no++) {\n\t\t\t\t\t\tsections[i].tween[no].resume();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsections[i].end();\n\t\t\t\t\tfor (no=0;no<sections[i].tween.length;no++) {\n\t\t\t\t\t\tsections[i].tween[no].pause();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvar inProximity=[];\n\t\tfor (i=0;i<sections.length;i++) {\n\t\t\tsections[i].proximity = getProximity(i);\n\t\t\tsections[i].updateRotation();\n\t\t\t\n\t\t\tif (sections[i].proximity>-0.75 && sections[i].proximity<0.75) {\n\t\t\t\tsections[i].visible = true;\n\t\t\t} else {\n\t\t\t\tsections[i].visible = true;\n\t\t\t}\n\t\t}\n\t\tprevActiveSection = activeSection;\n\t\tvar scrollTarget = 0-scrollPercentage*(screenWidthFromDistance(globalDistance)*(sections.length-1));\n\t\tTweenMax.to(stage.position, 0.75, {ease: Power4.easeOut, y: -1*scrollTarget});\n\t}\n}\nfunction setEnvironment() {\n\tvar pixelRatio = window.devicePixelRatio;\n\tif (pixelRatio==1) {\n\t\tpixelRatio=1.5;\n\t} else {\n\t\tpixelRatio=2;\n\t}\n\tvar container = document.createElement( 'div' );\n\tcontainer.setAttribute(\"class\",\"content\");\n\tdocument.getElementsByClassName('devices')[0].appendChild( container );\n\n\tcamera = new THREE.PerspectiveCamera( setFOV(), window.innerWidth / window.innerHeight, 1, 5000 );\n\tcamera.position.z = 115;\n\tcamera.myTarget = new THREE.Vector3(0,50,0);\n\n\tcamera.lookAt(camera.myTarget);\n\n\tscene = new THREE.Scene();\n\tstage = new THREE.Group();\n\tscene.add(stage);\n\t\n\t\n\tvar myAntialias=false;\n\tif (pixelRatio>1) {\n\t\tmyAntialias=false;\n\t}\n\n\trenderer = new THREE.WebGLRenderer( {alpha: true, antialias: myAntialias });\n\t// renderer.setClearColor( 0xff0000, 0 );\n\trenderer.setClearColor( 0x000000, 0 );\n\trenderer.setPixelRatio( pixelRatio );\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\trenderer.shadowMap.enabled\t= true;\n\trenderer.shadowMap.type = THREE.PCFSoftShadowMap;\n\tcontainer.appendChild( renderer.domElement );\n\n\tvar element = renderer.domElement;\n\telement.style.position='absolute';\n\twindow.addEventListener( 'resize', onWindowResize, false );\n}\n\nfunction onWindowResize() {\n\twindowHalfX = window.innerWidth / 2;\n\twindowHalfY = window.innerHeight / 2;\n\n\tcamera.aspect = window.innerWidth / window.innerHeight;\n\tcamera.updateProjectionMatrix();\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\tcamera.fov = setFOV();\n\tscrollHandler();\n\tfor (i=0;i<sections.length;i++) {\n\t\tsections[i].updatePosition();\n\t}\n}\nfunction kickOffSite() {\n\tif (!$(\"body\").hasClass(\"loaded\")) {\n\t\tTweenMax.to(camera.myTarget, 2, {x:0, y:0, z:0, delay:.7, ease:Power4.easeOut});\n\t\tsetTimeout(function() {\n\t\t\t$(\"body\").addClass(\"loaded\");\n\t\t\tstartSection();\n\t\t},2000);\n\t\tsetTimeout(function() {\n\t\t\tsections[activeSection].updateRotation();\n\t\t},1000);\n\t}\n}\n\nvar mousePosition = { x:0, y:0 };\ndocument.addEventListener( 'mousemove', onDocumentMouseMove, false );\n\nvar storedMouse = { x:0, y:0 };\nfunction onDocumentMouseMove( event ) {\n\tif (typeof event == \"undefined\") {\n\t\tvar event = {\n\t\t\tclientX: storedMouse.x,\n\t\t\tclientY: storedMouse.y\n\t\t}\n\t}\n\tstoredMouse.x = event.clientX;\n\tstoredMouse.y = event.clientY;\n\tmouseX = windowHalfX - event.clientX;\n\tmouseY = windowHalfY - event.clientY;\n\tprevMouseX=mouseX;\n\tTweenMax.to(mousePosition, 1, {x: mouseX, y:mouseY, ease: Power1.easeOut});\n}\n\nTweenMax.ticker.addEventListener(\"tick\",function() {\n\trequestAnimationFrame(animate);\n});\nvar hasData=false;\nsetTimeout(function() {\n\thasData=true\n},4000);\nvar pixelRatioSwitchCount=-1;\nsetInterval(fps.reset, 10000);\nvar windowInFocus=true;\n$(window).focus(function() {\n\twindowInFocus=true;\n\tconsole.log(\"window in focus\");\n});\n$(window).blur(function() {\n\twindowInFocus=false;\n\tconsole.log(\"window out of focus\");\n});\n\nframeCount=0;\nfunction animate() {\n\tif (!windowInFocus) {\n\t\tif (frameCount>2) {\n\t\t\t// console.log(frameCount);\n\t\t\trender();\n\t\t\tframeCount=0;\n\t\t\tpixelRatioSwitchCount=0;\n\t\t} \n\t} else {\n\t\trender();\n\t}\n\tframeCount++;\n\t// if (typeof renderer!=\"undefined\" && windowInFocus) {\n\t// \tif (renderer.getPixelRatio()<2 && !renderer.antialias) {\n\t// \t\trenderer.antialias=true;\n\t// \t} else {\n\t// \t\tif (renderer.antialias && renderer.getPixelRatio()>=2) renderer.antialias=false;\n\t// \t}\n\t// \tfps.getFPS()\n\t// \tif (pixelRatioSwitchCount<4 && hasData) {\n\t// \t\tif (fps.average < 25) {\n\t// \t\t\tif (renderer.getPixelRatio() != 1) {\n\t// \t\t\t\trenderer.setPixelRatio( 1 );\n\t// \t\t\t\tpixelRatioSwitchCount+=1;\n\t// \t\t\t}\n\t// \t\t} else if (fps.average < 35) {\n\t// \t\t\tif (renderer.getPixelRatio() != 1.5) {\n\t// \t\t\t\tconsole.log(\"set pixel ratio 1.5\");\n\t// \t\t\t\trenderer.setPixelRatio( 1.5 );\n\t// \t\t\t\tpixelRatioSwitchCount+=1;\n\t// \t\t\t}\n\t// \t\t} else {\n\t// \t\t\tif (renderer.getPixelRatio() != 2) {\n\t// \t\t\t\tconsole.log(\"set pixel ratio 2\");\n\t// \t\t\t\trenderer.setPixelRatio( 2 );\n\t// \t\t\t\tpixelRatioSwitchCount+=1;\n\t// \t\t\t}\n\t// \t\t}\n\t// \t} else {\n\t// \t\tif (hasData) {\n\t// \t\t\tif (fps.average>25) {\n\t// \t\t\t\tconsole.log(\"set pixel ratio 1.5\");\n\t// \t\t\t\trenderer.setPixelRatio( 1.5 );\n\t// \t\t\t} else {\n\t// \t\t\t\trenderer.setPixelRatio( 1 );\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t// }\n}\n\nfunction render() {\n\t// var time = Date.now();\n\t// console.log(camera);\n\tif (typeof camera != \"undefined\") {\n\t\tcamera.position.x = 0- ( mousePosition.x - camera.position.x ) * 0.009;\n\t\tcamera.position.y = 0 - (( - mousePosition.y - camera.position.y ) * 0.009);\n\t\tcamera.lookAt(camera.myTarget);\n\t\trenderer.render( scene, camera );\n\t}\n}\n\t\n\t\nfunction de2ra(degree) { \n\treturn degree*(Math.PI/180);\n}\nfunction screenWidthFromDistance(distance) {\n\tvar aspect = window.innerWidth / window.innerHeight;\n\tvar frustumHeight = 1.75 * distance * Math.tan(camera.fov * 0.5 * (Math.PI/180));\n\tvar frustumWidth = frustumHeight * aspect;\n\treturn frustumWidth;\n}\nfunction setFOV() {\n\t// var fov = map_range(window.innerWidth, 0, 100, 60, 305);\n\tfov = 40;\n\tif (window.innerWidth<600) {\n\t\tfov=70;\n\t}\n\treturn fov;\t\n}\n\n$(\".controls a\").click(function(e) {\n\te.stopPropagation();\n});\n\n","/**\n * Copyright (c) 2013-present, Guido Bouman\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/* global jQuery */\n\n// Utility for creating objects in older browsers\nif (typeof Object.create !== 'function') {\n  Object.create = function (obj) {\n    function F() { }\n    F.prototype = obj;\n    return new F();\n  };\n}\n\n/*!\n * jQuery panelSnap\n * Version 0.15.1\n *\n * Requires:\n * - jQuery 1.7 or higher (no jQuery.migrate needed)\n *\n * https://github.com/guidobouman/jquery-panelsnap\n */\n(function ($, window, document) {\n  'use strict';\n\n  var pluginName = 'panelSnap';\n  var storageName = 'plugin_' + pluginName;\n\n  var pluginObject = {\n\n    isMouseDown: false,\n    isSnapping: false,\n    enabled: true,\n    scrollOffset: 0,\n\n    init: function (options, container) {\n      var self = this;\n\n      self.container = container;\n      self.$container = $(container);\n\n      self.$eventContainer = self.$container;\n      self.$snapContainer = self.$container;\n\n      if (self.$container.is('body')) {\n        self.$eventContainer = $(document);\n        self.$snapContainer = $(document.scrollingElement || document.documentElement);\n\n        var ua = navigator.userAgent;\n        if (ua.indexOf('WebKit') !== -1 && ua.indexOf('Chrome') === -1) {\n          self.$snapContainer = $('body');\n        }\n      }\n\n      self.options = $.extend(true, {}, $.fn.panelSnap.options, options);\n\n      self.bind();\n\n      if (self.options.$menu !== false && $('.active', self.options.$menu).length > 0) {\n        $('.active', self.options.$menu).click();\n      } else {\n        var $target = self.getPanel(':first');\n        self.activatePanel($target);\n      }\n\n      return self;\n    },\n\n    bind: function () {\n      var self = this;\n\n      self.bindProxied(self.$eventContainer, 'scrollstop', self.scrollStop);\n      self.bindProxied(self.$eventContainer, 'mousewheel', self.mouseWheel);\n      self.bindProxied(self.$eventContainer, 'mousedown', self.mouseDown);\n      self.bindProxied(self.$eventContainer, 'mouseup', self.mouseUp);\n\n      self.bindProxied($(window), 'resizestop', self.resize);\n\n      if (self.options.$menu) {\n        self.bindProxied(self.options.$menu, 'click', self.captureMenuClick, self.options.menuSelector);\n      }\n\n      if (self.options.navigation.keys.nextKey || self.options.navigation.keys.prevKey) {\n        self.bindProxied($(window), 'keydown', self.keyDown);\n      }\n\n      if (self.options.navigation.buttons.$nextButton) {\n        self.bindProxied(self.options.navigation.buttons.$nextButton, 'click', self.captureNextClick);\n      }\n\n      if (self.options.navigation.buttons.$prevButton) {\n        self.bindProxied(self.options.navigation.buttons.$prevButton, 'click', self.capturePrevClick);\n      }\n    },\n\n    bindProxied: function ($element, event, method, selector) {\n      var self = this;\n\n      selector = typeof selector === 'string' ? selector : null;\n\n      $element.on(event + self.options.namespace, selector, $.proxy(function (e) {\n        return method.call(self, e);\n      }, self));\n    },\n\n    destroy: function () {\n      var self = this;\n\n      // Gotta love namespaced events!\n      self.$eventContainer.off(self.options.namespace);\n\n      $(window).off(self.options.namespace);\n\n      if (self.options.$menu !== false) {\n        $(self.options.menuSelector, self.options.$menu).off(self.options.namespace);\n      }\n\n      self.$container.removeData(storageName);\n    },\n\n    scrollStop: function (e) {\n      var self = this;\n      var $target;\n\n      e.stopPropagation();\n\n      if (self.isMouseDown) {\n        return;\n      }\n\n      if (self.isSnapping) {\n        return;\n      }\n\n      // Check if enabled or just 1 panel in viewport\n      var panelsInViewPort = self.getPanelsInViewport();\n      if (!self.enabled || panelsInViewPort.length < 2) {\n        $target = panelsInViewPort.eq(0);\n        if (!$target.is(self.getPanel('.active'))) {\n          self.activatePanel($target);\n        }\n\n        return;\n      }\n\n      var offset = self.$snapContainer.scrollTop();\n      var scrollDifference = offset - self.scrollOffset;\n      var overThreshold = Math.abs(scrollDifference) > self.options.directionThreshold;\n\n      var panelNumber;\n      if (scrollDifference > 0) {\n        panelNumber = overThreshold ? 1 : 0;\n      } else if (scrollDifference < 0) {\n        panelNumber = overThreshold ? 0 : 1;\n      } else {\n        // Nothing to scroll, get out.\n        return;\n      }\n\n      $target = panelsInViewPort.eq(panelNumber);\n\n      var maxOffset = self.$container[0].scrollHeight - self.scrollInterval;\n      if (offset <= 0 || offset >= maxOffset) {\n        // Only activate, prevent stuttering\n        self.activatePanel($target);\n        // Set scrollOffset to a sane number for next scroll\n        self.scrollOffset = offset <= 0 ? 0 : maxOffset;\n      } else {\n        self.snapToPanel($target);\n      }\n    },\n\n    getPanelsInViewport: function () {\n      var self = this;\n\n      var viewport = { top: self.$snapContainer.scrollTop() };\n      viewport.bottom = viewport.top + self.$snapContainer.height();\n\n      var panels = self.getPanel().filter(function (_, el) {\n        var $el = $(el);\n        var bounds;\n\n        if (self.$container.is('body')) {\n          bounds = $el.offset();\n        } else {\n          bounds = $el.position();\n          bounds.top += self.$snapContainer.scrollTop();\n        }\n\n        bounds.bottom = bounds.top + $el.outerHeight();\n\n        return !(viewport.bottom < bounds.top || viewport.top > bounds.bottom);\n      });\n\n      return panels;\n    },\n\n    mouseWheel: function () {\n      var self = this;\n\n      // This event only fires when the user actually scrolls with their input device.\n      // Be it a trackpad, legacy mouse or anything else.\n\n      if (self.isSnapping) {\n        self.scrollOffset = self.$snapContainer.scrollTop();\n        self.$snapContainer.stop(true);\n        self.isSnapping = false;\n      }\n    },\n\n    mouseDown: function () {\n      var self = this;\n\n      self.isMouseDown = true;\n    },\n\n    mouseUp: function (e) {\n      var self = this;\n\n      self.isMouseDown = false;\n\n      if (self.scrollOffset !== self.$snapContainer.scrollTop()) {\n        self.scrollStop(e);\n      }\n    },\n\n    keyDown: function (e) {\n      var self = this;\n\n      var nav = self.options.navigation;\n\n      if (!self.enabled) {\n        return;\n      }\n\n      switch (e.which) {\n        case nav.keys.prevKey:\n        case nav.keys.nextKey:\n          e.preventDefault();\n          break;\n\n        // no default\n      }\n\n      if (self.isSnapping) {\n        return;\n      }\n\n      switch (e.which) {\n        case nav.keys.prevKey:\n          self.snapTo('prev', nav.wrapAround);\n          break;\n\n        case nav.keys.nextKey:\n          self.snapTo('next', nav.wrapAround);\n          break;\n\n        // no default\n      }\n    },\n\n    captureNextClick: function (e) {\n      var self = this;\n\n      e.preventDefault();\n\n      if (self.isSnapping) {\n        return;\n      }\n\n      self.snapTo('next', self.options.navigation.wrapAround);\n    },\n\n    capturePrevClick: function (e) {\n      var self = this;\n\n      e.preventDefault();\n\n      if (self.isSnapping) {\n        return;\n      }\n\n      self.snapTo('prev', self.options.navigation.wrapAround);\n    },\n\n    resize: function () {\n      var self = this;\n\n      if (!self.enabled) {\n        return;\n      }\n\n      var $target = self.getPanel('.active');\n\n      self.snapToPanel($target);\n    },\n\n    captureMenuClick: function (e) {\n      var self = this;\n\n      var panel = $(e.currentTarget).data('panel');\n      var $target = self.getPanel('[data-panel=\"' + panel + '\"]');\n\n      self.snapToPanel($target);\n\n      return false;\n    },\n\n    snapToPanel: function ($target) {\n      var self = this;\n\n      if (!$target.jquery) {\n        return;\n      }\n\n      self.isSnapping = true;\n\n      self.options.onSnapStart.call(self, $target);\n      self.$container.trigger('panelsnap:start', [$target]);\n\n      var scrollTarget = 0;\n      if (self.$container.is('body')) {\n        scrollTarget = $target.offset().top;\n      } else {\n        scrollTarget = self.$snapContainer.scrollTop() + $target.position().top;\n      }\n\n      scrollTarget -= self.options.offset;\n\n      self.$snapContainer.stop(true).delay(self.options.delay).animate({\n        scrollTop: scrollTarget\n      }, self.options.slideSpeed, self.options.easing, function () {\n        // Set scrollOffset to scrollTop\n        // (not to scrollTarget since on iPad those sometimes differ)\n        self.scrollOffset = self.$snapContainer.scrollTop();\n        self.isSnapping = false;\n\n        // Call callback\n        self.options.onSnapFinish.call(self, $target);\n        self.$container.trigger('panelsnap:finish', [$target]);\n\n        self.activatePanel($target);\n      });\n    },\n\n    activatePanel: function ($target) {\n      var self = this;\n\n      self.getPanel('.active').removeClass('active');\n      $target.addClass('active');\n\n      if (self.options.$menu !== false) {\n        var activeItemSelector = self.options.menuSelector + '.active';\n        $(activeItemSelector, self.options.$menu).removeClass('active');\n\n        var attribute = '[data-panel=\"' + $target.data('panel') + '\"]';\n        var itemSelector = self.options.menuSelector + attribute;\n        var $itemToActivate = $(itemSelector, self.options.$menu);\n        $itemToActivate.addClass('active');\n      }\n\n      var nav = self.options.navigation;\n\n      if (!nav.wrapAround) {\n        var $panels = self.getPanel();\n        var index = $panels.index(self.getPanel('.active'));\n\n        if (nav.buttons.$nextButton !== false) {\n          $target = $panels.eq(index + 1);\n          if ($target.length < 1) {\n            $(nav.buttons.$nextButton).attr('aria-disabled', 'true');\n            $(nav.buttons.$nextButton).addClass('disabled');\n          } else {\n            $(nav.buttons.$nextButton).attr('aria-disabled', 'false');\n            $(nav.buttons.$nextButton).removeClass('disabled');\n          }\n        }\n\n        if (nav.buttons.$prevButton !== false) {\n          if (index < 1) {\n            $(nav.buttons.$prevButton).attr('aria-disabled', 'true');\n            $(nav.buttons.$prevButton).addClass('disabled');\n          } else {\n            $(nav.buttons.$prevButton).attr('aria-disabled', 'false');\n            $(nav.buttons.$prevButton).removeClass('disabled');\n          }\n        }\n      }\n\n      self.options.onActivate.call(self, $target);\n      self.$container.trigger('panelsnap:activate', [$target]);\n    },\n\n    getPanel: function (selector) {\n      var self = this;\n\n      if (typeof selector === 'undefined') {\n        selector = '';\n      }\n\n      return $(self.options.panelSelector + selector, self.$container);\n    },\n\n    snapTo: function (target, wrap) {\n      var self = this;\n\n      if (typeof wrap !== 'boolean') {\n        wrap = true;\n      }\n\n      var $panels = self.getPanel();\n      var index = $panels.index(self.getPanel('.active'));\n      var $target;\n\n      switch (target) {\n        case 'prev':\n          $target = $panels.eq(index - 1);\n          if (index < 1 && !wrap) {\n            $target = []; // Clear target, because negative indexes wrap automatically\n          }\n          break;\n\n        case 'next':\n          $target = $panels.eq(index + 1);\n          if ($target.length < 1 && wrap) {\n            $target = $panels.filter(':first');\n          }\n          break;\n\n        case 'first':\n          $target = $panels.filter(':first');\n          break;\n\n        case 'last':\n          $target = $panels.filter(':last');\n          break;\n\n        // no default\n      }\n\n      if ($target.length > 0) {\n        self.snapToPanel($target);\n      }\n    },\n\n    enable: function () {\n      var self = this;\n\n      // Gather scrollOffset for next scroll\n      self.scrollOffset = self.$snapContainer.scrollTop();\n\n      self.enabled = true;\n    },\n\n    disable: function () {\n      var self = this;\n\n      self.enabled = false;\n    },\n\n    toggle: function () {\n      var self = this;\n\n      if (self.enabled) {\n        self.disable();\n      } else {\n        self.enable();\n      }\n    }\n\n  };\n\n  $.fn[pluginName] = function (options) {\n    var args = Array.prototype.slice.call(arguments);\n\n    return this.each(function () {\n      var pluginInstance = $.data(this, storageName);\n      if (typeof options === 'object' || options === 'init' || !options) {\n        if (!pluginInstance) {\n          if (options === 'init') {\n            options = args[1] || {};\n          }\n\n          pluginInstance = Object.create(pluginObject).init(options, this);\n          $.data(this, storageName, pluginInstance);\n        } else {\n          $.error('Plugin is already initialized for this object.');\n        }\n      } else if (!pluginInstance) {\n        $.error('Plugin is not initialized for this object yet.');\n      } else if (pluginInstance[options]) {\n        var method = options;\n        options = args.slice(1);\n        pluginInstance[method].apply(pluginInstance, options);\n      } else {\n        $.error('Method ' + options + ' does not exist on jQuery.panelSnap.');\n      }\n    });\n  };\n\n  $.fn[pluginName].options = {\n    $menu: false,\n    menuSelector: 'a',\n    panelSelector: '> section',\n    namespace: '.panelSnap',\n    onSnapStart: function () { },\n    onSnapFinish: function () { },\n    onActivate: function () { },\n    directionThreshold: 50,\n    slideSpeed: 200,\n    delay: 0,\n    easing: 'linear',\n    offset: 0,\n    navigation: {\n      keys: {\n        nextKey: false,\n        prevKey: false\n      },\n      buttons: {\n        $nextButton: false,\n        $prevButton: false\n      },\n      wrapAround: false\n    }\n  };\n}(jQuery, window, document));\n\n/*!\n * Special flavoured jQuery Mobile scrollstart & scrollstop events.\n * Version 0.1.3\n *\n * Requires:\n * - jQuery 1.7.1 or higher (no jQuery.migrate needed)\n */\n(function ($) {\n  // Also handles the scrollstop event\n  $.event.special.scrollstart = {\n\n    enabled: true,\n\n    setup: function () {\n      var thisObject = this;\n      var $this = $(thisObject);\n      var timer;\n      var isTouching;\n\n      $this.data('scrollwatch', true);\n\n      function trigger(event, scrolling) {\n        event.type = scrolling ? 'scrollstart' : 'scrollstop';\n        $this.trigger(event);\n      }\n\n      $this.on('touchstart', function () {\n        isTouching = true;\n      });\n\n      $this.on('touchleave touchcancel touchend', function () {\n        isTouching = false;\n        setTimeout(function () {\n          // clearTimeout(timer);\n        }, 50);\n      });\n\n      $this.on('touchmove scroll', function (event) {\n        if (isTouching) {\n          return;\n        }\n\n        if (!$.event.special.scrollstart.enabled) {\n          return;\n        }\n\n        if (!$.event.special.scrollstart.scrolling) {\n          $.event.special.scrollstart.scrolling = true;\n          trigger(event, true);\n        }\n\n        clearTimeout(timer);\n        timer = setTimeout(function () {\n          $.event.special.scrollstart.scrolling = false;\n          trigger(event, false);\n          console.log(\"triggering\",event);\n        }, 50);\n      });\n    }\n\n  };\n\n  // Proxies scrollstart when needed\n  $.event.special.scrollstop = {\n\n    setup: function () {\n      var thisObject = this;\n      var $this = $(thisObject);\n\n      if (!$this.data('scrollwatch')) {\n        $(this).on('scrollstart', function () { });\n      }\n    }\n\n  };\n}(jQuery));\n\n/*!\n * Resizestart and resizestop events.\n * Version 0.0.1\n *\n * Requires:\n * - jQuery 1.7.1 or higher (no jQuery.migrate needed)\n */\n(function ($) {\n  // Also handles the resizestop event\n  $.event.special.resizestart = {\n\n    enabled: true,\n\n    setup: function () {\n      var thisObject = this;\n      var $this = $(thisObject);\n      var timer;\n\n      $this.data('resizewatch', true);\n\n      function trigger(event, resizing) {\n        event.type = resizing ? 'resizestart' : 'resizestop';\n        $this.trigger(event);\n      }\n\n      $this.on('resize', function (event) {\n        if (!$.event.special.resizestart.enabled) {\n          return;\n        }\n\n        if (!$.event.special.resizestart.resizing) {\n          $.event.special.resizestart.resizing = true;\n          trigger(event, true);\n        }\n\n        clearTimeout(timer);\n        timer = setTimeout(function () {\n          $.event.special.resizestart.resizing = false;\n          trigger(event, false);\n        }, 200);\n      });\n    }\n\n  };\n\n  // Proxies resizestart when needed\n  $.event.special.resizestop = {\n\n    setup: function () {\n      var thisObject = this;\n      var $this = $(thisObject);\n\n      if (!$this.data('resizewatch')) {\n        $(this).on('resizestart', function () { });\n      }\n    }\n\n  };\n}(jQuery));\n\n/* eslint-disable */\n\n/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)\n * Licensed under the MIT License (LICENSE.txt).\n *\n * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.\n * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.\n * Thanks to: Seamus Leahy for adding deltaX and deltaY\n *\n * Version: 3.0.6\n *\n * Requires: 1.2.2+\n */\n(function ($) {\n\n  var types = ['DOMMouseScroll', 'mousewheel'];\n\n  if ($.event.fixHooks) {\n    for (var i = types.length; i;) {\n      $.event.fixHooks[types[--i]] = $.event.mouseHooks;\n    }\n  }\n\n  $.event.special.mousewheel = {\n    setup: function () {\n      if (this.addEventListener) {\n        for (var i = types.length; i;) {\n          this.addEventListener(types[--i], handler, false);\n        }\n      } else {\n        this.onmousewheel = handler;\n      }\n    },\n\n    teardown: function () {\n      if (this.removeEventListener) {\n        for (var i = types.length; i;) {\n          this.removeEventListener(types[--i], handler, false);\n        }\n      } else {\n        this.onmousewheel = null;\n      }\n    }\n  };\n\n  $.fn.extend({\n    mousewheel: function (fn) {\n      return fn ? this.bind('mousewheel', fn) : this.trigger('mousewheel');\n    },\n\n    unmousewheel: function (fn) {\n      return this.unbind('mousewheel', fn);\n    }\n  });\n\n  function handler(event) {\n    var orgEvent = event || window.event,\n      args = [].slice.call(arguments, 1),\n      delta = 0,\n      returnValue = true,\n      deltaX = 0,\n      deltaY = 0;\n\n    event = $.event.fix(orgEvent);\n    event.type = 'mousewheel';\n\n    // Old school scrollwheel delta\n    if (orgEvent.wheelDelta) { delta = orgEvent.wheelDelta / 120; }\n    if (orgEvent.detail) { delta = -orgEvent.detail / 3; }\n\n    // New school multidimensional scroll (touchpads) deltas\n    deltaY = delta;\n\n    // Gecko\n    if (orgEvent.axis !== undefined && orgEvent.axis === orgEvent.HORIZONTAL_AXIS) {\n      deltaY = 0;\n      deltaX = -1 * delta;\n    }\n\n    // Webkit\n    if (orgEvent.wheelDeltaY !== undefined) { deltaY = orgEvent.wheelDeltaY / 120; }\n    if (orgEvent.wheelDeltaX !== undefined) { deltaX = -1 * orgEvent.wheelDeltaX / 120; }\n\n    // Add event and delta to the front of the arguments\n    args.unshift(event, delta, deltaX, deltaY);\n\n    return ($.event.dispatch || $.event.handle).apply(this, args);\n  }\n\n})(jQuery);\n/* eslint-enable */","/*!\n * Scalem v1.2.0 - A responsive text jQuery plugin\n * Copyright 2014, Tom Doan (http://www.tohodo.com/)\n *\n * Scalem by Tom Doan is licensed under the MIT License.\n * Read a copy of the license in the LICENSE file or at\n * http://choosealicense.com/licenses/mit\n */\n\n(function($) {\n  $.fn.scalem = function(oOptions) {\n    var oSettings = $.extend({\n        ratio: 1,        // Scale ratio (1 = 100%)\n        reference: null, // Text will scale relative to this element\n        styles: '',       // List of styles to scale (useful for buttons)\n        maxSize:390\n      }, oOptions),\n      updateStyles = function(o, e) {\n        var $o = $(o),\n          $oP = $o.parent(),\n          // Create clone to get true text width\n          $o2 = $o.clone().css({\n            'width': 'auto',\n            'display': 'none',\n            'white-space': 'nowrap'\n          }),\n          // If data attribute exists, use that instead\n          $ref = $(o.getAttribute('data-scale-reference') || oSettings.reference),\n          // Array of styles to scale\n          aStyles = ('' + (o.getAttribute('data-scale-styles') || oSettings.styles)).split(' '),\n          // Scale ratio\n          nRatio = Math.max(parseFloat(o.getAttribute('data-scale-ratio') || oSettings.ratio), 0),\n          nMaxSize = Math.max(parseFloat(o.getAttribute('data-max-size') || oSettings.maxSize), 0),\n          // Reference width (set to parent width by default)\n          nRefWidth = ($ref.length) ? $ref.width() : $oP.width(),\n          nTargetWidth,\n          // Text width\n          nTextWidth;\n        // Validate ratio\n        if (isNaN(nRatio)) nRatio = 1;\n        // Account for scrollbar?\n        if ($oP[0].scrollHeight>$oP.height()) nRefWidth -= 17;\n        nTargetWidth = nRefWidth * nRatio;\n        // Append clone to body to get inline width\n        $o2.addClass(\"currentProjectH2\");\n        $o2.appendTo('body');\n        nTextWidth = $o2.width();\n        // Exit if something doesn't look right\n        if (nTargetWidth===0 || nTextWidth===nRefWidth) {\n          $o2.remove();\n          return;\n        }\n        // Scale the text! (6px is minimum font size to get accurate ratio)\n        for (var i=Math.round((6/$o2.css('font-size', '6px').width())*nTargetWidth), o2=$o2[0]; i<nTargetWidth; ++i) {\n          // Update font-size using native method for better performance\n          // (see http://jsperf.com/style-vs-csstext-vs-setattribute)\n          o2.style.fontSize = i + 'px';\n          if ($o2.width() / nRefWidth > nRatio) {\n            // console.log(\"font size\",i)\n            if (i>nMaxSize) {\n              $o.css('font-size', nMaxSize + 'px');\n            } else {\n              $o.css('font-size', (i-1) + 'px');\n            }\n            \n            break;\n          }\n        }\n        // Clean up\n        $o2.remove();\n        // Scale additional styles\n        if (aStyles[0]) {\n          var nScale = $o.width() / nTextWidth,\n            oStyles = {};\n          for (var i=0, imax=aStyles.length; i<imax; ++i) {\n            if (!aStyles[i]) continue;\n            oStyles[aStyles[i]] = ((aStyles[i]==='width') ? nTargetWidth : Math.round(parseFloat($o.css(aStyles[i])) * nScale)) + 'px';\n          }\n          $o.css(oStyles);\n        }\n      };\n    return this.each(function() {\n      // This scope is required for the resize handler\n      var o = this;\n      // Set font size on load\n      updateStyles(o);\n      // Update CSS styles upon resize\n      $(window).resize(function(e) {\n        updateStyles(o, e);\n      });\n    });\n  };\n}(jQuery));","if (location.host!=\"anker.re\") {\n\tdocument.write('<script src=\"http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1\"></' + 'script>');\n}\n\t// // console.log(\"in debug mode\");\n","function goToCaseStudy(e) {\n\t$headline = $activeSection.find(\"h2\");\n\n\t$(\"article header\").addClass(\"swift\");\n\t$(\"article header\").css(\"background-color\",$activeSection.data(\"text-color\"));\n\n  \t$(\"article header h1\").html($headline.html()).css(\"color\",$activeSection.data(\"bg-dark\"));\n  \t$(\"article header h1\").scalem({maxSize:175});\n  \t$(\"article header\").removeClass(\"swift\");\n\t$(\"body\").addClass(\"article\")\n\n\t$(\"article header\").css(\"background-color\",$activeSection.data(\"bg-dark\"))\n  \t$(\"article header h1\").html($headline.html()).css(\"color\",$activeSection.data(\"text-color\"));\n\n  \tTweenMax.to(sections[activeSection].rotation, 2, { y:-de2ra(360), ease:new Ease(BezierEasing(.8,0,.2,1)), onComplete:function() {\n  \t\tsections[activeSection].rotation.y=de2ra(0);\n  \t}});\n  \tTweenMax.to(camera.position, 1.7/2, { z:200, ease:new Ease(BezierEasing(.2,0,1,.8)), onComplete:function() {\n  \t\tTweenMax.to(camera.position, 1.7/2, { z:115, ease:new Ease(BezierEasing(0,.45,.3,1))});\n  \t}});\n  \tTweenMax.to(sections[activeSection].position, 1, { x:-70, ease:new Ease(BezierEasing(.45,0,1,.3)), onComplete:function() {\n  \t\tTweenMax.to(sections[activeSection].position, 1, { x:0, ease:new Ease(BezierEasing(0,.45,.1,1))});\n  \t}});\n\te.stopPropagation();\n\treturn false;\n}\nfunction goToFrontPage(e) {\n\t$(\"article header\").css(\"background-color\",$activeSection.data(\"text-color\"));\n\t$(\"article header h1\").html($headline.html()).css(\"color\",$activeSection.data(\"bg-dark\"));\n\n\t$(\"body\").removeClass(\"article\");\n\tTweenMax.to(sections[activeSection].rotation, 2, { y:de2ra(360), ease:new Ease(BezierEasing(.8,0,.2,1)), onComplete:function() {\n  \t\tsections[activeSection].rotation.y=de2ra(0);\n  \t}});\n  \tTweenMax.to(camera.position, 1.7/2, { z:200, ease:new Ease(BezierEasing(.2,0,1,.8)), onComplete:function() {\n  \t\tTweenMax.to(camera.position, 1.7/2, { z:115, ease:new Ease(BezierEasing(0,.45,.3,1))});\n  \t}});\n  \tTweenMax.to(sections[activeSection].position, 1, { x:70, ease:new Ease(BezierEasing(.45,0,1,.3)), onComplete:function() {\n  \t\tTweenMax.to(sections[activeSection].position, 1, { x:0, ease:new Ease(BezierEasing(0,.45,.1,1))});\n  \t}});\n}","$(function() {\n\t$(\"a\").each(function(i,elm) {\n\t\tif (elm.href!='#') {\n\t\t\t// console.log(\"link\",elm.href);\n\t\t\t$(elm).data(\"link\",$(elm).attr(\"href\"));\n\t\t}\n\t});\n});","var mainLight;\nvar groundMaterial;\n\nfunction setLights() {\n\tvar shadowMapSize = 512;\n\tvar groundGeometry = new THREE.PlaneGeometry( 3000, 3000, 1 );\n\tgroundMaterial = new THREE.ShadowMaterial();\n\t// groundMaterial = new THREE.MeshDepthMaterial( { color: 0xff0000 } );\n\tgroundMaterial.opacity = 0.04;\n\tvar ground = new THREE.Mesh(groundGeometry, groundMaterial);\n\tground.receiveShadow = true;\n\tground.rotation.x=0;\n\tground.position.y=30;\n\tground.position.z=0;\n\tground.transparent = false;\n\tscene.add(ground);\n\n\tmainLight = new THREE.AmbientLight( { color:0x000000,intensity:0.37 } ); // soft white light\n\n\tscene.add( mainLight );\n\n\n\t// var spotLight1 = new THREE.SpotLight( 0xffffff); \n\t// spotLight1.shadow.mapSize.height = shadowMapSize;\n\t// spotLight1.shadow.mapSize.width = shadowMapSize;\n\t// spotLight1.castShadow = false;\n\t// spotLight1.position.set(0, 5, 0 );\n\t// spotLight1.intensity = .15;\n\t// spotLight1.penumbra = 1;\n\t// spotLight1.decay = 2;\n\t// spotLight1.angle = .45;\n\t// scene.add( spotLight1 );\n\t// scene.add(spotLight1.target);\n\n\tvar spotLight2 = new THREE.SpotLight( 0xFFFFFF); \n\tspotLight2.castShadow = true;\n\tspotLight2.position.set( 0,20,60 ); \n\tspotLight2.shadow.mapSize.height = shadowMapSize;\n\tspotLight2.shadow.mapSize.width = shadowMapSize;\n\tspotLight2.intensity = .15;\n\tspotLight2.exponent = .05;\n\tspotLight2.penumbra = 2;\n\tspotLight2.decay = 3;\n\tspotLight2.angle = de2ra(80);\n\tspotLight2.target.position = {\n\t\tx:-10,\n\t\ty:10,\n\t\tz:0\n\t}\n\tscene.add( spotLight2 );\n\tscene.add(spotLight2.target);\n\n}\n"]}
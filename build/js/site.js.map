{"version":3,"sources":["_tools.js","addText.js","add_device.js","add_project.js","bezier-easing.js","customMaterial.js","interface.js","jquery.panelSnap.js","jquery.scalem.js","livereload.js","navigate.js","route_links.js","set_lights.js"],"names":["map_range","value","low1","high1","low2","high2","hexToRgb","r","t","n","exec","a","this","alpha","g","b","parseInt","toString","rgbToHex","length","i","e","rgbPercentage","obj","colorIntensity","fps","startTime","frameNumber","average","framesCounted","secondsCounted","getFPS","d","Date","getTime","currentTime","result","Math","floor","reset","animateText","setLetterPosition","headline","$","each","elm","abs","proximity","tOpacity","TweenMax","to","parentNode","opacity","onComplete","y","ease","Power4","easeOut","register","container","document","createElement","className","body","appendChild","name","innerHTML","scalem","maxSize","snapWrapper","bind","ref","setTimeout","animateHeadline","animatesIn","console","log","render","sections","scrollHandler","addPhone","rotation","position","screenMaterial","glassMaterial","loader","color_dark","color_light","deferred","Deferred","phoneGroup","THREE","Group","screenGeometry","PlaneGeometry","screen","Mesh","receiveShadow","z","add","glass","load","geometry","materials","material","MeshPhongMaterial","object","castShadow","traverse","child","emissive","color","computeVertexNormals","shininess","x","scale","set","resolve","promise","addLaptop","macbookGroup","macbookScreenGroup","Object3D","macbookPivot","MeshStandardMaterial","side","DoubleSide","metalness","roughness","desktopGeometry","desktopScreen","de2ra","desktopGlass","tempgeometry","BoxBufferGeometry","tempmaterial","MeshBasicMaterial","mesh","bodyMaterial","specular","addProject","section","stage","count","resizeHandler","area","screenWidth","screenWidthFromDistance","camera","sectionObject","visible","window","JSONLoader","video","find","vl","pause","screenMaterialArray","Array","materialArray","children","im","tagName","push","customMaterial","transparent","reflectivity","combine","MixOperation","data","html","tween","loaded","hasClass","deviceType","phonesGroup","done","startRotationPoint","yoyo","repeat","delay","Power2","easeInOut","begin","end","kickstart","updateRotation","getProximity","lidAngle","play","type","targetRotation","updatePosition","start","addClass","kickOffSite","css","mainLight","intensity","groundMaterial","removeClass","checkLoad","A","aA1","aA2","B","C","calcBezier","aT","getSlope","binarySubdivide","aX","aA","aB","mX1","mX2","currentX","currentT","SUBDIVISION_PRECISION","SUBDIVISION_MAX_ITERATIONS","newtonRaphsonIterate","aGuessT","NEWTON_ITERATIONS","currentSlope","NEWTON_MIN_SLOPE","kSplineTableSize","kSampleStepSize","float32ArraySupported","Float32Array","BezierEasing","mY1","mY2","getTForX","intervalStart","currentSample","lastSample","sampleValues","dist","guessForT","initialSlope","Error","element","texture","TextureLoader","src","VideoTexture","minFilter","LinearFilter","magFilter","format","RGBFormat","wrapS","ClampToEdgeWrapping","wrapT","anisotropy","map","startSection","$activeSection","activeSection","init","options","$menu","menuSelector","panelSelector","namespace","onSnapStart","onSnapFinish","onActivate","directionThreshold","slideSpeed","easing","offset","navigation","keys","nextKey","prevKey","buttons","$nextButton","$prevButton","wrapAround","panelSnap","setEnvironment","setLights","animate","goToCaseStudy","sectionNo","localScroll","scrollTop","scrollHeight","scrollPercentage","height","progression","prevActiveSection","no","resume","scrollTarget","pixelRatio","devicePixelRatio","setAttribute","getElementsByClassName","PerspectiveCamera","setFOV","innerWidth","innerHeight","myTarget","Vector3","lookAt","scene","Scene","myAntialias","renderer","WebGLRenderer","antialias","setClearColor","setPixelRatio","setSize","shadowMap","enabled","PCFSoftShadowMap","domElement","style","addEventListener","onWindowResize","windowHalfX","windowHalfY","aspect","updateProjectionMatrix","fov","onDocumentMouseMove","event","clientX","storedMouse","clientY","mouseX","mouseY","prevMouseX","mousePosition","Power1","windowInFocus","frameCount","pixelRatioSwitchCount","degree","PI","distance","frustumHeight","tan","frustumWidth","mouseDown","mouseDirection","mouseDownCoord","Object","background","light","dark","ticker","hasData","setInterval","focus","blur","click","stopPropagation","create","F","prototype","pluginName","storageName","pluginObject","isMouseDown","isSnapping","scrollOffset","self","$container","$eventContainer","$snapContainer","is","scrollingElement","documentElement","ua","navigator","userAgent","indexOf","extend","fn","$target","getPanel","activatePanel","bindProxied","scrollStop","mouseWheel","mouseUp","resize","captureMenuClick","keyDown","captureNextClick","capturePrevClick","$element","method","selector","on","proxy","call","destroy","off","removeData","panelsInViewPort","getPanelsInViewport","eq","panelNumber","scrollDifference","overThreshold","maxOffset","scrollInterval","snapToPanel","viewport","top","bottom","panels","filter","_","el","bounds","$el","outerHeight","stop","nav","which","preventDefault","snapTo","panel","currentTarget","jquery","trigger","activeItemSelector","attribute","itemSelector","$itemToActivate","$panels","index","attr","target","wrap","enable","disable","toggle","args","slice","arguments","pluginInstance","apply","error","jQuery","special","scrollstart","setup","scrolling","$this","timer","isTouching","thisObject","clearTimeout","scrollstop","resizestart","resizing","resizestop","handler","orgEvent","delta","deltaX","deltaY","fix","wheelDelta","detail","undefined","axis","HORIZONTAL_AXIS","wheelDeltaY","wheelDeltaX","unshift","dispatch","handle","types","fixHooks","mouseHooks","mousewheel","onmousewheel","teardown","removeEventListener","unmousewheel","unbind","oOptions","oSettings","ratio","reference","styles","updateStyles","o","nTargetWidth","nTextWidth","$o","$oP","parent","$o2","clone","width","display","white-space","$ref","getAttribute","aStyles","split","nRatio","max","parseFloat","nMaxSize","nRefWidth","isNaN","appendTo","remove","round","o2","fontSize","nScale","oStyles","imax","location","host","write","$headline","Ease","href","shadowMapSize","groundGeometry","ShadowMaterial","ground","AmbientLight","spotLight2","SpotLight","shadow","mapSize","exponent","penumbra","decay","angle"],"mappings":"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","file":"site.js","sourcesContent":["function map_range(value, low1, high1, low2, high2) {\n    return low2 + (high2 - low2) * (value - low1) / (high1 - low1);\n}\nfunction hexToRgb(r,t){var n=/^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(r),a=function(){return void 0==this.alpha?\"rgb(\"+this.r+\", \"+this.g+\", \"+this.b+\")\":(this.alpha>1?this.alpha=1:this.alpha<0&&(this.alpha=0),\"rgba(\"+this.r+\", \"+this.g+\", \"+this.b+\", \"+this.alpha+\")\")};return void 0==t?n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16),toString:a}:null:(t>1?t=1:0>t&&(t=0),n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16),alpha:t,toString:a}:null)}\nfunction rgbToHex(r,t,n){function a(r){var t=r.toString(16);return 1==t.length?\"0\"+t:t}if(void 0==t||void 0==n){if(\"string\"==typeof r){var i=/^rgb[a]?\\(([\\d]+)[ \\n]*,[ \\n]*([\\d]+)[ \\n]*,[ \\n]*([\\d]+)[ \\n]*,?[ \\n]*([.\\d]+)?[ \\n]*\\)$/i.exec(r);return rgbToHex(parseInt(i[1]),parseInt(i[2]),parseInt(i[3]))}return void 0==r.r||void 0==r.g||void 0==r.b?null:rgbToHex(r.r,r.g,r.b)}var e=r;return\"#\"+a(e)+a(t)+a(n)}\nfunction rgbPercentage(obj) {\n\tobj.r = obj.r/255;\n\tobj.b = obj.b/255;\n\tobj.g = obj.g/255;\n\treturn obj;\n}\nfunction colorIntensity(obj) {\n\treturn (obj.r/255+obj.g/255+obj.b/255)/3;\n}\nvar fps = {\t\n\tstartTime : 0,\t\n\tframeNumber : 0,\n\taverage : 60,\n\tframesCounted : 60,\n\tsecondsCounted : 1,\n\tgetFPS : function(){\n\t\tthis.frameNumber++;\t\t\n\t\tvar d = new Date().getTime(), currentTime = ( d - this.startTime ) / 1000, result = Math.floor( ( this.frameNumber / currentTime ) );\n\t\t\n\t\tif( currentTime > 1 ){\n\t\t\tthis.framesCounted+=result\n\t\t\tthis.secondsCounted++;\n\t\t\tthis.startTime = new Date().getTime();\n\t\t\tthis.frameNumber = 0;\n\t\t\tthis.average = this.framesCounted/this.secondsCounted\n\t\t\t// $(\"span.fps\").html(this.average);\n\t\t}\n\t\t\n\t\treturn result;\n\t},\n\treset : function() {\n\t\tthis.framesCounted=0;\n\t\tthis.secondsCounted=0;\n\t}\n};\n","var animateText = function() {\n\tvar _this = this;\n\t\n\tfunction setLetterPosition(obj) {\n\t\tvar headline = $(obj.headline);\n\t\theadline.each(function(i,elm) {\n\t\t\t if (Math.abs(obj.proximity<.15)) {\n\t\t\t\tvar tOpacity=map_range(Math.abs(obj.proximity), 0, .15, 1, 0)\n\t\t\t\tif (tOpacity<0) tOpacity=0;\n\t\t\t\tTweenMax.to(elm.parentNode, .5, { opacity:tOpacity, onComplete:function() {}})\n\t\t\t} else {\n\t\t\t\tvar tOpacity=0;\n\t\t\t\tTweenMax.to(elm.parentNode, .5, { opacity:tOpacity, onComplete:function() {}})\n\t\t\t}\n\t\t\t\n\t\t\tTweenMax.to(elm, 5, { y:Math.abs(obj.proximity)*30, ease:Power4.easeOut, onComplete:function() {}})\n\t\t\t\n\t\t\t\n\t\t});\n\t}\n\n\n\treturn {\n\t\tregister: function(obj) {\n\t\t\t// _this.elm = obj.elm;\n\t\t\tobj.proximity=.25;\n\t\t\tvar container = document.createElement(\"div\");\n\t\t\tcontainer.className = \"current_project\";\n\t\t\tdocument.body.appendChild(container);\n\n\t\t\t// var cta = document.createElement(\"a\");\n\t\t\t// cta.className=\"cta\";\n\t\t\t// cta.innerHTML = \"See more\";\n\t\t\t// $(\"footer\")[0].appendChild(cta);\n\t\t\t\n\t\t\tvar name = document.createElement(\"h2\");\n\t\t\t// var nameHTML=\"\";\n\t\t\t// for (i=0;i<obj.name.length;i++) {\n\t\t\t// \tnameHTML+=\"<span>\"+obj.name[i]+\"</span>\";\n\t\t\t// }\n\t\t\tname.innerHTML='<a href=\"#\">'+obj.name+'</a>';\n\t\t\tcontainer.appendChild(name);\n\n\t\t\tobj.headline = name;\n\n\n\n\n\t\t\t$(\".current_project h2\").scalem({maxSize:175});\n\n\t\t\tsnapWrapper.bind(\"scroll\",function() {\n\t\t\t\tsetLetterPosition(obj);\n\t\t\t});\n\t\t\t\n\t\t\tcontainer.ref= obj.ref;\n\t\t\tsetLetterPosition(obj);\n\t\t\tsetTimeout(setLetterPosition,1000,obj);\n\t\t},\n\t\tanimateHeadline: function(obj, animatesIn) {\n\t\t\tvar headline = obj.headline;\n\t\t\t// console.log(\"headline\",$(headline));\n\t\t\tif (animatesIn) {\n\t\t\t\tconsole.log(headline);\n\t\t\t\t// animateIn(headline);\n\t\t\t} else {\n\t\t\t\t// animateOut(headline);\n\t\t\t}\n\t\t},\n\t\trender: function() {\n\t\t\tfor (i=0;i<sections.length;i++) {\n\t\t\t\tscrollHandler(sections[i]);\n\t\t\t}\n\t\t}\n\t}\n}();\n","function addPhone(rotation, position, screenMaterial, glassMaterial, loader, color_dark, color_light) {\n\n\tvar deferred = new $.Deferred();\n\tvar phoneGroup = new THREE.Group();\n\tvar screenGeometry = new THREE.PlaneGeometry( 0.55, 1, 1 );\n\tvar screen = new THREE.Mesh( screenGeometry, screenMaterial );\n\tscreen.receiveShadow = false;\n\tscreen.position.z = 0.022;\n\tscreen.position.y = 0.05;\n\tphoneGroup.add( screen );\n\n\t// var glassMaterial = new THREE.MeshStandardMaterial({ side: THREE.DoubleSide, color:0x222222, emissive:0x0, metalness:0.7, roughness:0.2, envMap:reflectionCube });\n\tvar glass = new THREE.Mesh( screenGeometry, glassMaterial );\n\tglass.receiveShadow = false;\n\tglass.position.z = 0.0225;\n\tglass.position.y = 0.05;\n\tphoneGroup.add(glass);\n\n\tloader.load(\n\t\t'models/iphones7.json',\n\t\tfunction ( geometry, materials ) {\n\t\t\tvar material = new THREE.MeshPhongMaterial(materials[0])\n\t\t\tvar object = new THREE.Mesh( geometry, material );\t\t\t\t\n\t\t\tobject.position.y=-0.6;\n\t\t\tobject.castShadow=true;\n\t\t\tobject.receiveShadow = false;\n\t\t\tphoneGroup.add( object );\n\t\t\tobject.traverse( function ( child ) {\n\t\t\t\t// child.geometry.computeFaceNormals();\n\n\t\t        phoneGroup.position.y=-5;\n\t\t        phoneGroup.position.z=-1;\t\t      \n\t\t\t\tobject.material.emissive.r = (color_dark.r/255);\n\t\t\t\tobject.material.emissive.g = (color_dark.g/255);\n\t\t\t\tobject.material.emissive.b = (color_dark.b/255);\n\t\t\t\tobject.material.color.r = (color_light.r/255);\n\t\t\t\tobject.material.color.g = (color_light.g/255);\n\t\t\t\tobject.material.color.b = (color_light.b/255);\n\t\t\t\t\t\n\t    \t});\n\t    \tloader.load(\n\t\t\t\t'models/iphone-back.json',\n\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\tvar material = new THREE.MeshPhongMaterial(materials[0])\n\t\t\t\t\tvar object = new THREE.Mesh( geometry, material );\t\t\t\t\n\t\t\t\t\tobject.position.y=-0.6;\n\t\t\t\t\tobject.castShadow=true;\n\t\t\t\t\tobject.receiveShadow = false;\n\t\t\t\t\tphoneGroup.add( object );\n\t\t\t\t\tobject.traverse( function ( child ) {\n\t\t\t\t\t\t// child.geometry.computeFaceNormals();\n\t\t\t\t\t\tchild.geometry.computeVertexNormals();\n\t\t\t\t        phoneGroup.position.y=-5;\n\t\t\t\t        phoneGroup.position.z=-1;\n\n\t\t\t\t       \n\t\t\t\t\t\tobject.material.emissive.r = (color_dark.r/255);\n\t\t\t\t\t\tobject.material.emissive.g = (color_dark.g/255);\n\t\t\t\t\t\tobject.material.emissive.b = (color_dark.b/255);\n\t\t\t\t\t\tobject.material.color.r = (color_light.r/255);\n\t\t\t\t\t\tobject.material.color.g = (color_light.g/255);\n\t\t\t\t\t\tobject.material.color.b = (color_light.b/255);\n\t\t\t\t\t\tobject.material.shininess = 10;\n\n\t\t\t\t\t\tphoneGroup.position.z=position.z;\n\t\t\t\t\t\tphoneGroup.position.y=position.y;\n\t\t\t\t\t\tphoneGroup.position.x=position.x;\n\t\t\t\t\t\tphoneGroup.scale.set( 30, 30, 30 );\n\t\t\t\t\t\tphoneGroup.castShadow = true;\n\t\t\t\t\t\tphoneGroup.rotation.x=rotation.x;\n\t\t\t\t\t\tphoneGroup.rotation.y=rotation.y;\n\t\t\t\t\t\tphoneGroup.rotation.z=rotation.z;\n\t\t\t\t\t\tdeferred.resolve(phoneGroup);\n\t\t\t    \t})\t\t\t\t    \t\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t);\n\treturn deferred.promise();\n}\n\nfunction addLaptop(rotation, position, screenMaterial, glassMaterial, loader, color_dark, color_light) {\n\tvar deferred = new $.Deferred();\n\tvar macbookGroup = new THREE.Group();\n\tvar macbookScreenGroup = new THREE.Object3D();\t\n    var material = new THREE.MeshStandardMaterial({ side: THREE.DoubleSide, color:0xffffff, metalness:0.5, roughness:1});\n\tvar macbookPivot = new THREE.Object3D();\n\t\n\n\tloader.load(\n\t\t// resource URL\n\t\t'models/screen-back.json',\n\t\t// Function when resource is loaded\n\t\tfunction ( geometry, materials ) {\n\t\t\t// var material = new THREE.MultiMaterial( materials );\n\t\t\tvar material = new THREE.MeshPhongMaterial(materials[0])\n\t\t\tvar object = new THREE.Mesh( geometry, material );\n\t\t\t// scene.add( object );\n\t\t\t\n\t\t\tobject.position.y=0;\n\t\t\tobject.position.x=-0.5;\n\t\t\tobject.position.z=0;\n\t\t\t// object.rotation.y=de2ra(180);\n\t\t\tobject.receiveShadow = false;\n\t\t\tobject.castShadow=true;\n\t\t\tmaterial.shininess = 0.2;\n\t\t\tobject.traverse( function ( child ) {\n\t\t        // console.log(\"screen\",object);\n\t\t        if ( child instanceof THREE.Mesh ) {\n\t\t            child.geometry.computeVertexNormals();\n\t\t        }\n\t\t        object.material.side=THREE.DoubleSide;\n\t\t        var color_dark = {\n\t\t        \tr:10,\n\t\t        \tg:10,\n\t\t        \tb:10\n\t\t        }\n\t\t        var color_light = color_dark;\n\t\t\t\tmacbookScreenGroup.add( object );\n\t\t        \n\t\t    });\n\t\t    // console.log(\"loaded screen back 1\");\n\t\t    loader.load(\n\t\t\t\t'models/screen-front.json',\n\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\t\n\t\t\t\t\tvar material = new THREE.MeshStandardMaterial({ side: THREE.DoubleSide, color:0x0f0f0f, emissive:0x0, metalness:0.7, roughness:0.2 });\n\t\t\t\t\tvar object = new THREE.Mesh( geometry, material );\t\t\t\t\n\t\t\t\t\tobject.position.y=0;\n\t\t\t\t\tobject.position.x=-0.5;\n\t\t\t\t\tobject.position.z=0;\n\t\t\t\t\t// object.rotation.y=de2ra(180);\n\t\t\t\t\tvar color_dark = {\n\t\t\t\t\t\tr:0,\n\t\t\t\t\t\tg:0,\n\t\t\t\t\t\tb:0\n\t\t\t\t\t}\n\t\t\t\t\tvar color_light = color_dark;\n\t\t\t\t\tobject.castShadow=true;\n\t\t\t\t\tobject.receiveShadow = false;\n\t\t\t\t\tmacbookScreenGroup.add( object );\n\t\t\t\t\tvar desktopGeometry = new THREE.PlaneGeometry( 8.7, 5.8, 1 );\n\n\t\t\t\t\tvar desktopScreen = new THREE.Mesh( desktopGeometry, screenMaterial );\n\t\t\t\t\tdesktopScreen.position.z = -3.16;\n\t\t\t\t\tdesktopScreen.position.y = 3.3;\n\t\t\t\t\tdesktopScreen.rotation.x = de2ra(1);\n\n\t\t\t\t\tmacbookScreenGroup.add(desktopScreen);\n\n\t\t\t\t\tvar desktopGlass = new THREE.Mesh(desktopGeometry, glassMaterial);\n\t\t\t\t\tdesktopGlass.receiveShadow = true;\n\t\t\t\t\tdesktopGlass.position.z = -3.16;\n\t\t\t\t\tdesktopGlass.position.y = 3.3;\n\t\t\t\t\tdesktopGlass.rotation.x = de2ra(1);\n\t\t\t\t\tmacbookScreenGroup.add(desktopGlass);\n\n\t\t\t\t\t\n\t\t\t\t\tvar tempgeometry = new THREE.BoxBufferGeometry( 200, 200, 200 );\n\t\t\t\t\tvar tempmaterial = new THREE.MeshBasicMaterial( { color: 0xffffff } );\t\n\t\t\t\t\tmesh = new THREE.Mesh( tempgeometry, tempmaterial );\n\t\t\t\t\t\n\t\t\t\t\tmacbookScreenGroup.position.z=3.1;\n\t\t\t\t\tmacbookPivot.add(macbookScreenGroup);\n\t\t\t\t\tmacbookPivot.position.z=-3;\n\t\t\t\t\tmacbookPivot.position.y=0;\n\t\t\t\t\tmacbookPivot.rotation.x=de2ra(90);\n\t\t\t\t\t\n\t\t\t\t\tmacbookGroup.add(macbookPivot);\n\n\t\t\t\t\t// console.log(\"loaded screen front 2\");\n\t\t\t\t\tloader.load(\n\t\t\t\t\t\t'models/keyboard.json',\n\t\t\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\t\t\tvar bodyMaterial = new THREE.MeshStandardMaterial({ side: THREE.DoubleSide, color:0xbdbdbd, metalness:0.2, roughness:1});\n\t\t\t\t\t\t\tvar object = new THREE.Mesh( geometry, bodyMaterial );\n\t\t\t\t\t\t\tobject.position.x=-0.5;\n\t\t\t\t\t\t\tobject.castShadow=false;\n\t\t\t\t\t\t\tobject.receiveShadow = true;\n\t\t\t\t\t\t\tobject.material.shininess = 10;\n\t\t\t\t\t\t\tmacbookGroup.add( object );\n\t\t\t\t\t\t\t// console.log(\"loaded keyboard 3\");\n\t\t\t\t\t\t\tloader.load(\n\t\t\t\t\t\t\t\t// resource URL\n\t\t\t\t\t\t\t\t'models/keys.json',\n\t\t\t\t\t\t\t\t// Function when resource is loaded\n\t\t\t\t\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\t\t\t\t\tvar material = new THREE.MeshPhongMaterial(materials[0])\n\t\t\t\t\t\t\t\t\tvar object = new THREE.Mesh( geometry, material );\n\t\t\t\t\t\t\t\t\t// scene.add( object );\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tobject.position.y=0.005;\n\t\t\t\t\t\t\t\t\t// object.position.y=0.06;\n\t\t\t\t\t\t\t\t\tobject.position.x=-0.5;\n\t\t\t\t\t\t\t\t\tobject.position.z=0;\n\t\t\t\t\t\t\t\t\tobject.receiveShadow = true;\n\t\t\t\t\t\t\t\t\tobject.castShadow=true;\n\t\t\t\t\t\t\t\t\tvar color_dark = {\n\t\t\t\t\t\t\t\t\t\tr: 0,\n\t\t\t\t\t\t\t\t\t\tg: 0,\n\t\t\t\t\t\t\t\t\t\tb: 0\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tvar color_light = color_dark;\n\t\t\t\t\t\t\t       \n\t\t\t\t\t\t        \tobject.material.side=THREE.DoubleSide;\n\t\t\t\t\t\t\t\t\tobject.material.specular.r = color_dark.r/255;\n\t\t\t\t\t\t\t\t\tobject.material.specular.g = color_dark.g/255;\n\t\t\t\t\t\t\t\t\tobject.material.specular.b = color_dark.b/255;\n\t\t\t\t\t\t\t\t\tobject.material.emissive.r = color_light.r/255;\n\t\t\t\t\t\t\t\t\tobject.material.emissive.g = color_light.g/255;\n\t\t\t\t\t\t\t\t\tobject.material.emissive.b = color_light.b/255;\n\t\t\t\t\t\t\t\t\tobject.material.shininess=15;\t\n\n\t\t\t\t\t\t\t\t\tmacbookGroup.add( object );\n\t\t\t\t\t\t\t\t\t// console.log(\"loaded keys 4\");\n\t\t\t\t\t\t\t    \tloader.load(\n\t\t\t\t\t\t\t\t\t\t// resource URL\n\t\t\t\t\t\t\t\t\t\t'models/keys-top.json',\n\t\t\t\t\t\t\t\t\t\t// Function when resource is loaded\n\t\t\t\t\t\t\t\t\t\tfunction ( geometry, materials ) {\n\t\t\t\t\t\t\t\t\t\t\tvar material = new THREE.MeshPhongMaterial(materials[0])\n\t\t\t\t\t\t\t\t\t\t\tvar object = new THREE.Mesh( geometry, material );\n\t\t\t\t\t\t\t\t\t\t\t// scene.add( object );\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tobject.position.y=0.005;\n\t\t\t\t\t\t\t\t\t\t\t// object.position.y=0.06;\n\t\t\t\t\t\t\t\t\t\t\tobject.position.x=-0.5;\n\t\t\t\t\t\t\t\t\t\t\tobject.position.z=0;\n\t\t\t\t\t\t\t\t\t\t\tobject.receiveShadow = false;\n\t\t\t\t\t\t\t\t\t\t\tobject.castShadow=false;\n\t\t\t\t\t\t\t\t\t\t\tvar color_dark = {\n\t\t\t\t\t\t\t\t\t\t\t\tr: 0,\n\t\t\t\t\t\t\t\t\t\t\t\tg: 0,\n\t\t\t\t\t\t\t\t\t\t\t\tb: 0\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tvar color_light = {\n\t\t\t\t\t\t\t\t\t\t\t\tr:5,\n\t\t\t\t\t\t\t\t\t\t\t\tg:5,\n\t\t\t\t\t\t\t\t\t\t\t\tb:5\n\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t        \n\t\t\t\t\t\t\t\t        \tobject.material.side=THREE.DoubleSide;\n\t\t\t\t\t\t\t\t\t\t\tobject.material.specular.r = color_dark.r/255;\n\t\t\t\t\t\t\t\t\t\t\tobject.material.specular.g = color_dark.g/255;\n\t\t\t\t\t\t\t\t\t\t\tobject.material.specular.b = color_dark.b/255;\n\t\t\t\t\t\t\t\t\t\t\tobject.material.emissive.r = color_light.r/255;\n\t\t\t\t\t\t\t\t\t\t\tobject.material.emissive.g = color_light.g/255;\n\t\t\t\t\t\t\t\t\t\t\tobject.material.emissive.b = color_light.b/255;\n\t\t\t\t\t\t\t\t\t\t\tobject.material.shininess=21;\t\n\t\t\t\t\t\t\t\t        \n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.scale.set(6.25,6.25,6.25);\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.add( object );\n\t\t\t\t\t\t\t\t\t\t\t// macbookGroup.position = position;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.position.z=position.z;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.position.y=position.y;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.position.x=position.x;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.rotation.x = rotation.x;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.rotation.y = rotation.y;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.rotation.z = rotation.z;\n\t\t\t\t\t\t\t\t\t\t\tmacbookGroup.screen = macbookPivot;\n\t\t\t\t\t\t\t\t\t\t\t// screenMaterial.opacity=0;\n\t\t\t\t\t\t\t\t\t\t\t// console.log(\"screenMaterial\",screenMaterial);\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t// console.log(\"loaded keys top 5\");\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t    \tdeferred.resolve(macbookGroup);\n\t\t\t\t\t\t\t\t\t    }\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t    }\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t);\n\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t// scene.add(macbookGroup);\n\t\n\treturn deferred.promise();\n}","function addProject(section, stage, count) {\n\tvar sectionObject = new THREE.Group();\n\tsectionObject.count=count;\n\tsectionObject.position.y = sectionObject.count * -1*screenWidthFromDistance(200);\n\tif (count>0) sectionObject.visible = false;\n\tvar area = {};\n\tfunction resizeHandler() {\n\t\tarea.screenWidth=screenWidthFromDistance(camera.position.z);\n\t}\n\t$(window).bind(\"resize\",resizeHandler);\n\tresizeHandler();\n\t\n\tvar loader = new THREE.JSONLoader();\n\tvar screenMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });\t\n\tvar video = $(section).find(\"video\");\n\tfor (var vl=0;vl<video.length;vl++) {\n\t\tvideo[vl].pause();\n\t\tsectionObject.video = video[vl];\n\t}\n\n\tvar screenMaterialArray = new Array();\n\n\tvar materialArray = $(section)[0].children;\n\tfor (im = 0; im < materialArray.length; im++) {\n\t\t\n\t\tif (materialArray[im].tagName==\"IMG\" || materialArray[im].tagName==\"VIDEO\") {\t\t\t\n\t\t\tscreenMaterialArray.push(customMaterial(materialArray[im]));\n\t\t}\t\t\n\t}\n\t\n\tvar glassMaterial = new THREE.MeshPhongMaterial({ color: 0xffffff  });\n\tglassMaterial.specular.r=1;\n\tglassMaterial.specular.g=1;\n\tglassMaterial.specular.b=1;\n\tglassMaterial.transparent = true;\n\tglassMaterial.opacity = 0.05;\n\tglassMaterial.shininess = 20;\n\t// glassMaterial.envMap = reflectionCube;\n\tglassMaterial.reflectivity = 5;\n\tglassMaterial.combine = THREE.MixOperation;\n\tvar emDarken = 1;\n\tvar color_light = hexToRgb($(section).data(\"device-light\"));\n\tvar color_dark = hexToRgb($(section).data(\"device-dark\"));\n\n\t\n\tsectionObject.elm = section;\n\n\n\tsectionObject.name=$(section).find(\"h2\").html()\n\tsectionObject.tween = [];\n\tsectionObject.loaded=0;\n\tsectionObject.ref = section;\n\n\tif ($(section).hasClass(\"mobile\")) {\n\t\tsectionObject.deviceType=\"mobile\";\n\t\tvar phonesGroup = new THREE.Group();\n\t\taddPhone({ x:de2ra(60), y:de2ra(-140), z:de2ra(30) },{ x:-10, y:4, z:-8 }, screenMaterialArray[1], glassMaterial, loader, color_dark, color_light).done(function(phoneGroup) {\n\t\t\t// TweenMax.to(phoneGroup.rotation, 1.5, {y:de2ra(0),  ease:Power4.easeOut});\n\t\t\tphoneGroup.startRotationPoint = 60;\n\t\t\tphonesGroup.add(phoneGroup);\n\t\t\tsectionObject.loaded+=.333333;\n\t\t\tsectionObject.tween.push(TweenMax.to(phoneGroup.position, 3.5,{ y:phoneGroup.position.y-1, yoyo:true, repeat:-1, delay:0, ease:Power2.easeInOut, onComplete:function() {}}));\n\t\t\t// console.log(\"phone added\");\n\t\t});\n\n\t\taddPhone({ x:de2ra(50), y:de2ra(35), z:de2ra(-80) },{ x:15, y:1, z:-8 }, screenMaterialArray[0], glassMaterial, loader, color_dark, color_light).done(function(phoneGroup) {\n\t\t\t// TweenMax.to(phoneGroup.rotation, 1.5, {y:de2ra(0),  ease:Power4.easeOut});\n\t\t\tsectionObject.tween.push(TweenMax.to(phoneGroup.position, 3.5,{ y:phoneGroup.position.y-1, yoyo:true, repeat:-1, delay:0.5, ease:Power2.easeInOut, onComplete:function() {}}));\t\n\t\t\tphoneGroup.startRotationPoint = 50;\n\t\t\tphonesGroup.add(phoneGroup);\n\t\t\tsectionObject.loaded+=.333333;\n\t\t\t// console.log(\"phone added\");\n\t\t});\n\n\n\t\taddPhone({ x:de2ra(120), y:de2ra(0), z:de2ra(-60) },{ x:45, y:-11, z:-8 }, screenMaterialArray[2], glassMaterial, loader, color_dark, color_light).done(function(phoneGroup) {\n\t\t\t// TweenMax.to(phoneGroup.rotation, 1.5, {y:de2ra(0),  ease:Power4.easeOut});\n\t\t\tsectionObject.tween.push(TweenMax.to(phoneGroup.position, 3.5,{ y:phoneGroup.position.y-1, yoyo:true, repeat:-1, delay:1.5, ease:Power2.easeInOut, onComplete:function() {}}));\n\t\t\tphoneGroup.startRotationPoint = 120;\n\t\t\tphonesGroup.add(phoneGroup);\n\t\t\tsectionObject.loaded+=.333333;\n\t\t\t// console.log(\"phone added\");\n\t\t});\n\n\t\tphonesGroup.position.y=5;\n\t\tphonesGroup.position.z=15;\n\t\t// phonesGroup.rotation.z=de2ra(-15);\n\t\tphonesGroup.position.x=-12\n\t\tphonesGroup.begin = function() {\n\n\t\t}\n\t\tphonesGroup.end = function() {\n\n\t\t}\n\t\tphonesGroup.startRotationPoint = 12\n\t\tsectionObject.add(phonesGroup);\n\n\t} else if ($(section).hasClass(\"desktop\")) {\n\t\tsectionObject.deviceType=\"desktop\";\n\t\t// console.log(\"print out\",screenMaterialArray[0],screenMaterialArray[1])\n\t\taddLaptop({x:de2ra(60), y:de2ra(0), z:de2ra(0)}, { x:0, y:-45, z:10}, screenMaterialArray[0], glassMaterial, loader, color_dark, color_light).done(function(macbookGroup) {\n\t\t\t// console.log(\"received macbook\", macbookGroup);\n\t\t\tsectionObject.loaded+=1.5;\n\t\t\tsectionObject.macbookGroup = macbookGroup;\n\t\t\tmacbookGroup.startRotationPoint = 0;\n\t\t\tmacbookGroup.opacity = 0;\n\t\t\tmacbookGroup.begin = function() {\n\t\t\t\t// console.log(\"macbook open\");\n\t\t\t\t// var openLid = TweenMax.to(macbookGroup.screen.rotation, 1.3, { x:-de2ra(20), delay:1.25, ease:Power4.easeOut});\n\t\t\t}\n\t\t\tmacbookGroup.end = function() {\n\t\t\t\t// var openLid = TweenMax.to(macbookGroup.screen.rotation, 1, { x:de2ra(90), ease:Power4.easeOut});\n\t\t\t}\n\t\t\tsectionObject.add(macbookGroup);\n\t\t\t// sectionObject.tween.push(TweenMax.to(macbookGroup.position, 3.5,{ y:macbookGroup.position.y-1, yoyo:true, repeat:-1, ease:Power2.easeInOut, onComplete:function() {}}));\n\t\t\tif (sectionObject.loaded==1) {\n\t\t\t\tscrollHandler();\n\t\t\t}\n\t\t\tif (sectionObject.kickstart) {\n\t\t\t\tmacbookGroup.begin()\n\t\t\t}\n\t\t\t// console.log(\"macbook added\");\n\t\t});\n\t\taddPhone({ x:de2ra(-15), y:de2ra(10), z:de2ra(15) },{ x:-50, y:-25, z:0 }, screenMaterialArray[1], glassMaterial, loader, color_dark, color_light).done(function(phoneGroup) {\n\t\t\t// TweenMax.to(phoneGroup.rotation, 1.5, {y:de2ra(0),  ease:Power4.easeOut});\n\t\t\tvar phonesGroup = new THREE.Group();\n\t\t\t\n\t\t\t// phonesGroup.rotation.z=de2ra(-15);\n\t\t\tphoneGroup.scale.x = 16;\n\t\t\tphoneGroup.scale.y = 16;\n\t\t\tphoneGroup.scale.z = 16;\n\t\t\tphonesGroup.begin = function() {\n\n\t\t\t}\n\t\t\tphonesGroup.end = function() {\n\n\t\t\t}\n\t\t\tphonesGroup.startRotationPoint = 0;\n\t\t\tphoneGroup.startRotationPoint = -30;\n\t\t\tphonesGroup.add(phoneGroup);\n\t\t\t\n\t\t\t// sectionObject.tween.push(TweenMax.to(phoneGroup.position, 3.5,{ y:phoneGroup.position.y-1, yoyo:true, repeat:-1, delay:0.5, ease:Power2.easeInOut, onComplete:function() {}}));\n\t\t\tsectionObject.loaded=1;\n\t\t\tsectionObject.loaded+=.5;\n\n\t\t\tscrollHandler();\n\n\t\t\tsectionObject.add(phonesGroup);\n\n\t\t});\n\t}\n\tsectionObject.updateRotation = function() {\n\t\tif (typeof sectionObject.macbookGroup!=\"undefined\") {\n\t\t\tif (sectionObject.deviceType==\"desktop\" && Math.abs(getProximity(this.count))<1) {\n\t\t\t\tvar lidAngle = map_range(Math.abs(getProximity(this.count)),-0.15,0,90,20);\n\t\t\t\tif (lidAngle<-90) lidAngle = -90;\n\t\t\t\tTweenMax.to(sectionObject.macbookGroup.screen.rotation, 1, { x:-de2ra(lidAngle), ease:Power4.easeOut})\n\t\t\t}\n\t\t}\n\t\tif (Math.abs(this.proximity)<0.1) {\n\t\t\tif (this.video) this.video.play();\n\t\t\tfor (t=0;t<this.tween.length;t++) {\n\t\t\t\tthis.tween[t].play();\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.video) this.video.pause();\n\t\t\tfor (t=0;t<this.tween.length;t++) {\n\t\t\t\tthis.tween[t].pause();\n\t\t\t}\n\t\t}\n\t\ttry {\n\t\t\tif (this.children[0].children[0].type==\"Group\" && this.children[0].children.length>2) { //phones\n\t\t\t\tvar targetRotation =  this.children[0].startRotationPoint+(this.proximity*100);\n\t\t\t\tfor (r=0;r<this.children[0].children.length; r++) {\n\t\t\t\t\tthis.children[0].children[r].rotation.x=de2ra(this.children[0].children[r].startRotationPoint+(this.proximity*200));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar targetRotation =  this.children[0].startRotationPoint+(this.proximity*100);\n\t\t\t\tthis.children[0].children[1].rotation.x=de2ra(this.children[0].children[1].startRotationPoint+(this.proximity*-200));\n\t\t\t}\n\t\t\tthis.children[0].rotation.y=de2ra(targetRotation);\n\t\t\t\n\t\t} catch(e) {\n\n\t\t}\n\n\t}\n\tsectionObject.updatePosition = function() {\n\t\t// this.position.x = this.count*screenWidthFromDistance(200);\n\t\tthis.position.y = sectionObject.count * -1*screenWidthFromDistance(200);\n\t}\n\tsectionObject.start = function(object) {\n\n\t\tif (typeof this.loaded == \"undefined\" || typeof sectionObject.headline == \"undefined\") {\n\t\t\tsetTimeout(function() {\n\t\t\t\tsectionObject.start()\n\t\t\t},50);\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\t\n\t\t$(sectionObject.headline.parentNode).addClass(\"active\");\n\t\tkickOffSite();\n\t\t\n\t\t$(\"body\").css(\"background\",$(section).data(\"bg-dark\")).css(\"color\",$(section).data(\"text-color\"));\n\n\t\t$(\"nav .toggle span\").css(\"background-color\",$(section).data(\"text-color\"));\n\t\tmainLight.color = rgbPercentage(hexToRgb($(section).data(\"bg-dark\")));\n\t\tvar intensity = colorIntensity(hexToRgb($(section).data(\"bg-light\")));\n\t\tTweenMax.to(groundMaterial, 1,{ opacity:map_range(intensity, 0, 1, 0.3, 0.04), onComplete:function() {}})\n\n\n\t\tfor (var a=0;a<sectionObject.children.length;a++) {\n\t\t\t// console.log(\"sectionobject child\",a);\n\t\t\tif (typeof sectionObject.children[a].begin != \"undefined\") {\n\t\t\t\tsectionObject.children[a].begin();\n\t\t\t}\n\t\t}\n\t\tsectionObject.kickstart=true;\n\t}\n\tsectionObject.end = function() {\n\n\t\tfor (var a=0;a<sectionObject.children.length;a++) {\n\t\t\t// console.log(\"sectionobject child\",a);\n\t\t\tif (typeof sectionObject.children[a].end != \"undefined\") {\n\t\t\t\tsectionObject.children[a].end();\n\t\t\t}\n\t\t}\n\t\tif (typeof sectionObject.headline ==\"object\") {\n\t\t\t$(sectionObject.headline.parentNode).removeClass(\"active\");\n\t\t}\n\t}\n\tstage.add( sectionObject );\n\t\n\tsectionObject.checkLoad = function() {\n\t\tif (sectionObject.loaded>0.98) {\n\t\t\tanimateText.register(sectionObject);\n\t\t\tscrollHandler();\n\t\t} else {\n\t\t\tsetTimeout(sectionObject.checkLoad,100);\n\t\t}\n\t}\n\tsectionObject.checkLoad();\n\tsetTimeout(function(sectionObject) {\n\t\t// sectionObject.position.y = sectionObject.count*screenWidthFromDistance(200);\n\t\tsectionObject.position.y = sectionObject.count * -1*screenWidthFromDistance(200);\n\t},100,sectionObject);\n\treturn sectionObject;\n}\n","/**\n * https://github.com/gre/bezier-easing\n * BezierEasing - use bezier curve for transition easing function\n * by Gatan Renaudeau 2014 - 2015  MIT License\n */\n\n// These values are established by empiricism with tests (tradeoff: performance VS precision)\nvar NEWTON_ITERATIONS = 4;\nvar NEWTON_MIN_SLOPE = 0.001;\nvar SUBDIVISION_PRECISION = 0.0000001;\nvar SUBDIVISION_MAX_ITERATIONS = 10;\n\nvar kSplineTableSize = 11;\nvar kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n\nvar float32ArraySupported = typeof Float32Array === 'function';\n\nfunction A (aA1, aA2) { return 1.0 - 3.0 * aA2 + 3.0 * aA1; }\nfunction B (aA1, aA2) { return 3.0 * aA2 - 6.0 * aA1; }\nfunction C (aA1)      { return 3.0 * aA1; }\n\n// Returns x(t) given t, x1, and x2, or y(t) given t, y1, and y2.\nfunction calcBezier (aT, aA1, aA2) { return ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT; }\n\n// Returns dx/dt given t, x1, and x2, or dy/dt given t, y1, and y2.\nfunction getSlope (aT, aA1, aA2) { return 3.0 * A(aA1, aA2) * aT * aT + 2.0 * B(aA1, aA2) * aT + C(aA1); }\n\nfunction binarySubdivide (aX, aA, aB, mX1, mX2) {\n  var currentX, currentT, i = 0;\n  do {\n    currentT = aA + (aB - aA) / 2.0;\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\n    if (currentX > 0.0) {\n      aB = currentT;\n    } else {\n      aA = currentT;\n    }\n  } while (Math.abs(currentX) > SUBDIVISION_PRECISION && ++i < SUBDIVISION_MAX_ITERATIONS);\n  return currentT;\n}\n\nfunction newtonRaphsonIterate (aX, aGuessT, mX1, mX2) {\n for (var i = 0; i < NEWTON_ITERATIONS; ++i) {\n   var currentSlope = getSlope(aGuessT, mX1, mX2);\n   if (currentSlope === 0.0) {\n     return aGuessT;\n   }\n   var currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n   aGuessT -= currentX / currentSlope;\n }\n return aGuessT;\n}\nBezierEasing = function (mX1, mY1, mX2, mY2) {\n  if (!(0 <= mX1 && mX1 <= 1 && 0 <= mX2 && mX2 <= 1)) {\n    throw new Error('bezier x values must be in [0, 1] range');\n  }\n\n  // Precompute samples table\n  var sampleValues = float32ArraySupported ? new Float32Array(kSplineTableSize) : new Array(kSplineTableSize);\n  if (mX1 !== mY1 || mX2 !== mY2) {\n    for (var i = 0; i < kSplineTableSize; ++i) {\n      sampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n    }\n  }\n\n  function getTForX (aX) {\n    var intervalStart = 0.0;\n    var currentSample = 1;\n    var lastSample = kSplineTableSize - 1;\n\n    for (; currentSample !== lastSample && sampleValues[currentSample] <= aX; ++currentSample) {\n      intervalStart += kSampleStepSize;\n    }\n    --currentSample;\n\n    // Interpolate to provide an initial guess for t\n    var dist = (aX - sampleValues[currentSample]) / (sampleValues[currentSample + 1] - sampleValues[currentSample]);\n    var guessForT = intervalStart + dist * kSampleStepSize;\n\n    var initialSlope = getSlope(guessForT, mX1, mX2);\n    if (initialSlope >= NEWTON_MIN_SLOPE) {\n      return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n    } else if (initialSlope === 0.0) {\n      return guessForT;\n    } else {\n      return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n    }\n  }\n\n  return function bezierEasing (x) {\n    if (mX1 === mY1 && mX2 === mY2) {\n      return x; // linear\n    }\n    // Because JavaScript number are imprecise, we should guarantee the extremes are right.\n    if (x === 0) {\n      return 0;\n    }\n    if (x === 1) {\n      return 1;\n    }\n    return calcBezier(getTForX(x), mY1, mY2);\n  };\n};","function customMaterial(element) {\n\tvar screenMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });\n\tif (element.tagName==\"IMG\") {\n\t\tvar texture = new THREE.TextureLoader().load( element.src);\n\t} else if (element.tagName==\"VIDEO\") {\n\t\tvar texture = new THREE.VideoTexture( element );\n\t}\n\ttexture.minFilter = THREE.LinearFilter;\n\ttexture.magFilter = THREE.LinearFilter;\n\ttexture.format = THREE.RGBFormat;\n\ttexture.wrapS = THREE.ClampToEdgeWrapping;\n\ttexture.wrapT = THREE.ClampToEdgeWrapping;\n\ttexture.anisotropy = 0.5;\n\tscreenMaterial.map = texture;\n\treturn screenMaterial;\n}","$(function() {\n\tinit();\n\t\n});\nvar snapWrapper = $(\".projects\");\nvar camera, scene, stage, renderer;\nvar mouseX = 0, prevMouseX = 0, mouseY = 0, mouseDown = false, mouseDirection;\nvar windowHalfX = window.innerWidth / 2;\nvar windowHalfY = window.innerHeight / 2;\nvar mouseDownCoord = new Object();\nvar sections = [], progression = 0, activeSection = 0, prevActiveSection = null, background = { light: { r:0, g:0, b:0 }, dark: { r:0, g:0, b:0 } };\nfunction startSection() {\n\t$activeSection = $(\"section:nth-child(\"+(activeSection+1)+\")\"); \n  \t$(\"a.cta\").removeClass(\"off\");\n\t$(\"a.cta\").css(\"color\",$activeSection.data(\"text-color\"));\n  \t$(\"a.cta .arrow\").css(\"background-color\",$activeSection.data(\"text-color\"));\n}\nfunction init() {\n\tvar options = {\n\t  $menu: false,\n\t  menuSelector: 'a',\n\t  panelSelector: '> section',\n\t  namespace: '.panelSnap',\n\t  onSnapStart: function(){ \n\t  \t$(\"a.cta\").addClass(\"off\") \n\t  },\n\t  onSnapFinish: function(){  \n\t  \t// console.log(\"snap finish\"); \n\t  \tstartSection();\n\t  },\n\t  onActivate: function(){ \n\t  \t// console.log(\"snap activate\");\n\t  },\n\t  directionThreshold: 10,\n\t  slideSpeed: 400,\n\t  delay: 0,\n\t  easing: 'swing',\n\t  offset: 0,\n\t  navigation: {\n\t    keys: {\n\t      nextKey: false,\n\t      prevKey: false,\n\t    },\n\t    buttons: {\n\t      $nextButton: false,\n\t      $prevButton: false,\n\t    },\n\t    wrapAround: false\n\t  }\n\t};\n\n\tsnapWrapper.panelSnap(options);\n\n\n\n\tsnapWrapper.bind(\"scroll\",scrollHandler);\n\tsetEnvironment();\n\tsetLights();\n\tscrollHandler();\n\tanimate();\n\t$(\"section\").each(function(i,elm) {\n\t\tsections.push(addProject(elm,stage,i));\n\t});\n\t$(\"a.cta\").bind(\"click\",goToCaseStudy);\n}\n\nfunction getProximity(sectionNo) {\n\t\n\tvar localScroll = snapWrapper.scrollTop() / snapWrapper[0].scrollHeight;\n\t\n\treturn (sectionNo) - (localScroll * sections.length);\n}\nfunction scrollHandler() {\n\tscrollPercentage = snapWrapper.scrollTop() / (snapWrapper[0].scrollHeight-$(\"section\",snapWrapper).height());\t\n\tprogression = scrollPercentage * sections.length;\n\n\tactiveSection = Math.floor(progression);\n\n\tif (activeSection == sections.length) activeSection -=1;\n\tif (activeSection != prevActiveSection) {\n\t\tfor (i=0;i<sections.length;i++) {\n\t\t\tif (i==activeSection) {\n\t\t\t\tsections[activeSection].start();\n\t\t\t\tfor (no=0;no<sections[i].tween.length;no++) {\n\t\t\t\t\tsections[i].tween[no].resume();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsections[i].end();\n\t\t\t\tfor (no=0;no<sections[i].tween.length;no++) {\n\t\t\t\t\tsections[i].tween[no].pause();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tvar inProximity=[];\n\tfor (i=0;i<sections.length;i++) {\n\t\tsections[i].proximity = getProximity(i);\n\t\tsections[i].updateRotation();\n\t\t\n\t\tif (sections[i].proximity>-0.75 && sections[i].proximity<0.75) {\n\t\t\tsections[i].visible = true;\n\t\t} else {\n\t\t\tsections[i].visible = true;\n\t\t}\n\t}\n\tprevActiveSection = activeSection;\n\tvar scrollTarget = 0-scrollPercentage*(screenWidthFromDistance(200)*(sections.length-1));\n\tTweenMax.to(stage.position, 0.75, {ease: Power4.easeOut, y: -1*scrollTarget});\n}\nfunction setEnvironment() {\n\tvar pixelRatio = window.devicePixelRatio;\n\tif (pixelRatio==1) {\n\t\tpixelRatio=1.5;\n\t} else {\n\t\tpixelRatio=2;\n\t}\n\tvar container = document.createElement( 'div' );\n\tcontainer.setAttribute(\"class\",\"content\");\n\tdocument.getElementsByClassName('devices')[0].appendChild( container );\n\n\tcamera = new THREE.PerspectiveCamera( setFOV(), window.innerWidth / window.innerHeight, 1, 5000 );\n\tcamera.position.z = 115;\n\tcamera.myTarget = new THREE.Vector3(0,50,0);\n\n\tcamera.lookAt(camera.myTarget);\n\n\tscene = new THREE.Scene();\n\tstage = new THREE.Group();\n\tscene.add(stage);\n\t\n\t\n\tvar myAntialias=false;\n\tif (pixelRatio>1) {\n\t\tmyAntialias=false;\n\t}\n\n\trenderer = new THREE.WebGLRenderer( {alpha: true, antialias: myAntialias });\n\t// renderer.setClearColor( 0xff0000, 0 );\n\trenderer.setClearColor( 0x000000, 0 );\n\trenderer.setPixelRatio( pixelRatio );\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\trenderer.shadowMap.enabled\t= true;\n\trenderer.shadowMap.type = THREE.PCFSoftShadowMap;\n\tcontainer.appendChild( renderer.domElement );\n\n\tvar element = renderer.domElement;\n\telement.style.position='absolute';\n\twindow.addEventListener( 'resize', onWindowResize, false );\n}\n\nfunction onWindowResize() {\n\twindowHalfX = window.innerWidth / 2;\n\twindowHalfY = window.innerHeight / 2;\n\n\tcamera.aspect = window.innerWidth / window.innerHeight;\n\tcamera.updateProjectionMatrix();\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\tcamera.fov = setFOV();\n\tscrollHandler();\n\tfor (i=0;i<sections.length;i++) {\n\t\tsections[i].updatePosition();\n\t}\n}\nfunction kickOffSite() {\n\tif (!$(\"body\").hasClass(\"loaded\")) {\n\t\tTweenMax.to(camera.myTarget, 2, {x:0, y:0, z:0, delay:.7, ease:Power4.easeOut});\n\t\tsetTimeout(function() {\n\t\t\t$(\"body\").addClass(\"loaded\");\n\t\t\tstartSection();\n\t\t},2000);\n\t\tsetTimeout(function() {\n\t\t\tsections[activeSection].updateRotation();\n\t\t},1000);\n\t}\n}\n\nvar mousePosition = { x:0, y:0 };\ndocument.addEventListener( 'mousemove', onDocumentMouseMove, false );\n\nvar storedMouse = { x:0, y:0 };\nfunction onDocumentMouseMove( event ) {\n\tif (typeof event == \"undefined\") {\n\t\tvar event = {\n\t\t\tclientX: storedMouse.x,\n\t\t\tclientY: storedMouse.y\n\t\t}\n\t}\n\tstoredMouse.x = event.clientX;\n\tstoredMouse.y = event.clientY;\n\tmouseX = windowHalfX - event.clientX;\n\tmouseY = windowHalfY - event.clientY;\n\tprevMouseX=mouseX;\n\tTweenMax.to(mousePosition, 1, {x: mouseX, y:mouseY, ease: Power1.easeOut});\n}\n\nTweenMax.ticker.addEventListener(\"tick\",animate);\nvar hasData=false;\nsetTimeout(function() {\n\thasData=true\n},4000);\nvar pixelRatioSwitchCount=-1;\nsetInterval(fps.reset, 10000);\nvar windowInFocus=true;\n$(window).focus(function() {\n\twindowInFocus=true;\n\tconsole.log(\"window in focus\");\n});\n$(window).blur(function() {\n\twindowInFocus=false;\n\tconsole.log(\"window out of focus\");\n});\n\nframeCount=0;\nfunction animate() {\n\tif (!windowInFocus) {\n\t\tif (frameCount>2) {\n\t\t\t// console.log(frameCount);\n\t\t\trender();\n\t\t\tframeCount=0;\n\t\t\tpixelRatioSwitchCount=0;\n\t\t} \n\t} else {\n\t\trender();\n\t}\n\tframeCount++;\n\t// if (typeof renderer!=\"undefined\" && windowInFocus) {\n\t// \tif (renderer.getPixelRatio()<2 && !renderer.antialias) {\n\t// \t\trenderer.antialias=true;\n\t// \t} else {\n\t// \t\tif (renderer.antialias && renderer.getPixelRatio()>=2) renderer.antialias=false;\n\t// \t}\n\t// \tfps.getFPS()\n\t// \tif (pixelRatioSwitchCount<4 && hasData) {\n\t// \t\tif (fps.average < 25) {\n\t// \t\t\tif (renderer.getPixelRatio() != 1) {\n\t// \t\t\t\trenderer.setPixelRatio( 1 );\n\t// \t\t\t\tpixelRatioSwitchCount+=1;\n\t// \t\t\t}\n\t// \t\t} else if (fps.average < 35) {\n\t// \t\t\tif (renderer.getPixelRatio() != 1.5) {\n\t// \t\t\t\tconsole.log(\"set pixel ratio 1.5\");\n\t// \t\t\t\trenderer.setPixelRatio( 1.5 );\n\t// \t\t\t\tpixelRatioSwitchCount+=1;\n\t// \t\t\t}\n\t// \t\t} else {\n\t// \t\t\tif (renderer.getPixelRatio() != 2) {\n\t// \t\t\t\tconsole.log(\"set pixel ratio 2\");\n\t// \t\t\t\trenderer.setPixelRatio( 2 );\n\t// \t\t\t\tpixelRatioSwitchCount+=1;\n\t// \t\t\t}\n\t// \t\t}\n\t// \t} else {\n\t// \t\tif (hasData) {\n\t// \t\t\tif (fps.average>25) {\n\t// \t\t\t\tconsole.log(\"set pixel ratio 1.5\");\n\t// \t\t\t\trenderer.setPixelRatio( 1.5 );\n\t// \t\t\t} else {\n\t// \t\t\t\trenderer.setPixelRatio( 1 );\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t// }\n}\n\nfunction render() {\n\t// var time = Date.now();\n\t// console.log(camera);\n\tif (typeof camera != \"undefined\") {\n\t\tcamera.position.x = 0- ( mousePosition.x - camera.position.x ) * 0.009;\n\t\tcamera.position.y = 0 - (( - mousePosition.y - camera.position.y ) * 0.009);\n\t\tcamera.lookAt(camera.myTarget);\n\t\trenderer.render( scene, camera );\n\t}\n}\n\t\n\t\nfunction de2ra(degree) { \n\treturn degree*(Math.PI/180);\n}\nfunction screenWidthFromDistance(distance) {\n\tvar aspect = window.innerWidth / window.innerHeight;\n\tvar frustumHeight = 1.75 * distance * Math.tan(camera.fov * 0.5 * (Math.PI/180));\n\tvar frustumWidth = frustumHeight * aspect;\n\treturn frustumWidth;\n}\nfunction setFOV() {\n\t// var fov = map_range(window.innerWidth, 0, 100, 60, 305);\n\tfov = 40;\n\tif (window.innerWidth<600) {\n\t\tfov=70;\n\t}\n\treturn fov;\t\n}\n\n$(\".controls a\").click(function(e) {\n\te.stopPropagation();\n});\n\n","/**\n * Copyright (c) 2013-present, Guido Bouman\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/* global jQuery */\n\n// Utility for creating objects in older browsers\nif (typeof Object.create !== 'function') {\n  Object.create = function (obj) {\n    function F() { }\n    F.prototype = obj;\n    return new F();\n  };\n}\n\n/*!\n * jQuery panelSnap\n * Version 0.15.1\n *\n * Requires:\n * - jQuery 1.7 or higher (no jQuery.migrate needed)\n *\n * https://github.com/guidobouman/jquery-panelsnap\n */\n(function ($, window, document) {\n  'use strict';\n\n  var pluginName = 'panelSnap';\n  var storageName = 'plugin_' + pluginName;\n\n  var pluginObject = {\n\n    isMouseDown: false,\n    isSnapping: false,\n    enabled: true,\n    scrollOffset: 0,\n\n    init: function (options, container) {\n      var self = this;\n\n      self.container = container;\n      self.$container = $(container);\n\n      self.$eventContainer = self.$container;\n      self.$snapContainer = self.$container;\n\n      if (self.$container.is('body')) {\n        self.$eventContainer = $(document);\n        self.$snapContainer = $(document.scrollingElement || document.documentElement);\n\n        var ua = navigator.userAgent;\n        if (ua.indexOf('WebKit') !== -1 && ua.indexOf('Chrome') === -1) {\n          self.$snapContainer = $('body');\n        }\n      }\n\n      self.options = $.extend(true, {}, $.fn.panelSnap.options, options);\n\n      self.bind();\n\n      if (self.options.$menu !== false && $('.active', self.options.$menu).length > 0) {\n        $('.active', self.options.$menu).click();\n      } else {\n        var $target = self.getPanel(':first');\n        self.activatePanel($target);\n      }\n\n      return self;\n    },\n\n    bind: function () {\n      var self = this;\n\n      self.bindProxied(self.$eventContainer, 'scrollstop', self.scrollStop);\n      self.bindProxied(self.$eventContainer, 'mousewheel', self.mouseWheel);\n      self.bindProxied(self.$eventContainer, 'mousedown', self.mouseDown);\n      self.bindProxied(self.$eventContainer, 'mouseup', self.mouseUp);\n\n      self.bindProxied($(window), 'resizestop', self.resize);\n\n      if (self.options.$menu) {\n        self.bindProxied(self.options.$menu, 'click', self.captureMenuClick, self.options.menuSelector);\n      }\n\n      if (self.options.navigation.keys.nextKey || self.options.navigation.keys.prevKey) {\n        self.bindProxied($(window), 'keydown', self.keyDown);\n      }\n\n      if (self.options.navigation.buttons.$nextButton) {\n        self.bindProxied(self.options.navigation.buttons.$nextButton, 'click', self.captureNextClick);\n      }\n\n      if (self.options.navigation.buttons.$prevButton) {\n        self.bindProxied(self.options.navigation.buttons.$prevButton, 'click', self.capturePrevClick);\n      }\n    },\n\n    bindProxied: function ($element, event, method, selector) {\n      var self = this;\n\n      selector = typeof selector === 'string' ? selector : null;\n\n      $element.on(event + self.options.namespace, selector, $.proxy(function (e) {\n        return method.call(self, e);\n      }, self));\n    },\n\n    destroy: function () {\n      var self = this;\n\n      // Gotta love namespaced events!\n      self.$eventContainer.off(self.options.namespace);\n\n      $(window).off(self.options.namespace);\n\n      if (self.options.$menu !== false) {\n        $(self.options.menuSelector, self.options.$menu).off(self.options.namespace);\n      }\n\n      self.$container.removeData(storageName);\n    },\n\n    scrollStop: function (e) {\n      var self = this;\n      var $target;\n\n      e.stopPropagation();\n\n      if (self.isMouseDown) {\n        return;\n      }\n\n      if (self.isSnapping) {\n        return;\n      }\n\n      // Check if enabled or just 1 panel in viewport\n      var panelsInViewPort = self.getPanelsInViewport();\n      if (!self.enabled || panelsInViewPort.length < 2) {\n        $target = panelsInViewPort.eq(0);\n        if (!$target.is(self.getPanel('.active'))) {\n          self.activatePanel($target);\n        }\n\n        return;\n      }\n\n      var offset = self.$snapContainer.scrollTop();\n      var scrollDifference = offset - self.scrollOffset;\n      var overThreshold = Math.abs(scrollDifference) > self.options.directionThreshold;\n\n      var panelNumber;\n      if (scrollDifference > 0) {\n        panelNumber = overThreshold ? 1 : 0;\n      } else if (scrollDifference < 0) {\n        panelNumber = overThreshold ? 0 : 1;\n      } else {\n        // Nothing to scroll, get out.\n        return;\n      }\n\n      $target = panelsInViewPort.eq(panelNumber);\n\n      var maxOffset = self.$container[0].scrollHeight - self.scrollInterval;\n      if (offset <= 0 || offset >= maxOffset) {\n        // Only activate, prevent stuttering\n        self.activatePanel($target);\n        // Set scrollOffset to a sane number for next scroll\n        self.scrollOffset = offset <= 0 ? 0 : maxOffset;\n      } else {\n        self.snapToPanel($target);\n      }\n    },\n\n    getPanelsInViewport: function () {\n      var self = this;\n\n      var viewport = { top: self.$snapContainer.scrollTop() };\n      viewport.bottom = viewport.top + self.$snapContainer.height();\n\n      var panels = self.getPanel().filter(function (_, el) {\n        var $el = $(el);\n        var bounds;\n\n        if (self.$container.is('body')) {\n          bounds = $el.offset();\n        } else {\n          bounds = $el.position();\n          bounds.top += self.$snapContainer.scrollTop();\n        }\n\n        bounds.bottom = bounds.top + $el.outerHeight();\n\n        return !(viewport.bottom < bounds.top || viewport.top > bounds.bottom);\n      });\n\n      return panels;\n    },\n\n    mouseWheel: function () {\n      var self = this;\n\n      // This event only fires when the user actually scrolls with their input device.\n      // Be it a trackpad, legacy mouse or anything else.\n\n      if (self.isSnapping) {\n        self.scrollOffset = self.$snapContainer.scrollTop();\n        self.$snapContainer.stop(true);\n        self.isSnapping = false;\n      }\n    },\n\n    mouseDown: function () {\n      var self = this;\n\n      self.isMouseDown = true;\n    },\n\n    mouseUp: function (e) {\n      var self = this;\n\n      self.isMouseDown = false;\n\n      if (self.scrollOffset !== self.$snapContainer.scrollTop()) {\n        self.scrollStop(e);\n      }\n    },\n\n    keyDown: function (e) {\n      var self = this;\n\n      var nav = self.options.navigation;\n\n      if (!self.enabled) {\n        return;\n      }\n\n      switch (e.which) {\n        case nav.keys.prevKey:\n        case nav.keys.nextKey:\n          e.preventDefault();\n          break;\n\n        // no default\n      }\n\n      if (self.isSnapping) {\n        return;\n      }\n\n      switch (e.which) {\n        case nav.keys.prevKey:\n          self.snapTo('prev', nav.wrapAround);\n          break;\n\n        case nav.keys.nextKey:\n          self.snapTo('next', nav.wrapAround);\n          break;\n\n        // no default\n      }\n    },\n\n    captureNextClick: function (e) {\n      var self = this;\n\n      e.preventDefault();\n\n      if (self.isSnapping) {\n        return;\n      }\n\n      self.snapTo('next', self.options.navigation.wrapAround);\n    },\n\n    capturePrevClick: function (e) {\n      var self = this;\n\n      e.preventDefault();\n\n      if (self.isSnapping) {\n        return;\n      }\n\n      self.snapTo('prev', self.options.navigation.wrapAround);\n    },\n\n    resize: function () {\n      var self = this;\n\n      if (!self.enabled) {\n        return;\n      }\n\n      var $target = self.getPanel('.active');\n\n      self.snapToPanel($target);\n    },\n\n    captureMenuClick: function (e) {\n      var self = this;\n\n      var panel = $(e.currentTarget).data('panel');\n      var $target = self.getPanel('[data-panel=\"' + panel + '\"]');\n\n      self.snapToPanel($target);\n\n      return false;\n    },\n\n    snapToPanel: function ($target) {\n      var self = this;\n\n      if (!$target.jquery) {\n        return;\n      }\n\n      self.isSnapping = true;\n\n      self.options.onSnapStart.call(self, $target);\n      self.$container.trigger('panelsnap:start', [$target]);\n\n      var scrollTarget = 0;\n      if (self.$container.is('body')) {\n        scrollTarget = $target.offset().top;\n      } else {\n        scrollTarget = self.$snapContainer.scrollTop() + $target.position().top;\n      }\n\n      scrollTarget -= self.options.offset;\n\n      self.$snapContainer.stop(true).delay(self.options.delay).animate({\n        scrollTop: scrollTarget\n      }, self.options.slideSpeed, self.options.easing, function () {\n        // Set scrollOffset to scrollTop\n        // (not to scrollTarget since on iPad those sometimes differ)\n        self.scrollOffset = self.$snapContainer.scrollTop();\n        self.isSnapping = false;\n\n        // Call callback\n        self.options.onSnapFinish.call(self, $target);\n        self.$container.trigger('panelsnap:finish', [$target]);\n\n        self.activatePanel($target);\n      });\n    },\n\n    activatePanel: function ($target) {\n      var self = this;\n\n      self.getPanel('.active').removeClass('active');\n      $target.addClass('active');\n\n      if (self.options.$menu !== false) {\n        var activeItemSelector = self.options.menuSelector + '.active';\n        $(activeItemSelector, self.options.$menu).removeClass('active');\n\n        var attribute = '[data-panel=\"' + $target.data('panel') + '\"]';\n        var itemSelector = self.options.menuSelector + attribute;\n        var $itemToActivate = $(itemSelector, self.options.$menu);\n        $itemToActivate.addClass('active');\n      }\n\n      var nav = self.options.navigation;\n\n      if (!nav.wrapAround) {\n        var $panels = self.getPanel();\n        var index = $panels.index(self.getPanel('.active'));\n\n        if (nav.buttons.$nextButton !== false) {\n          $target = $panels.eq(index + 1);\n          if ($target.length < 1) {\n            $(nav.buttons.$nextButton).attr('aria-disabled', 'true');\n            $(nav.buttons.$nextButton).addClass('disabled');\n          } else {\n            $(nav.buttons.$nextButton).attr('aria-disabled', 'false');\n            $(nav.buttons.$nextButton).removeClass('disabled');\n          }\n        }\n\n        if (nav.buttons.$prevButton !== false) {\n          if (index < 1) {\n            $(nav.buttons.$prevButton).attr('aria-disabled', 'true');\n            $(nav.buttons.$prevButton).addClass('disabled');\n          } else {\n            $(nav.buttons.$prevButton).attr('aria-disabled', 'false');\n            $(nav.buttons.$prevButton).removeClass('disabled');\n          }\n        }\n      }\n\n      self.options.onActivate.call(self, $target);\n      self.$container.trigger('panelsnap:activate', [$target]);\n    },\n\n    getPanel: function (selector) {\n      var self = this;\n\n      if (typeof selector === 'undefined') {\n        selector = '';\n      }\n\n      return $(self.options.panelSelector + selector, self.$container);\n    },\n\n    snapTo: function (target, wrap) {\n      var self = this;\n\n      if (typeof wrap !== 'boolean') {\n        wrap = true;\n      }\n\n      var $panels = self.getPanel();\n      var index = $panels.index(self.getPanel('.active'));\n      var $target;\n\n      switch (target) {\n        case 'prev':\n          $target = $panels.eq(index - 1);\n          if (index < 1 && !wrap) {\n            $target = []; // Clear target, because negative indexes wrap automatically\n          }\n          break;\n\n        case 'next':\n          $target = $panels.eq(index + 1);\n          if ($target.length < 1 && wrap) {\n            $target = $panels.filter(':first');\n          }\n          break;\n\n        case 'first':\n          $target = $panels.filter(':first');\n          break;\n\n        case 'last':\n          $target = $panels.filter(':last');\n          break;\n\n        // no default\n      }\n\n      if ($target.length > 0) {\n        self.snapToPanel($target);\n      }\n    },\n\n    enable: function () {\n      var self = this;\n\n      // Gather scrollOffset for next scroll\n      self.scrollOffset = self.$snapContainer.scrollTop();\n\n      self.enabled = true;\n    },\n\n    disable: function () {\n      var self = this;\n\n      self.enabled = false;\n    },\n\n    toggle: function () {\n      var self = this;\n\n      if (self.enabled) {\n        self.disable();\n      } else {\n        self.enable();\n      }\n    }\n\n  };\n\n  $.fn[pluginName] = function (options) {\n    var args = Array.prototype.slice.call(arguments);\n\n    return this.each(function () {\n      var pluginInstance = $.data(this, storageName);\n      if (typeof options === 'object' || options === 'init' || !options) {\n        if (!pluginInstance) {\n          if (options === 'init') {\n            options = args[1] || {};\n          }\n\n          pluginInstance = Object.create(pluginObject).init(options, this);\n          $.data(this, storageName, pluginInstance);\n        } else {\n          $.error('Plugin is already initialized for this object.');\n        }\n      } else if (!pluginInstance) {\n        $.error('Plugin is not initialized for this object yet.');\n      } else if (pluginInstance[options]) {\n        var method = options;\n        options = args.slice(1);\n        pluginInstance[method].apply(pluginInstance, options);\n      } else {\n        $.error('Method ' + options + ' does not exist on jQuery.panelSnap.');\n      }\n    });\n  };\n\n  $.fn[pluginName].options = {\n    $menu: false,\n    menuSelector: 'a',\n    panelSelector: '> section',\n    namespace: '.panelSnap',\n    onSnapStart: function () { },\n    onSnapFinish: function () { },\n    onActivate: function () { },\n    directionThreshold: 50,\n    slideSpeed: 200,\n    delay: 0,\n    easing: 'linear',\n    offset: 0,\n    navigation: {\n      keys: {\n        nextKey: false,\n        prevKey: false\n      },\n      buttons: {\n        $nextButton: false,\n        $prevButton: false\n      },\n      wrapAround: false\n    }\n  };\n}(jQuery, window, document));\n\n/*!\n * Special flavoured jQuery Mobile scrollstart & scrollstop events.\n * Version 0.1.3\n *\n * Requires:\n * - jQuery 1.7.1 or higher (no jQuery.migrate needed)\n */\n(function ($) {\n  // Also handles the scrollstop event\n  $.event.special.scrollstart = {\n\n    enabled: true,\n\n    setup: function () {\n      var thisObject = this;\n      var $this = $(thisObject);\n      var timer;\n      var isTouching;\n\n      $this.data('scrollwatch', true);\n\n      function trigger(event, scrolling) {\n        event.type = scrolling ? 'scrollstart' : 'scrollstop';\n        $this.trigger(event);\n      }\n\n      $this.on('touchstart', function () {\n        isTouching = true;\n      });\n\n      $this.on('touchleave touchcancel touchend', function () {\n        isTouching = false;\n        setTimeout(function () {\n          clearTimeout(timer);\n        }, 50);\n      });\n\n      $this.on('touchmove scroll', function (event) {\n        if (isTouching) {\n          return;\n        }\n\n        if (!$.event.special.scrollstart.enabled) {\n          return;\n        }\n\n        if (!$.event.special.scrollstart.scrolling) {\n          $.event.special.scrollstart.scrolling = true;\n          trigger(event, true);\n        }\n\n        clearTimeout(timer);\n        timer = setTimeout(function () {\n          $.event.special.scrollstart.scrolling = false;\n          trigger(event, false);\n        }, 50);\n      });\n    }\n\n  };\n\n  // Proxies scrollstart when needed\n  $.event.special.scrollstop = {\n\n    setup: function () {\n      var thisObject = this;\n      var $this = $(thisObject);\n\n      if (!$this.data('scrollwatch')) {\n        $(this).on('scrollstart', function () { });\n      }\n    }\n\n  };\n}(jQuery));\n\n/*!\n * Resizestart and resizestop events.\n * Version 0.0.1\n *\n * Requires:\n * - jQuery 1.7.1 or higher (no jQuery.migrate needed)\n */\n(function ($) {\n  // Also handles the resizestop event\n  $.event.special.resizestart = {\n\n    enabled: true,\n\n    setup: function () {\n      var thisObject = this;\n      var $this = $(thisObject);\n      var timer;\n\n      $this.data('resizewatch', true);\n\n      function trigger(event, resizing) {\n        event.type = resizing ? 'resizestart' : 'resizestop';\n        $this.trigger(event);\n      }\n\n      $this.on('resize', function (event) {\n        if (!$.event.special.resizestart.enabled) {\n          return;\n        }\n\n        if (!$.event.special.resizestart.resizing) {\n          $.event.special.resizestart.resizing = true;\n          trigger(event, true);\n        }\n\n        clearTimeout(timer);\n        timer = setTimeout(function () {\n          $.event.special.resizestart.resizing = false;\n          trigger(event, false);\n        }, 200);\n      });\n    }\n\n  };\n\n  // Proxies resizestart when needed\n  $.event.special.resizestop = {\n\n    setup: function () {\n      var thisObject = this;\n      var $this = $(thisObject);\n\n      if (!$this.data('resizewatch')) {\n        $(this).on('resizestart', function () { });\n      }\n    }\n\n  };\n}(jQuery));\n\n/* eslint-disable */\n\n/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)\n * Licensed under the MIT License (LICENSE.txt).\n *\n * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.\n * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.\n * Thanks to: Seamus Leahy for adding deltaX and deltaY\n *\n * Version: 3.0.6\n *\n * Requires: 1.2.2+\n */\n(function ($) {\n\n  var types = ['DOMMouseScroll', 'mousewheel'];\n\n  if ($.event.fixHooks) {\n    for (var i = types.length; i;) {\n      $.event.fixHooks[types[--i]] = $.event.mouseHooks;\n    }\n  }\n\n  $.event.special.mousewheel = {\n    setup: function () {\n      if (this.addEventListener) {\n        for (var i = types.length; i;) {\n          this.addEventListener(types[--i], handler, false);\n        }\n      } else {\n        this.onmousewheel = handler;\n      }\n    },\n\n    teardown: function () {\n      if (this.removeEventListener) {\n        for (var i = types.length; i;) {\n          this.removeEventListener(types[--i], handler, false);\n        }\n      } else {\n        this.onmousewheel = null;\n      }\n    }\n  };\n\n  $.fn.extend({\n    mousewheel: function (fn) {\n      return fn ? this.bind('mousewheel', fn) : this.trigger('mousewheel');\n    },\n\n    unmousewheel: function (fn) {\n      return this.unbind('mousewheel', fn);\n    }\n  });\n\n  function handler(event) {\n    var orgEvent = event || window.event,\n      args = [].slice.call(arguments, 1),\n      delta = 0,\n      returnValue = true,\n      deltaX = 0,\n      deltaY = 0;\n\n    event = $.event.fix(orgEvent);\n    event.type = 'mousewheel';\n\n    // Old school scrollwheel delta\n    if (orgEvent.wheelDelta) { delta = orgEvent.wheelDelta / 120; }\n    if (orgEvent.detail) { delta = -orgEvent.detail / 3; }\n\n    // New school multidimensional scroll (touchpads) deltas\n    deltaY = delta;\n\n    // Gecko\n    if (orgEvent.axis !== undefined && orgEvent.axis === orgEvent.HORIZONTAL_AXIS) {\n      deltaY = 0;\n      deltaX = -1 * delta;\n    }\n\n    // Webkit\n    if (orgEvent.wheelDeltaY !== undefined) { deltaY = orgEvent.wheelDeltaY / 120; }\n    if (orgEvent.wheelDeltaX !== undefined) { deltaX = -1 * orgEvent.wheelDeltaX / 120; }\n\n    // Add event and delta to the front of the arguments\n    args.unshift(event, delta, deltaX, deltaY);\n\n    return ($.event.dispatch || $.event.handle).apply(this, args);\n  }\n\n})(jQuery);\n/* eslint-enable */","/*!\n * Scalem v1.2.0 - A responsive text jQuery plugin\n * Copyright 2014, Tom Doan (http://www.tohodo.com/)\n *\n * Scalem by Tom Doan is licensed under the MIT License.\n * Read a copy of the license in the LICENSE file or at\n * http://choosealicense.com/licenses/mit\n */\n\n(function($) {\n  $.fn.scalem = function(oOptions) {\n    var oSettings = $.extend({\n        ratio: 1,        // Scale ratio (1 = 100%)\n        reference: null, // Text will scale relative to this element\n        styles: '',       // List of styles to scale (useful for buttons)\n        maxSize:390\n      }, oOptions),\n      updateStyles = function(o, e) {\n        var $o = $(o),\n          $oP = $o.parent(),\n          // Create clone to get true text width\n          $o2 = $o.clone().css({\n            'width': 'auto',\n            'display': 'none',\n            'white-space': 'nowrap'\n          }),\n          // If data attribute exists, use that instead\n          $ref = $(o.getAttribute('data-scale-reference') || oSettings.reference),\n          // Array of styles to scale\n          aStyles = ('' + (o.getAttribute('data-scale-styles') || oSettings.styles)).split(' '),\n          // Scale ratio\n          nRatio = Math.max(parseFloat(o.getAttribute('data-scale-ratio') || oSettings.ratio), 0),\n          nMaxSize = Math.max(parseFloat(o.getAttribute('data-max-size') || oSettings.maxSize), 0),\n          // Reference width (set to parent width by default)\n          nRefWidth = ($ref.length) ? $ref.width() : $oP.width(),\n          nTargetWidth,\n          // Text width\n          nTextWidth;\n        // Validate ratio\n        if (isNaN(nRatio)) nRatio = 1;\n        // Account for scrollbar?\n        if ($oP[0].scrollHeight>$oP.height()) nRefWidth -= 17;\n        nTargetWidth = nRefWidth * nRatio;\n        // Append clone to body to get inline width\n        $o2.addClass(\"currentProjectH2\");\n        $o2.appendTo('body');\n        nTextWidth = $o2.width();\n        // Exit if something doesn't look right\n        if (nTargetWidth===0 || nTextWidth===nRefWidth) {\n          $o2.remove();\n          return;\n        }\n        // Scale the text! (6px is minimum font size to get accurate ratio)\n        for (var i=Math.round((6/$o2.css('font-size', '6px').width())*nTargetWidth), o2=$o2[0]; i<nTargetWidth; ++i) {\n          // Update font-size using native method for better performance\n          // (see http://jsperf.com/style-vs-csstext-vs-setattribute)\n          o2.style.fontSize = i + 'px';\n          if ($o2.width() / nRefWidth > nRatio) {\n            // console.log(\"font size\",i)\n            if (i>nMaxSize) {\n              $o.css('font-size', nMaxSize + 'px');\n            } else {\n              $o.css('font-size', (i-1) + 'px');\n            }\n            \n            break;\n          }\n        }\n        // Clean up\n        $o2.remove();\n        // Scale additional styles\n        if (aStyles[0]) {\n          var nScale = $o.width() / nTextWidth,\n            oStyles = {};\n          for (var i=0, imax=aStyles.length; i<imax; ++i) {\n            if (!aStyles[i]) continue;\n            oStyles[aStyles[i]] = ((aStyles[i]==='width') ? nTargetWidth : Math.round(parseFloat($o.css(aStyles[i])) * nScale)) + 'px';\n          }\n          $o.css(oStyles);\n        }\n      };\n    return this.each(function() {\n      // This scope is required for the resize handler\n      var o = this;\n      // Set font size on load\n      updateStyles(o);\n      // Update CSS styles upon resize\n      $(window).resize(function(e) {\n        updateStyles(o, e);\n      });\n    });\n  };\n}(jQuery));","if (location.host!=\"anker.re\") {\n\tdocument.write('<script src=\"http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1\"></' + 'script>');\n}\n\t// // console.log(\"in debug mode\");\n","function goToCaseStudy(e) {\n\t$headline = $activeSection.find(\"h2\");\n\n\t$(\"article header\").css(\"background-color\",$activeSection.data(\"text-color\"))\n  \t$(\"article header h1\").html($headline.html()).css(\"color\",$activeSection.data(\"bg-dark\"));\n  \t$(\"article header h1\").scalem({maxSize:175});\n\t$(\"article\").addClass(\"on\")\n\n\t$(\"article header\").css(\"background-color\",$activeSection.data(\"bg-dark\"))\n  \t$(\"article header h1\").html($headline.html()).css(\"color\",$activeSection.data(\"text-color\"));\n\n  \tTweenMax.to(sections[activeSection].rotation, 2, { y:-de2ra(360), ease:new Ease(BezierEasing(.8,0,.2,1)), onComplete:function() {\n  \t\tsections[activeSection].rotation.y=de2ra(0);\n  \t}});\n  \tTweenMax.to(camera.position, 1.7/2, { z:200, ease:new Ease(BezierEasing(.2,0,1,.8)), onComplete:function() {\n  \t\tTweenMax.to(camera.position, 1.7/2, { z:115, ease:new Ease(BezierEasing(0,.45,.3,1))});\n  \t}});\n  \tTweenMax.to(sections[activeSection].position, 1, { x:-70, ease:new Ease(BezierEasing(.45,0,1,.3)), onComplete:function() {\n  \t\tTweenMax.to(sections[activeSection].position, 1, { x:0, ease:new Ease(BezierEasing(0,.45,.1,1))});\n  \t}});\n\te.stopPropagation();\n\treturn false;\n}","$(function() {\n\t$(\"a\").each(function(i,elm) {\n\t\tif (elm.href!='#') {\n\t\t\t// console.log(\"link\",elm.href);\n\t\t\t$(elm).data(\"link\",$(elm).attr(\"href\"));\n\t\t}\n\t});\n});","var mainLight;\nvar groundMaterial;\n\nfunction setLights() {\n\tvar shadowMapSize = 512;\n\tvar groundGeometry = new THREE.PlaneGeometry( 3000, 3000, 1 );\n\tgroundMaterial = new THREE.ShadowMaterial();\n\t// groundMaterial = new THREE.MeshDepthMaterial( { color: 0xff0000 } );\n\tgroundMaterial.opacity = 0.04;\n\tvar ground = new THREE.Mesh(groundGeometry, groundMaterial);\n\tground.receiveShadow = true;\n\tground.rotation.x=0;\n\tground.position.y=30;\n\tground.position.z=0;\n\tground.transparent = false;\n\tscene.add(ground);\n\n\tmainLight = new THREE.AmbientLight( { color:0x000000,intensity:0.37 } ); // soft white light\n\n\tscene.add( mainLight );\n\n\n\t// var spotLight1 = new THREE.SpotLight( 0xffffff); \n\t// spotLight1.shadow.mapSize.height = shadowMapSize;\n\t// spotLight1.shadow.mapSize.width = shadowMapSize;\n\t// spotLight1.castShadow = false;\n\t// spotLight1.position.set(0, 5, 0 );\n\t// spotLight1.intensity = .15;\n\t// spotLight1.penumbra = 1;\n\t// spotLight1.decay = 2;\n\t// spotLight1.angle = .45;\n\t// scene.add( spotLight1 );\n\t// scene.add(spotLight1.target);\n\n\tvar spotLight2 = new THREE.SpotLight( 0xFFFFFF); \n\tspotLight2.castShadow = true;\n\tspotLight2.position.set( 0,20,60 ); \n\tspotLight2.shadow.mapSize.height = shadowMapSize;\n\tspotLight2.shadow.mapSize.width = shadowMapSize;\n\tspotLight2.intensity = .15;\n\tspotLight2.exponent = .05;\n\tspotLight2.penumbra = 2;\n\tspotLight2.decay = 3;\n\tspotLight2.angle = de2ra(80);\n\tspotLight2.target.position = {\n\t\tx:-10,\n\t\ty:10,\n\t\tz:0\n\t}\n\tscene.add( spotLight2 );\n\tscene.add(spotLight2.target);\n\n}\n"]}